(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var Er=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ov(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Wx={exports:{}},Xl={},Gx={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ro=Symbol.for("react.element"),Dv=Symbol.for("react.portal"),Pv=Symbol.for("react.fragment"),Iv=Symbol.for("react.strict_mode"),Rv=Symbol.for("react.profiler"),Lv=Symbol.for("react.provider"),Mv=Symbol.for("react.context"),Bv=Symbol.for("react.forward_ref"),Uv=Symbol.for("react.suspense"),$v=Symbol.for("react.memo"),Hv=Symbol.for("react.lazy"),hd=Symbol.iterator;function zv(e){return e===null||typeof e!="object"?null:(e=hd&&e[hd]||e["@@iterator"],typeof e=="function"?e:null)}var Kx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qx=Object.assign,Xx={};function js(e,t,r){this.props=e,this.context=t,this.refs=Xx,this.updater=r||Kx}js.prototype.isReactComponent={};js.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};js.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Yx(){}Yx.prototype=js.prototype;function Pu(e,t,r){this.props=e,this.context=t,this.refs=Xx,this.updater=r||Kx}var Iu=Pu.prototype=new Yx;Iu.constructor=Pu;qx(Iu,js.prototype);Iu.isPureReactComponent=!0;var xd=Array.isArray,Jx=Object.prototype.hasOwnProperty,Ru={current:null},Qx={key:!0,ref:!0,__self:!0,__source:!0};function Zx(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)Jx.call(t,n)&&!Qx.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:ro,type:e,key:s,ref:i,props:a,_owner:Ru.current}}function Vv(e,t){return{$$typeof:ro,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Lu(e){return typeof e=="object"&&e!==null&&e.$$typeof===ro}function Wv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var md=/\/+/g;function Ec(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Wv(""+e.key):t.toString(36)}function Xo(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case ro:case Dv:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Ec(i,0):n,xd(a)?(r="",e!=null&&(r=e.replace(md,"$&/")+"/"),Xo(a,t,r,"",function(c){return c})):a!=null&&(Lu(a)&&(a=Vv(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(md,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",xd(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Ec(s,o);i+=Xo(s,t,r,l,a)}else if(l=zv(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Ec(s,o++),i+=Xo(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function vo(e,t,r){if(e==null)return e;var n=[],a=0;return Xo(e,n,"","",function(s){return t.call(r,s,a++)}),n}function Gv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Gt={current:null},Yo={transition:null},Kv={ReactCurrentDispatcher:Gt,ReactCurrentBatchConfig:Yo,ReactCurrentOwner:Ru};function em(){throw Error("act(...) is not supported in production builds of React.")}Ne.Children={map:vo,forEach:function(e,t,r){vo(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return vo(e,function(){t++}),t},toArray:function(e){return vo(e,function(t){return t})||[]},only:function(e){if(!Lu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ne.Component=js;Ne.Fragment=Pv;Ne.Profiler=Rv;Ne.PureComponent=Pu;Ne.StrictMode=Iv;Ne.Suspense=Uv;Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kv;Ne.act=em;Ne.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=qx({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Ru.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Jx.call(t,l)&&!Qx.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ro,type:e.type,key:a,ref:s,props:n,_owner:i}};Ne.createContext=function(e){return e={$$typeof:Mv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Lv,_context:e},e.Consumer=e};Ne.createElement=Zx;Ne.createFactory=function(e){var t=Zx.bind(null,e);return t.type=e,t};Ne.createRef=function(){return{current:null}};Ne.forwardRef=function(e){return{$$typeof:Bv,render:e}};Ne.isValidElement=Lu;Ne.lazy=function(e){return{$$typeof:Hv,_payload:{_status:-1,_result:e},_init:Gv}};Ne.memo=function(e,t){return{$$typeof:$v,type:e,compare:t===void 0?null:t}};Ne.startTransition=function(e){var t=Yo.transition;Yo.transition={};try{e()}finally{Yo.transition=t}};Ne.unstable_act=em;Ne.useCallback=function(e,t){return Gt.current.useCallback(e,t)};Ne.useContext=function(e){return Gt.current.useContext(e)};Ne.useDebugValue=function(){};Ne.useDeferredValue=function(e){return Gt.current.useDeferredValue(e)};Ne.useEffect=function(e,t){return Gt.current.useEffect(e,t)};Ne.useId=function(){return Gt.current.useId()};Ne.useImperativeHandle=function(e,t,r){return Gt.current.useImperativeHandle(e,t,r)};Ne.useInsertionEffect=function(e,t){return Gt.current.useInsertionEffect(e,t)};Ne.useLayoutEffect=function(e,t){return Gt.current.useLayoutEffect(e,t)};Ne.useMemo=function(e,t){return Gt.current.useMemo(e,t)};Ne.useReducer=function(e,t,r){return Gt.current.useReducer(e,t,r)};Ne.useRef=function(e){return Gt.current.useRef(e)};Ne.useState=function(e){return Gt.current.useState(e)};Ne.useSyncExternalStore=function(e,t,r){return Gt.current.useSyncExternalStore(e,t,r)};Ne.useTransition=function(){return Gt.current.useTransition()};Ne.version="18.3.1";Gx.exports=Ne;var Y=Gx.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv=Y,Xv=Symbol.for("react.element"),Yv=Symbol.for("react.fragment"),Jv=Object.prototype.hasOwnProperty,Qv=qv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zv={key:!0,ref:!0,__self:!0,__source:!0};function tm(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)Jv.call(t,n)&&!Zv.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Xv,type:e,key:s,ref:i,props:a,_owner:Qv.current}}Xl.Fragment=Yv;Xl.jsx=tm;Xl.jsxs=tm;Wx.exports=Xl;var u=Wx.exports,rm={exports:{}},fr={},nm={exports:{}},am={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(te,U){var q=te.length;te.push(U);e:for(;0<q;){var se=q-1>>>1,j=te[se];if(0<a(j,U))te[se]=U,te[q]=j,q=se;else break e}}function r(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var U=te[0],q=te.pop();if(q!==U){te[0]=q;e:for(var se=0,j=te.length,z=j>>>1;se<z;){var M=2*(se+1)-1,B=te[M],J=M+1,ie=te[J];if(0>a(B,q))J<j&&0>a(ie,B)?(te[se]=ie,te[J]=q,se=J):(te[se]=B,te[M]=q,se=M);else if(J<j&&0>a(ie,q))te[se]=ie,te[J]=q,se=J;else break e}}return U}function a(te,U){var q=te.sortIndex-U.sortIndex;return q!==0?q:te.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,h=3,x=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(te){for(var U=r(c);U!==null;){if(U.callback===null)n(c);else if(U.startTime<=te)n(c),U.sortIndex=U.expirationTime,t(l,U);else break;U=r(c)}}function S(te){if(m=!1,g(te),!p)if(r(l)!==null)p=!0,ee(k);else{var U=r(c);U!==null&&oe(S,U.startTime-te)}}function k(te,U){p=!1,m&&(m=!1,y(A),A=-1),x=!0;var q=h;try{for(g(U),d=r(l);d!==null&&(!(d.expirationTime>U)||te&&!L());){var se=d.callback;if(typeof se=="function"){d.callback=null,h=d.priorityLevel;var j=se(d.expirationTime<=U);U=e.unstable_now(),typeof j=="function"?d.callback=j:d===r(l)&&n(l),g(U)}else n(l);d=r(l)}if(d!==null)var z=!0;else{var M=r(c);M!==null&&oe(S,M.startTime-U),z=!1}return z}finally{d=null,h=q,x=!1}}var T=!1,_=null,A=-1,b=5,R=-1;function L(){return!(e.unstable_now()-R<b)}function I(){if(_!==null){var te=e.unstable_now();R=te;var U=!0;try{U=_(!0,te)}finally{U?H():(T=!1,_=null)}}else T=!1}var H;if(typeof w=="function")H=function(){w(I)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,X=Z.port2;Z.port1.onmessage=I,H=function(){X.postMessage(null)}}else H=function(){v(I,0)};function ee(te){_=te,T||(T=!0,H())}function oe(te,U){A=v(function(){te(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_continueExecution=function(){p||x||(p=!0,ee(k))},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(te){switch(h){case 1:case 2:case 3:var U=3;break;default:U=h}var q=h;h=U;try{return te()}finally{h=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(te,U){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var q=h;h=te;try{return U()}finally{h=q}},e.unstable_scheduleCallback=function(te,U,q){var se=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?se+q:se):q=se,te){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=q+j,te={id:f++,callback:U,priorityLevel:te,startTime:q,expirationTime:j,sortIndex:-1},q>se?(te.sortIndex=q,t(c,te),r(l)===null&&te===r(c)&&(m?(y(A),A=-1):m=!0,oe(S,q-se))):(te.sortIndex=j,t(l,te),p||x||(p=!0,ee(k))),te},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(te){var U=h;return function(){var q=h;h=U;try{return te.apply(this,arguments)}finally{h=q}}}})(am);nm.exports=am;var ey=nm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty=Y,cr=ey;function ae(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sm=new Set,Ai={};function Aa(e,t){vs(e,t),vs(e+"Capture",t)}function vs(e,t){for(Ai[e]=t,e=0;e<t.length;e++)sm.add(t[e])}var xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x0=Object.prototype.hasOwnProperty,ry=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pd={},gd={};function ny(e){return x0.call(gd,e)?!0:x0.call(pd,e)?!1:ry.test(e)?gd[e]=!0:(pd[e]=!0,!1)}function ay(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function sy(e,t,r,n){if(t===null||typeof t>"u"||ay(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Kt(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Et[e]=new Kt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Et[t]=new Kt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Et[e]=new Kt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Et[e]=new Kt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Et[e]=new Kt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Et[e]=new Kt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Et[e]=new Kt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Et[e]=new Kt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Et[e]=new Kt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mu=/[\-:]([a-z])/g;function Bu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Mu,Bu);Et[t]=new Kt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Mu,Bu);Et[t]=new Kt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Mu,Bu);Et[t]=new Kt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Et[e]=new Kt(e,1,!1,e.toLowerCase(),null,!1,!1)});Et.xlinkHref=new Kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Et[e]=new Kt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Uu(e,t,r,n){var a=Et.hasOwnProperty(t)?Et[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(sy(t,r,a,n)&&(r=null),n||a===null?ny(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var yn=ty.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yo=Symbol.for("react.element"),Xa=Symbol.for("react.portal"),Ya=Symbol.for("react.fragment"),$u=Symbol.for("react.strict_mode"),m0=Symbol.for("react.profiler"),im=Symbol.for("react.provider"),om=Symbol.for("react.context"),Hu=Symbol.for("react.forward_ref"),p0=Symbol.for("react.suspense"),g0=Symbol.for("react.suspense_list"),zu=Symbol.for("react.memo"),Nn=Symbol.for("react.lazy"),lm=Symbol.for("react.offscreen"),vd=Symbol.iterator;function zs(e){return e===null||typeof e!="object"?null:(e=vd&&e[vd]||e["@@iterator"],typeof e=="function"?e:null)}var Xe=Object.assign,Sc;function Qs(e){if(Sc===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Sc=t&&t[1]||""}return`
`+Sc+e}var Tc=!1;function bc(e,t){if(!e||Tc)return"";Tc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Tc=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Qs(e):""}function iy(e){switch(e.tag){case 5:return Qs(e.type);case 16:return Qs("Lazy");case 13:return Qs("Suspense");case 19:return Qs("SuspenseList");case 0:case 2:case 15:return e=bc(e.type,!1),e;case 11:return e=bc(e.type.render,!1),e;case 1:return e=bc(e.type,!0),e;default:return""}}function v0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ya:return"Fragment";case Xa:return"Portal";case m0:return"Profiler";case $u:return"StrictMode";case p0:return"Suspense";case g0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case om:return(e.displayName||"Context")+".Consumer";case im:return(e._context.displayName||"Context")+".Provider";case Hu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zu:return t=e.displayName||null,t!==null?t:v0(e.type)||"Memo";case Nn:t=e._payload,e=e._init;try{return v0(e(t))}catch{}}return null}function oy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return v0(t);case 8:return t===$u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function qn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function cm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ly(e){var t=cm(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wo(e){e._valueTracker||(e._valueTracker=ly(e))}function um(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=cm(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function cl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function y0(e,t){var r=t.checked;return Xe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function yd(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=qn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function fm(e,t){t=t.checked,t!=null&&Uu(e,"checked",t,!1)}function w0(e,t){fm(e,t);var r=qn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_0(e,t.type,r):t.hasOwnProperty("defaultValue")&&_0(e,t.type,qn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function wd(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function _0(e,t,r){(t!=="number"||cl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Zs=Array.isArray;function ls(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+qn(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function k0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Xe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function _d(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ae(92));if(Zs(r)){if(1<r.length)throw Error(ae(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:qn(r)}}function dm(e,t){var r=qn(t.value),n=qn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function kd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function hm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function E0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?hm(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _o,xm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_o=_o||document.createElement("div"),_o.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_o.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Fi(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var oi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cy=["Webkit","ms","Moz","O"];Object.keys(oi).forEach(function(e){cy.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),oi[t]=oi[e]})});function mm(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||oi.hasOwnProperty(e)&&oi[e]?(""+t).trim():t+"px"}function pm(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=mm(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var uy=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function S0(e,t){if(t){if(uy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ae(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ae(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ae(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ae(62))}}function T0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var b0=null;function Vu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var N0=null,cs=null,us=null;function Ed(e){if(e=so(e)){if(typeof N0!="function")throw Error(ae(280));var t=e.stateNode;t&&(t=ec(t),N0(e.stateNode,e.type,t))}}function gm(e){cs?us?us.push(e):us=[e]:cs=e}function vm(){if(cs){var e=cs,t=us;if(us=cs=null,Ed(e),t)for(e=0;e<t.length;e++)Ed(t[e])}}function ym(e,t){return e(t)}function wm(){}var Nc=!1;function _m(e,t,r){if(Nc)return e(t,r);Nc=!0;try{return ym(e,t,r)}finally{Nc=!1,(cs!==null||us!==null)&&(wm(),vm())}}function ji(e,t){var r=e.stateNode;if(r===null)return null;var n=ec(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ae(231,t,typeof r));return r}var C0=!1;if(xn)try{var Vs={};Object.defineProperty(Vs,"passive",{get:function(){C0=!0}}),window.addEventListener("test",Vs,Vs),window.removeEventListener("test",Vs,Vs)}catch{C0=!1}function fy(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var li=!1,ul=null,fl=!1,A0=null,dy={onError:function(e){li=!0,ul=e}};function hy(e,t,r,n,a,s,i,o,l){li=!1,ul=null,fy.apply(dy,arguments)}function xy(e,t,r,n,a,s,i,o,l){if(hy.apply(this,arguments),li){if(li){var c=ul;li=!1,ul=null}else throw Error(ae(198));fl||(fl=!0,A0=c)}}function Fa(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function km(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Sd(e){if(Fa(e)!==e)throw Error(ae(188))}function my(e){var t=e.alternate;if(!t){if(t=Fa(e),t===null)throw Error(ae(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Sd(a),e;if(s===n)return Sd(a),t;s=s.sibling}throw Error(ae(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(ae(189))}}if(r.alternate!==n)throw Error(ae(190))}if(r.tag!==3)throw Error(ae(188));return r.stateNode.current===r?e:t}function Em(e){return e=my(e),e!==null?Sm(e):null}function Sm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Sm(e);if(t!==null)return t;e=e.sibling}return null}var Tm=cr.unstable_scheduleCallback,Td=cr.unstable_cancelCallback,py=cr.unstable_shouldYield,gy=cr.unstable_requestPaint,tt=cr.unstable_now,vy=cr.unstable_getCurrentPriorityLevel,Wu=cr.unstable_ImmediatePriority,bm=cr.unstable_UserBlockingPriority,dl=cr.unstable_NormalPriority,yy=cr.unstable_LowPriority,Nm=cr.unstable_IdlePriority,Yl=null,Yr=null;function wy(e){if(Yr&&typeof Yr.onCommitFiberRoot=="function")try{Yr.onCommitFiberRoot(Yl,e,void 0,(e.current.flags&128)===128)}catch{}}var Br=Math.clz32?Math.clz32:Ey,_y=Math.log,ky=Math.LN2;function Ey(e){return e>>>=0,e===0?32:31-(_y(e)/ky|0)|0}var ko=64,Eo=4194304;function ei(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function hl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=ei(o):(s&=i,s!==0&&(n=ei(s)))}else i=r&~a,i!==0?n=ei(i):s!==0&&(n=ei(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Br(t),a=1<<r,n|=e[r],t&=~a;return n}function Sy(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ty(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Br(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=Sy(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function F0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Cm(){var e=ko;return ko<<=1,!(ko&4194240)&&(ko=64),e}function Cc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function no(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Br(t),e[t]=r}function by(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Br(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function Gu(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Br(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Ie=0;function Am(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Fm,Ku,jm,Om,Dm,j0=!1,So=[],Mn=null,Bn=null,Un=null,Oi=new Map,Di=new Map,An=[],Ny="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bd(e,t){switch(e){case"focusin":case"focusout":Mn=null;break;case"dragenter":case"dragleave":Bn=null;break;case"mouseover":case"mouseout":Un=null;break;case"pointerover":case"pointerout":Oi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Di.delete(t.pointerId)}}function Ws(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=so(t),t!==null&&Ku(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Cy(e,t,r,n,a){switch(t){case"focusin":return Mn=Ws(Mn,e,t,r,n,a),!0;case"dragenter":return Bn=Ws(Bn,e,t,r,n,a),!0;case"mouseover":return Un=Ws(Un,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Oi.set(s,Ws(Oi.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Di.set(s,Ws(Di.get(s)||null,e,t,r,n,a)),!0}return!1}function Pm(e){var t=da(e.target);if(t!==null){var r=Fa(t);if(r!==null){if(t=r.tag,t===13){if(t=km(r),t!==null){e.blockedOn=t,Dm(e.priority,function(){jm(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Jo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=O0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);b0=n,r.target.dispatchEvent(n),b0=null}else return t=so(r),t!==null&&Ku(t),e.blockedOn=r,!1;t.shift()}return!0}function Nd(e,t,r){Jo(e)&&r.delete(t)}function Ay(){j0=!1,Mn!==null&&Jo(Mn)&&(Mn=null),Bn!==null&&Jo(Bn)&&(Bn=null),Un!==null&&Jo(Un)&&(Un=null),Oi.forEach(Nd),Di.forEach(Nd)}function Gs(e,t){e.blockedOn===t&&(e.blockedOn=null,j0||(j0=!0,cr.unstable_scheduleCallback(cr.unstable_NormalPriority,Ay)))}function Pi(e){function t(a){return Gs(a,e)}if(0<So.length){Gs(So[0],e);for(var r=1;r<So.length;r++){var n=So[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Mn!==null&&Gs(Mn,e),Bn!==null&&Gs(Bn,e),Un!==null&&Gs(Un,e),Oi.forEach(t),Di.forEach(t),r=0;r<An.length;r++)n=An[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<An.length&&(r=An[0],r.blockedOn===null);)Pm(r),r.blockedOn===null&&An.shift()}var fs=yn.ReactCurrentBatchConfig,xl=!0;function Fy(e,t,r,n){var a=Ie,s=fs.transition;fs.transition=null;try{Ie=1,qu(e,t,r,n)}finally{Ie=a,fs.transition=s}}function jy(e,t,r,n){var a=Ie,s=fs.transition;fs.transition=null;try{Ie=4,qu(e,t,r,n)}finally{Ie=a,fs.transition=s}}function qu(e,t,r,n){if(xl){var a=O0(e,t,r,n);if(a===null)Mc(e,t,n,ml,r),bd(e,n);else if(Cy(a,e,t,r,n))n.stopPropagation();else if(bd(e,n),t&4&&-1<Ny.indexOf(e)){for(;a!==null;){var s=so(a);if(s!==null&&Fm(s),s=O0(e,t,r,n),s===null&&Mc(e,t,n,ml,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Mc(e,t,n,null,r)}}var ml=null;function O0(e,t,r,n){if(ml=null,e=Vu(n),e=da(e),e!==null)if(t=Fa(e),t===null)e=null;else if(r=t.tag,r===13){if(e=km(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ml=e,null}function Im(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vy()){case Wu:return 1;case bm:return 4;case dl:case yy:return 16;case Nm:return 536870912;default:return 16}default:return 16}}var Pn=null,Xu=null,Qo=null;function Rm(){if(Qo)return Qo;var e,t=Xu,r=t.length,n,a="value"in Pn?Pn.value:Pn.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Qo=a.slice(e,1<n?1-n:void 0)}function Zo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function To(){return!0}function Cd(){return!1}function dr(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?To:Cd,this.isPropagationStopped=Cd,this}return Xe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=To)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=To)},persist:function(){},isPersistent:To}),t}var Os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yu=dr(Os),ao=Xe({},Os,{view:0,detail:0}),Oy=dr(ao),Ac,Fc,Ks,Jl=Xe({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ju,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ks&&(Ks&&e.type==="mousemove"?(Ac=e.screenX-Ks.screenX,Fc=e.screenY-Ks.screenY):Fc=Ac=0,Ks=e),Ac)},movementY:function(e){return"movementY"in e?e.movementY:Fc}}),Ad=dr(Jl),Dy=Xe({},Jl,{dataTransfer:0}),Py=dr(Dy),Iy=Xe({},ao,{relatedTarget:0}),jc=dr(Iy),Ry=Xe({},Os,{animationName:0,elapsedTime:0,pseudoElement:0}),Ly=dr(Ry),My=Xe({},Os,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),By=dr(My),Uy=Xe({},Os,{data:0}),Fd=dr(Uy),$y={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zy[e])?!!t[e]:!1}function Ju(){return Vy}var Wy=Xe({},ao,{key:function(e){if(e.key){var t=$y[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Hy[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ju,charCode:function(e){return e.type==="keypress"?Zo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Gy=dr(Wy),Ky=Xe({},Jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jd=dr(Ky),qy=Xe({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ju}),Xy=dr(qy),Yy=Xe({},Os,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jy=dr(Yy),Qy=Xe({},Jl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zy=dr(Qy),ew=[9,13,27,32],Qu=xn&&"CompositionEvent"in window,ci=null;xn&&"documentMode"in document&&(ci=document.documentMode);var tw=xn&&"TextEvent"in window&&!ci,Lm=xn&&(!Qu||ci&&8<ci&&11>=ci),Od=" ",Dd=!1;function Mm(e,t){switch(e){case"keyup":return ew.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ja=!1;function rw(e,t){switch(e){case"compositionend":return Bm(t);case"keypress":return t.which!==32?null:(Dd=!0,Od);case"textInput":return e=t.data,e===Od&&Dd?null:e;default:return null}}function nw(e,t){if(Ja)return e==="compositionend"||!Qu&&Mm(e,t)?(e=Rm(),Qo=Xu=Pn=null,Ja=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Lm&&t.locale!=="ko"?null:t.data;default:return null}}var aw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!aw[e.type]:t==="textarea"}function Um(e,t,r,n){gm(n),t=pl(t,"onChange"),0<t.length&&(r=new Yu("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ui=null,Ii=null;function sw(e){Jm(e,0)}function Ql(e){var t=es(e);if(um(t))return e}function iw(e,t){if(e==="change")return t}var $m=!1;if(xn){var Oc;if(xn){var Dc="oninput"in document;if(!Dc){var Id=document.createElement("div");Id.setAttribute("oninput","return;"),Dc=typeof Id.oninput=="function"}Oc=Dc}else Oc=!1;$m=Oc&&(!document.documentMode||9<document.documentMode)}function Rd(){ui&&(ui.detachEvent("onpropertychange",Hm),Ii=ui=null)}function Hm(e){if(e.propertyName==="value"&&Ql(Ii)){var t=[];Um(t,Ii,e,Vu(e)),_m(sw,t)}}function ow(e,t,r){e==="focusin"?(Rd(),ui=t,Ii=r,ui.attachEvent("onpropertychange",Hm)):e==="focusout"&&Rd()}function lw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ql(Ii)}function cw(e,t){if(e==="click")return Ql(t)}function uw(e,t){if(e==="input"||e==="change")return Ql(t)}function fw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Hr=typeof Object.is=="function"?Object.is:fw;function Ri(e,t){if(Hr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!x0.call(t,a)||!Hr(e[a],t[a]))return!1}return!0}function Ld(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Md(e,t){var r=Ld(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ld(r)}}function zm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?zm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Vm(){for(var e=window,t=cl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=cl(e.document)}return t}function Zu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function dw(e){var t=Vm(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&zm(r.ownerDocument.documentElement,r)){if(n!==null&&Zu(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Md(r,s);var i=Md(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hw=xn&&"documentMode"in document&&11>=document.documentMode,Qa=null,D0=null,fi=null,P0=!1;function Bd(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;P0||Qa==null||Qa!==cl(n)||(n=Qa,"selectionStart"in n&&Zu(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),fi&&Ri(fi,n)||(fi=n,n=pl(D0,"onSelect"),0<n.length&&(t=new Yu("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Qa)))}function bo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Za={animationend:bo("Animation","AnimationEnd"),animationiteration:bo("Animation","AnimationIteration"),animationstart:bo("Animation","AnimationStart"),transitionend:bo("Transition","TransitionEnd")},Pc={},Wm={};xn&&(Wm=document.createElement("div").style,"AnimationEvent"in window||(delete Za.animationend.animation,delete Za.animationiteration.animation,delete Za.animationstart.animation),"TransitionEvent"in window||delete Za.transitionend.transition);function Zl(e){if(Pc[e])return Pc[e];if(!Za[e])return e;var t=Za[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Wm)return Pc[e]=t[r];return e}var Gm=Zl("animationend"),Km=Zl("animationiteration"),qm=Zl("animationstart"),Xm=Zl("transitionend"),Ym=new Map,Ud="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qn(e,t){Ym.set(e,t),Aa(t,[e])}for(var Ic=0;Ic<Ud.length;Ic++){var Rc=Ud[Ic],xw=Rc.toLowerCase(),mw=Rc[0].toUpperCase()+Rc.slice(1);Qn(xw,"on"+mw)}Qn(Gm,"onAnimationEnd");Qn(Km,"onAnimationIteration");Qn(qm,"onAnimationStart");Qn("dblclick","onDoubleClick");Qn("focusin","onFocus");Qn("focusout","onBlur");Qn(Xm,"onTransitionEnd");vs("onMouseEnter",["mouseout","mouseover"]);vs("onMouseLeave",["mouseout","mouseover"]);vs("onPointerEnter",["pointerout","pointerover"]);vs("onPointerLeave",["pointerout","pointerover"]);Aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Aa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ti="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pw=new Set("cancel close invalid load scroll toggle".split(" ").concat(ti));function $d(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,xy(n,t,void 0,e),e.currentTarget=null}function Jm(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;$d(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;$d(a,o,c),s=l}}}if(fl)throw e=A0,fl=!1,A0=null,e}function Be(e,t){var r=t[B0];r===void 0&&(r=t[B0]=new Set);var n=e+"__bubble";r.has(n)||(Qm(t,e,2,!1),r.add(n))}function Lc(e,t,r){var n=0;t&&(n|=4),Qm(r,e,n,t)}var No="_reactListening"+Math.random().toString(36).slice(2);function Li(e){if(!e[No]){e[No]=!0,sm.forEach(function(r){r!=="selectionchange"&&(pw.has(r)||Lc(r,!1,e),Lc(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[No]||(t[No]=!0,Lc("selectionchange",!1,t))}}function Qm(e,t,r,n){switch(Im(t)){case 1:var a=Fy;break;case 4:a=jy;break;default:a=qu}r=a.bind(null,t,r,e),a=void 0,!C0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Mc(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=da(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}_m(function(){var c=s,f=Vu(r),d=[];e:{var h=Ym.get(e);if(h!==void 0){var x=Yu,p=e;switch(e){case"keypress":if(Zo(r)===0)break e;case"keydown":case"keyup":x=Gy;break;case"focusin":p="focus",x=jc;break;case"focusout":p="blur",x=jc;break;case"beforeblur":case"afterblur":x=jc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Ad;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=Py;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Xy;break;case Gm:case Km:case qm:x=Ly;break;case Xm:x=Jy;break;case"scroll":x=Oy;break;case"wheel":x=Zy;break;case"copy":case"cut":case"paste":x=By;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=jd}var m=(t&4)!==0,v=!m&&e==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var w=c,g;w!==null;){g=w;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,y!==null&&(S=ji(w,y),S!=null&&m.push(Mi(w,S,g)))),v)break;w=w.return}0<m.length&&(h=new x(h,p,null,r,f),d.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",h&&r!==b0&&(p=r.relatedTarget||r.fromElement)&&(da(p)||p[mn]))break e;if((x||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,x?(p=r.relatedTarget||r.toElement,x=c,p=p?da(p):null,p!==null&&(v=Fa(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(x=null,p=c),x!==p)){if(m=Ad,S="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(m=jd,S="onPointerLeave",y="onPointerEnter",w="pointer"),v=x==null?h:es(x),g=p==null?h:es(p),h=new m(S,w+"leave",x,r,f),h.target=v,h.relatedTarget=g,S=null,da(f)===c&&(m=new m(y,w+"enter",p,r,f),m.target=g,m.relatedTarget=v,S=m),v=S,x&&p)t:{for(m=x,y=p,w=0,g=m;g;g=Ba(g))w++;for(g=0,S=y;S;S=Ba(S))g++;for(;0<w-g;)m=Ba(m),w--;for(;0<g-w;)y=Ba(y),g--;for(;w--;){if(m===y||y!==null&&m===y.alternate)break t;m=Ba(m),y=Ba(y)}m=null}else m=null;x!==null&&Hd(d,h,x,m,!1),p!==null&&v!==null&&Hd(d,v,p,m,!0)}}e:{if(h=c?es(c):window,x=h.nodeName&&h.nodeName.toLowerCase(),x==="select"||x==="input"&&h.type==="file")var k=iw;else if(Pd(h))if($m)k=uw;else{k=lw;var T=ow}else(x=h.nodeName)&&x.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=cw);if(k&&(k=k(e,c))){Um(d,k,r,f);break e}T&&T(e,h,c),e==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&_0(h,"number",h.value)}switch(T=c?es(c):window,e){case"focusin":(Pd(T)||T.contentEditable==="true")&&(Qa=T,D0=c,fi=null);break;case"focusout":fi=D0=Qa=null;break;case"mousedown":P0=!0;break;case"contextmenu":case"mouseup":case"dragend":P0=!1,Bd(d,r,f);break;case"selectionchange":if(hw)break;case"keydown":case"keyup":Bd(d,r,f)}var _;if(Qu)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Ja?Mm(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(Lm&&r.locale!=="ko"&&(Ja||A!=="onCompositionStart"?A==="onCompositionEnd"&&Ja&&(_=Rm()):(Pn=f,Xu="value"in Pn?Pn.value:Pn.textContent,Ja=!0)),T=pl(c,A),0<T.length&&(A=new Fd(A,e,null,r,f),d.push({event:A,listeners:T}),_?A.data=_:(_=Bm(r),_!==null&&(A.data=_)))),(_=tw?rw(e,r):nw(e,r))&&(c=pl(c,"onBeforeInput"),0<c.length&&(f=new Fd("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:c}),f.data=_))}Jm(d,t)})}function Mi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function pl(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=ji(e,r),s!=null&&n.unshift(Mi(e,s,a)),s=ji(e,t),s!=null&&n.push(Mi(e,s,a))),e=e.return}return n}function Ba(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Hd(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=ji(r,s),l!=null&&i.unshift(Mi(r,l,o))):a||(l=ji(r,s),l!=null&&i.push(Mi(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var gw=/\r\n?/g,vw=/\u0000|\uFFFD/g;function zd(e){return(typeof e=="string"?e:""+e).replace(gw,`
`).replace(vw,"")}function Co(e,t,r){if(t=zd(t),zd(e)!==t&&r)throw Error(ae(425))}function gl(){}var I0=null,R0=null;function L0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var M0=typeof setTimeout=="function"?setTimeout:void 0,yw=typeof clearTimeout=="function"?clearTimeout:void 0,Vd=typeof Promise=="function"?Promise:void 0,ww=typeof queueMicrotask=="function"?queueMicrotask:typeof Vd<"u"?function(e){return Vd.resolve(null).then(e).catch(_w)}:M0;function _w(e){setTimeout(function(){throw e})}function Bc(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Pi(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Pi(t)}function $n(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Wd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ds=Math.random().toString(36).slice(2),Xr="__reactFiber$"+Ds,Bi="__reactProps$"+Ds,mn="__reactContainer$"+Ds,B0="__reactEvents$"+Ds,kw="__reactListeners$"+Ds,Ew="__reactHandles$"+Ds;function da(e){var t=e[Xr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[mn]||r[Xr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Wd(e);e!==null;){if(r=e[Xr])return r;e=Wd(e)}return t}e=r,r=e.parentNode}return null}function so(e){return e=e[Xr]||e[mn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function es(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ae(33))}function ec(e){return e[Bi]||null}var U0=[],ts=-1;function Zn(e){return{current:e}}function Ue(e){0>ts||(e.current=U0[ts],U0[ts]=null,ts--)}function Le(e,t){ts++,U0[ts]=e.current,e.current=t}var Xn={},Dt=Zn(Xn),Zt=Zn(!1),_a=Xn;function ys(e,t){var r=e.type.contextTypes;if(!r)return Xn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function er(e){return e=e.childContextTypes,e!=null}function vl(){Ue(Zt),Ue(Dt)}function Gd(e,t,r){if(Dt.current!==Xn)throw Error(ae(168));Le(Dt,t),Le(Zt,r)}function Zm(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ae(108,oy(e)||"Unknown",a));return Xe({},r,n)}function yl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xn,_a=Dt.current,Le(Dt,e),Le(Zt,Zt.current),!0}function Kd(e,t,r){var n=e.stateNode;if(!n)throw Error(ae(169));r?(e=Zm(e,t,_a),n.__reactInternalMemoizedMergedChildContext=e,Ue(Zt),Ue(Dt),Le(Dt,e)):Ue(Zt),Le(Zt,r)}var on=null,tc=!1,Uc=!1;function ep(e){on===null?on=[e]:on.push(e)}function Sw(e){tc=!0,ep(e)}function ea(){if(!Uc&&on!==null){Uc=!0;var e=0,t=Ie;try{var r=on;for(Ie=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}on=null,tc=!1}catch(a){throw on!==null&&(on=on.slice(e+1)),Tm(Wu,ea),a}finally{Ie=t,Uc=!1}}return null}var rs=[],ns=0,wl=null,_l=0,yr=[],wr=0,ka=null,ln=1,cn="";function oa(e,t){rs[ns++]=_l,rs[ns++]=wl,wl=e,_l=t}function tp(e,t,r){yr[wr++]=ln,yr[wr++]=cn,yr[wr++]=ka,ka=e;var n=ln;e=cn;var a=32-Br(n)-1;n&=~(1<<a),r+=1;var s=32-Br(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ln=1<<32-Br(t)+a|r<<a|n,cn=s+e}else ln=1<<s|r<<a|n,cn=e}function ef(e){e.return!==null&&(oa(e,1),tp(e,1,0))}function tf(e){for(;e===wl;)wl=rs[--ns],rs[ns]=null,_l=rs[--ns],rs[ns]=null;for(;e===ka;)ka=yr[--wr],yr[wr]=null,cn=yr[--wr],yr[wr]=null,ln=yr[--wr],yr[wr]=null}var lr=null,or=null,He=!1,Ir=null;function rp(e,t){var r=_r(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function qd(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,lr=e,or=$n(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,lr=e,or=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ka!==null?{id:ln,overflow:cn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=_r(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,lr=e,or=null,!0):!1;default:return!1}}function $0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function H0(e){if(He){var t=or;if(t){var r=t;if(!qd(e,t)){if($0(e))throw Error(ae(418));t=$n(r.nextSibling);var n=lr;t&&qd(e,t)?rp(n,r):(e.flags=e.flags&-4097|2,He=!1,lr=e)}}else{if($0(e))throw Error(ae(418));e.flags=e.flags&-4097|2,He=!1,lr=e}}}function Xd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;lr=e}function Ao(e){if(e!==lr)return!1;if(!He)return Xd(e),He=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!L0(e.type,e.memoizedProps)),t&&(t=or)){if($0(e))throw np(),Error(ae(418));for(;t;)rp(e,t),t=$n(t.nextSibling)}if(Xd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ae(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){or=$n(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}or=null}}else or=lr?$n(e.stateNode.nextSibling):null;return!0}function np(){for(var e=or;e;)e=$n(e.nextSibling)}function ws(){or=lr=null,He=!1}function rf(e){Ir===null?Ir=[e]:Ir.push(e)}var Tw=yn.ReactCurrentBatchConfig;function qs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ae(309));var n=r.stateNode}if(!n)throw Error(ae(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(ae(284));if(!r._owner)throw Error(ae(290,e))}return e}function Fo(e,t){throw e=Object.prototype.toString.call(t),Error(ae(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yd(e){var t=e._init;return t(e._payload)}function ap(e){function t(y,w){if(e){var g=y.deletions;g===null?(y.deletions=[w],y.flags|=16):g.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function a(y,w){return y=Wn(y,w),y.index=0,y.sibling=null,y}function s(y,w,g){return y.index=g,e?(g=y.alternate,g!==null?(g=g.index,g<w?(y.flags|=2,w):g):(y.flags|=2,w)):(y.flags|=1048576,w)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,g,S){return w===null||w.tag!==6?(w=Kc(g,y.mode,S),w.return=y,w):(w=a(w,g),w.return=y,w)}function l(y,w,g,S){var k=g.type;return k===Ya?f(y,w,g.props.children,S,g.key):w!==null&&(w.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Nn&&Yd(k)===w.type)?(S=a(w,g.props),S.ref=qs(y,w,g),S.return=y,S):(S=il(g.type,g.key,g.props,null,y.mode,S),S.ref=qs(y,w,g),S.return=y,S)}function c(y,w,g,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==g.containerInfo||w.stateNode.implementation!==g.implementation?(w=qc(g,y.mode,S),w.return=y,w):(w=a(w,g.children||[]),w.return=y,w)}function f(y,w,g,S,k){return w===null||w.tag!==7?(w=ga(g,y.mode,S,k),w.return=y,w):(w=a(w,g),w.return=y,w)}function d(y,w,g){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Kc(""+w,y.mode,g),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case yo:return g=il(w.type,w.key,w.props,null,y.mode,g),g.ref=qs(y,null,w),g.return=y,g;case Xa:return w=qc(w,y.mode,g),w.return=y,w;case Nn:var S=w._init;return d(y,S(w._payload),g)}if(Zs(w)||zs(w))return w=ga(w,y.mode,g,null),w.return=y,w;Fo(y,w)}return null}function h(y,w,g,S){var k=w!==null?w.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return k!==null?null:o(y,w,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case yo:return g.key===k?l(y,w,g,S):null;case Xa:return g.key===k?c(y,w,g,S):null;case Nn:return k=g._init,h(y,w,k(g._payload),S)}if(Zs(g)||zs(g))return k!==null?null:f(y,w,g,S,null);Fo(y,g)}return null}function x(y,w,g,S,k){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(g)||null,o(w,y,""+S,k);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case yo:return y=y.get(S.key===null?g:S.key)||null,l(w,y,S,k);case Xa:return y=y.get(S.key===null?g:S.key)||null,c(w,y,S,k);case Nn:var T=S._init;return x(y,w,g,T(S._payload),k)}if(Zs(S)||zs(S))return y=y.get(g)||null,f(w,y,S,k,null);Fo(w,S)}return null}function p(y,w,g,S){for(var k=null,T=null,_=w,A=w=0,b=null;_!==null&&A<g.length;A++){_.index>A?(b=_,_=null):b=_.sibling;var R=h(y,_,g[A],S);if(R===null){_===null&&(_=b);break}e&&_&&R.alternate===null&&t(y,_),w=s(R,w,A),T===null?k=R:T.sibling=R,T=R,_=b}if(A===g.length)return r(y,_),He&&oa(y,A),k;if(_===null){for(;A<g.length;A++)_=d(y,g[A],S),_!==null&&(w=s(_,w,A),T===null?k=_:T.sibling=_,T=_);return He&&oa(y,A),k}for(_=n(y,_);A<g.length;A++)b=x(_,y,A,g[A],S),b!==null&&(e&&b.alternate!==null&&_.delete(b.key===null?A:b.key),w=s(b,w,A),T===null?k=b:T.sibling=b,T=b);return e&&_.forEach(function(L){return t(y,L)}),He&&oa(y,A),k}function m(y,w,g,S){var k=zs(g);if(typeof k!="function")throw Error(ae(150));if(g=k.call(g),g==null)throw Error(ae(151));for(var T=k=null,_=w,A=w=0,b=null,R=g.next();_!==null&&!R.done;A++,R=g.next()){_.index>A?(b=_,_=null):b=_.sibling;var L=h(y,_,R.value,S);if(L===null){_===null&&(_=b);break}e&&_&&L.alternate===null&&t(y,_),w=s(L,w,A),T===null?k=L:T.sibling=L,T=L,_=b}if(R.done)return r(y,_),He&&oa(y,A),k;if(_===null){for(;!R.done;A++,R=g.next())R=d(y,R.value,S),R!==null&&(w=s(R,w,A),T===null?k=R:T.sibling=R,T=R);return He&&oa(y,A),k}for(_=n(y,_);!R.done;A++,R=g.next())R=x(_,y,A,R.value,S),R!==null&&(e&&R.alternate!==null&&_.delete(R.key===null?A:R.key),w=s(R,w,A),T===null?k=R:T.sibling=R,T=R);return e&&_.forEach(function(I){return t(y,I)}),He&&oa(y,A),k}function v(y,w,g,S){if(typeof g=="object"&&g!==null&&g.type===Ya&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case yo:e:{for(var k=g.key,T=w;T!==null;){if(T.key===k){if(k=g.type,k===Ya){if(T.tag===7){r(y,T.sibling),w=a(T,g.props.children),w.return=y,y=w;break e}}else if(T.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Nn&&Yd(k)===T.type){r(y,T.sibling),w=a(T,g.props),w.ref=qs(y,T,g),w.return=y,y=w;break e}r(y,T);break}else t(y,T);T=T.sibling}g.type===Ya?(w=ga(g.props.children,y.mode,S,g.key),w.return=y,y=w):(S=il(g.type,g.key,g.props,null,y.mode,S),S.ref=qs(y,w,g),S.return=y,y=S)}return i(y);case Xa:e:{for(T=g.key;w!==null;){if(w.key===T)if(w.tag===4&&w.stateNode.containerInfo===g.containerInfo&&w.stateNode.implementation===g.implementation){r(y,w.sibling),w=a(w,g.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=qc(g,y.mode,S),w.return=y,y=w}return i(y);case Nn:return T=g._init,v(y,w,T(g._payload),S)}if(Zs(g))return p(y,w,g,S);if(zs(g))return m(y,w,g,S);Fo(y,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,w!==null&&w.tag===6?(r(y,w.sibling),w=a(w,g),w.return=y,y=w):(r(y,w),w=Kc(g,y.mode,S),w.return=y,y=w),i(y)):r(y,w)}return v}var _s=ap(!0),sp=ap(!1),kl=Zn(null),El=null,as=null,nf=null;function af(){nf=as=El=null}function sf(e){var t=kl.current;Ue(kl),e._currentValue=t}function z0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ds(e,t){El=e,nf=as=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qt=!0),e.firstContext=null)}function Sr(e){var t=e._currentValue;if(nf!==e)if(e={context:e,memoizedValue:t,next:null},as===null){if(El===null)throw Error(ae(308));as=e,El.dependencies={lanes:0,firstContext:e}}else as=as.next=e;return t}var ha=null;function of(e){ha===null?ha=[e]:ha.push(e)}function ip(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,of(t)):(r.next=a.next,a.next=r),t.interleaved=r,pn(e,n)}function pn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Cn=!1;function lf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function op(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Hn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Oe&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,pn(e,r)}return a=n.interleaved,a===null?(t.next=t,of(n)):(t.next=a.next,a.next=t),n.interleaved=t,pn(e,r)}function el(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Gu(e,r)}}function Jd(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Sl(e,t,r,n){var a=e.updateQueue;Cn=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,f=c=l=null,o=s;do{var h=o.lane,x=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,x=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(x,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(x,d,h):p,h==null)break e;d=Xe({},d,h);break e;case 2:Cn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else x={eventTime:x,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=x,l=d):f=f.next=x,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Sa|=i,e.lanes=i,e.memoizedState=d}}function Qd(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ae(191,a));a.call(n)}}}var io={},Jr=Zn(io),Ui=Zn(io),$i=Zn(io);function xa(e){if(e===io)throw Error(ae(174));return e}function cf(e,t){switch(Le($i,t),Le(Ui,e),Le(Jr,io),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:E0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=E0(t,e)}Ue(Jr),Le(Jr,t)}function ks(){Ue(Jr),Ue(Ui),Ue($i)}function lp(e){xa($i.current);var t=xa(Jr.current),r=E0(t,e.type);t!==r&&(Le(Ui,e),Le(Jr,r))}function uf(e){Ui.current===e&&(Ue(Jr),Ue(Ui))}var Ke=Zn(0);function Tl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $c=[];function ff(){for(var e=0;e<$c.length;e++)$c[e]._workInProgressVersionPrimary=null;$c.length=0}var tl=yn.ReactCurrentDispatcher,Hc=yn.ReactCurrentBatchConfig,Ea=0,qe=null,ut=null,mt=null,bl=!1,di=!1,Hi=0,bw=0;function Tt(){throw Error(ae(321))}function df(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Hr(e[r],t[r]))return!1;return!0}function hf(e,t,r,n,a,s){if(Ea=s,qe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,tl.current=e===null||e.memoizedState===null?Fw:jw,e=r(n,a),di){s=0;do{if(di=!1,Hi=0,25<=s)throw Error(ae(301));s+=1,mt=ut=null,t.updateQueue=null,tl.current=Ow,e=r(n,a)}while(di)}if(tl.current=Nl,t=ut!==null&&ut.next!==null,Ea=0,mt=ut=qe=null,bl=!1,t)throw Error(ae(300));return e}function xf(){var e=Hi!==0;return Hi=0,e}function Kr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?qe.memoizedState=mt=e:mt=mt.next=e,mt}function Tr(){if(ut===null){var e=qe.alternate;e=e!==null?e.memoizedState:null}else e=ut.next;var t=mt===null?qe.memoizedState:mt.next;if(t!==null)mt=t,ut=e;else{if(e===null)throw Error(ae(310));ut=e,e={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},mt===null?qe.memoizedState=mt=e:mt=mt.next=e}return mt}function zi(e,t){return typeof t=="function"?t(e):t}function zc(e){var t=Tr(),r=t.queue;if(r===null)throw Error(ae(311));r.lastRenderedReducer=e;var n=ut,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var f=c.lane;if((Ea&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,qe.lanes|=f,Sa|=f}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,Hr(n,t.memoizedState)||(Qt=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,qe.lanes|=s,Sa|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Vc(e){var t=Tr(),r=t.queue;if(r===null)throw Error(ae(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Hr(s,t.memoizedState)||(Qt=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function cp(){}function up(e,t){var r=qe,n=Tr(),a=t(),s=!Hr(n.memoizedState,a);if(s&&(n.memoizedState=a,Qt=!0),n=n.queue,mf(hp.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||mt!==null&&mt.memoizedState.tag&1){if(r.flags|=2048,Vi(9,dp.bind(null,r,n,a,t),void 0,null),pt===null)throw Error(ae(349));Ea&30||fp(r,t,a)}return a}function fp(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=qe.updateQueue,t===null?(t={lastEffect:null,stores:null},qe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function dp(e,t,r,n){t.value=r,t.getSnapshot=n,xp(t)&&mp(e)}function hp(e,t,r){return r(function(){xp(t)&&mp(e)})}function xp(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Hr(e,r)}catch{return!0}}function mp(e){var t=pn(e,1);t!==null&&Ur(t,e,1,-1)}function Zd(e){var t=Kr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:e},t.queue=e,e=e.dispatch=Aw.bind(null,qe,e),[t.memoizedState,e]}function Vi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=qe.updateQueue,t===null?(t={lastEffect:null,stores:null},qe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function pp(){return Tr().memoizedState}function rl(e,t,r,n){var a=Kr();qe.flags|=e,a.memoizedState=Vi(1|t,r,void 0,n===void 0?null:n)}function rc(e,t,r,n){var a=Tr();n=n===void 0?null:n;var s=void 0;if(ut!==null){var i=ut.memoizedState;if(s=i.destroy,n!==null&&df(n,i.deps)){a.memoizedState=Vi(t,r,s,n);return}}qe.flags|=e,a.memoizedState=Vi(1|t,r,s,n)}function eh(e,t){return rl(8390656,8,e,t)}function mf(e,t){return rc(2048,8,e,t)}function gp(e,t){return rc(4,2,e,t)}function vp(e,t){return rc(4,4,e,t)}function yp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function wp(e,t,r){return r=r!=null?r.concat([e]):null,rc(4,4,yp.bind(null,t,e),r)}function pf(){}function _p(e,t){var r=Tr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&df(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function kp(e,t){var r=Tr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&df(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ep(e,t,r){return Ea&21?(Hr(r,t)||(r=Cm(),qe.lanes|=r,Sa|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qt=!0),e.memoizedState=r)}function Nw(e,t){var r=Ie;Ie=r!==0&&4>r?r:4,e(!0);var n=Hc.transition;Hc.transition={};try{e(!1),t()}finally{Ie=r,Hc.transition=n}}function Sp(){return Tr().memoizedState}function Cw(e,t,r){var n=Vn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Tp(e))bp(t,r);else if(r=ip(e,t,r,n),r!==null){var a=zt();Ur(r,e,n,a),Np(r,t,n)}}function Aw(e,t,r){var n=Vn(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Tp(e))bp(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Hr(o,i)){var l=t.interleaved;l===null?(a.next=a,of(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=ip(e,t,a,n),r!==null&&(a=zt(),Ur(r,e,n,a),Np(r,t,n))}}function Tp(e){var t=e.alternate;return e===qe||t!==null&&t===qe}function bp(e,t){di=bl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Np(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Gu(e,r)}}var Nl={readContext:Sr,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},Fw={readContext:Sr,useCallback:function(e,t){return Kr().memoizedState=[e,t===void 0?null:t],e},useContext:Sr,useEffect:eh,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,rl(4194308,4,yp.bind(null,t,e),r)},useLayoutEffect:function(e,t){return rl(4194308,4,e,t)},useInsertionEffect:function(e,t){return rl(4,2,e,t)},useMemo:function(e,t){var r=Kr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Kr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Cw.bind(null,qe,e),[n.memoizedState,e]},useRef:function(e){var t=Kr();return e={current:e},t.memoizedState=e},useState:Zd,useDebugValue:pf,useDeferredValue:function(e){return Kr().memoizedState=e},useTransition:function(){var e=Zd(!1),t=e[0];return e=Nw.bind(null,e[1]),Kr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=qe,a=Kr();if(He){if(r===void 0)throw Error(ae(407));r=r()}else{if(r=t(),pt===null)throw Error(ae(349));Ea&30||fp(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,eh(hp.bind(null,n,s,e),[e]),n.flags|=2048,Vi(9,dp.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Kr(),t=pt.identifierPrefix;if(He){var r=cn,n=ln;r=(n&~(1<<32-Br(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Hi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=bw++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},jw={readContext:Sr,useCallback:_p,useContext:Sr,useEffect:mf,useImperativeHandle:wp,useInsertionEffect:gp,useLayoutEffect:vp,useMemo:kp,useReducer:zc,useRef:pp,useState:function(){return zc(zi)},useDebugValue:pf,useDeferredValue:function(e){var t=Tr();return Ep(t,ut.memoizedState,e)},useTransition:function(){var e=zc(zi)[0],t=Tr().memoizedState;return[e,t]},useMutableSource:cp,useSyncExternalStore:up,useId:Sp,unstable_isNewReconciler:!1},Ow={readContext:Sr,useCallback:_p,useContext:Sr,useEffect:mf,useImperativeHandle:wp,useInsertionEffect:gp,useLayoutEffect:vp,useMemo:kp,useReducer:Vc,useRef:pp,useState:function(){return Vc(zi)},useDebugValue:pf,useDeferredValue:function(e){var t=Tr();return ut===null?t.memoizedState=e:Ep(t,ut.memoizedState,e)},useTransition:function(){var e=Vc(zi)[0],t=Tr().memoizedState;return[e,t]},useMutableSource:cp,useSyncExternalStore:up,useId:Sp,unstable_isNewReconciler:!1};function Or(e,t){if(e&&e.defaultProps){t=Xe({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function V0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Xe({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var nc={isMounted:function(e){return(e=e._reactInternals)?Fa(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=zt(),a=Vn(e),s=fn(n,a);s.payload=t,r!=null&&(s.callback=r),t=Hn(e,s,a),t!==null&&(Ur(t,e,a,n),el(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=zt(),a=Vn(e),s=fn(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Hn(e,s,a),t!==null&&(Ur(t,e,a,n),el(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=zt(),n=Vn(e),a=fn(r,n);a.tag=2,t!=null&&(a.callback=t),t=Hn(e,a,n),t!==null&&(Ur(t,e,n,r),el(t,e,n))}};function th(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Ri(r,n)||!Ri(a,s):!0}function Cp(e,t,r){var n=!1,a=Xn,s=t.contextType;return typeof s=="object"&&s!==null?s=Sr(s):(a=er(t)?_a:Dt.current,n=t.contextTypes,s=(n=n!=null)?ys(e,a):Xn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=nc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function rh(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&nc.enqueueReplaceState(t,t.state,null)}function W0(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},lf(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Sr(s):(s=er(t)?_a:Dt.current,a.context=ys(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(V0(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&nc.enqueueReplaceState(a,a.state,null),Sl(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Es(e,t){try{var r="",n=t;do r+=iy(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Wc(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function G0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Dw=typeof WeakMap=="function"?WeakMap:Map;function Ap(e,t,r){r=fn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Al||(Al=!0,ru=n),G0(e,t)},r}function Fp(e,t,r){r=fn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){G0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){G0(e,t),typeof n!="function"&&(zn===null?zn=new Set([this]):zn.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function nh(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Dw;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Kw.bind(null,e,t,r),t.then(e,e))}function ah(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function sh(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fn(-1,1),t.tag=2,Hn(r,t,1))),r.lanes|=1),e)}var Pw=yn.ReactCurrentOwner,Qt=!1;function Bt(e,t,r,n){t.child=e===null?sp(t,null,r,n):_s(t,e.child,r,n)}function ih(e,t,r,n,a){r=r.render;var s=t.ref;return ds(t,a),n=hf(e,t,r,n,s,a),r=xf(),e!==null&&!Qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,gn(e,t,a)):(He&&r&&ef(t),t.flags|=1,Bt(e,t,n,a),t.child)}function oh(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!Sf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,jp(e,t,s,n,a)):(e=il(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ri,r(i,n)&&e.ref===t.ref)return gn(e,t,a)}return t.flags|=1,e=Wn(s,n),e.ref=t.ref,e.return=t,t.child=e}function jp(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Ri(s,n)&&e.ref===t.ref)if(Qt=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Qt=!0);else return t.lanes=e.lanes,gn(e,t,a)}return K0(e,t,r,n,a)}function Op(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(is,ar),ar|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Le(is,ar),ar|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Le(is,ar),ar|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Le(is,ar),ar|=n;return Bt(e,t,a,r),t.child}function Dp(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function K0(e,t,r,n,a){var s=er(r)?_a:Dt.current;return s=ys(t,s),ds(t,a),r=hf(e,t,r,n,s,a),n=xf(),e!==null&&!Qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,gn(e,t,a)):(He&&n&&ef(t),t.flags|=1,Bt(e,t,r,a),t.child)}function lh(e,t,r,n,a){if(er(r)){var s=!0;yl(t)}else s=!1;if(ds(t,a),t.stateNode===null)nl(e,t),Cp(t,r,n),W0(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Sr(c):(c=er(r)?_a:Dt.current,c=ys(t,c));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&rh(t,i,n,c),Cn=!1;var h=t.memoizedState;i.state=h,Sl(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Zt.current||Cn?(typeof f=="function"&&(V0(t,r,f,n),l=t.memoizedState),(o=Cn||th(t,r,o,n,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,op(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Or(t.type,o),i.props=c,d=t.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Sr(l):(l=er(r)?_a:Dt.current,l=ys(t,l));var x=r.getDerivedStateFromProps;(f=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==l)&&rh(t,i,n,l),Cn=!1,h=t.memoizedState,i.state=h,Sl(t,n,i,a);var p=t.memoizedState;o!==d||h!==p||Zt.current||Cn?(typeof x=="function"&&(V0(t,r,x,n),p=t.memoizedState),(c=Cn||th(t,r,c,n,h,p,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,p,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),i.props=n,i.state=p,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return q0(e,t,r,n,s,a)}function q0(e,t,r,n,a,s){Dp(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Kd(t,r,!1),gn(e,t,s);n=t.stateNode,Pw.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=_s(t,e.child,null,s),t.child=_s(t,null,o,s)):Bt(e,t,o,s),t.memoizedState=n.state,a&&Kd(t,r,!0),t.child}function Pp(e){var t=e.stateNode;t.pendingContext?Gd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Gd(e,t.context,!1),cf(e,t.containerInfo)}function ch(e,t,r,n,a){return ws(),rf(a),t.flags|=256,Bt(e,t,r,n),t.child}var X0={dehydrated:null,treeContext:null,retryLane:0};function Y0(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ip(e,t,r){var n=t.pendingProps,a=Ke.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Le(Ke,a&1),e===null)return H0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=ic(i,n,0,null),e=ga(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Y0(r),t.memoizedState=X0,e):gf(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return Iw(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Wn(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Wn(o,s):(s=ga(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?Y0(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=X0,n}return s=e.child,e=s.sibling,n=Wn(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function gf(e,t){return t=ic({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function jo(e,t,r,n){return n!==null&&rf(n),_s(t,e.child,null,r),e=gf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Iw(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Wc(Error(ae(422))),jo(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=ic({mode:"visible",children:n.children},a,0,null),s=ga(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&_s(t,e.child,null,i),t.child.memoizedState=Y0(i),t.memoizedState=X0,s);if(!(t.mode&1))return jo(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ae(419)),n=Wc(s,n,void 0),jo(e,t,i,n)}if(o=(i&e.childLanes)!==0,Qt||o){if(n=pt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,pn(e,a),Ur(n,e,a,-1))}return Ef(),n=Wc(Error(ae(421))),jo(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=qw.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,or=$n(a.nextSibling),lr=t,He=!0,Ir=null,e!==null&&(yr[wr++]=ln,yr[wr++]=cn,yr[wr++]=ka,ln=e.id,cn=e.overflow,ka=t),t=gf(t,n.children),t.flags|=4096,t)}function uh(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),z0(e.return,t,r)}function Gc(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Rp(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Bt(e,t,n.children,r),n=Ke.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&uh(e,r,t);else if(e.tag===19)uh(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Le(Ke,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Tl(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Gc(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Tl(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Gc(t,!0,r,null,s);break;case"together":Gc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function nl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function gn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Sa|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ae(153));if(t.child!==null){for(e=t.child,r=Wn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Wn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Rw(e,t,r){switch(t.tag){case 3:Pp(t),ws();break;case 5:lp(t);break;case 1:er(t.type)&&yl(t);break;case 4:cf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Le(kl,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Le(Ke,Ke.current&1),t.flags|=128,null):r&t.child.childLanes?Ip(e,t,r):(Le(Ke,Ke.current&1),e=gn(e,t,r),e!==null?e.sibling:null);Le(Ke,Ke.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Rp(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Le(Ke,Ke.current),n)break;return null;case 22:case 23:return t.lanes=0,Op(e,t,r)}return gn(e,t,r)}var Lp,J0,Mp,Bp;Lp=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};J0=function(){};Mp=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,xa(Jr.current);var s=null;switch(r){case"input":a=y0(e,a),n=y0(e,n),s=[];break;case"select":a=Xe({},a,{value:void 0}),n=Xe({},n,{value:void 0}),s=[];break;case"textarea":a=k0(e,a),n=k0(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=gl)}S0(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ai.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ai.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Be("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Bp=function(e,t,r,n){r!==n&&(t.flags|=4)};function Xs(e,t){if(!He)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function bt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Lw(e,t,r){var n=t.pendingProps;switch(tf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(t),null;case 1:return er(t.type)&&vl(),bt(t),null;case 3:return n=t.stateNode,ks(),Ue(Zt),Ue(Dt),ff(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ao(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ir!==null&&(su(Ir),Ir=null))),J0(e,t),bt(t),null;case 5:uf(t);var a=xa($i.current);if(r=t.type,e!==null&&t.stateNode!=null)Mp(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ae(166));return bt(t),null}if(e=xa(Jr.current),Ao(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Xr]=t,n[Bi]=s,e=(t.mode&1)!==0,r){case"dialog":Be("cancel",n),Be("close",n);break;case"iframe":case"object":case"embed":Be("load",n);break;case"video":case"audio":for(a=0;a<ti.length;a++)Be(ti[a],n);break;case"source":Be("error",n);break;case"img":case"image":case"link":Be("error",n),Be("load",n);break;case"details":Be("toggle",n);break;case"input":yd(n,s),Be("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Be("invalid",n);break;case"textarea":_d(n,s),Be("invalid",n)}S0(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Co(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Co(n.textContent,o,e),a=["children",""+o]):Ai.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Be("scroll",n)}switch(r){case"input":wo(n),wd(n,s,!0);break;case"textarea":wo(n),kd(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=gl)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=hm(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Xr]=t,e[Bi]=n,Lp(e,t,!1,!1),t.stateNode=e;e:{switch(i=T0(r,n),r){case"dialog":Be("cancel",e),Be("close",e),a=n;break;case"iframe":case"object":case"embed":Be("load",e),a=n;break;case"video":case"audio":for(a=0;a<ti.length;a++)Be(ti[a],e);a=n;break;case"source":Be("error",e),a=n;break;case"img":case"image":case"link":Be("error",e),Be("load",e),a=n;break;case"details":Be("toggle",e),a=n;break;case"input":yd(e,n),a=y0(e,n),Be("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Xe({},n,{value:void 0}),Be("invalid",e);break;case"textarea":_d(e,n),a=k0(e,n),Be("invalid",e);break;default:a=n}S0(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?pm(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&xm(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Fi(e,l):typeof l=="number"&&Fi(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ai.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Be("scroll",e):l!=null&&Uu(e,s,l,i))}switch(r){case"input":wo(e),wd(e,n,!1);break;case"textarea":wo(e),kd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+qn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?ls(e,!!n.multiple,s,!1):n.defaultValue!=null&&ls(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=gl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return bt(t),null;case 6:if(e&&t.stateNode!=null)Bp(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ae(166));if(r=xa($i.current),xa(Jr.current),Ao(t)){if(n=t.stateNode,r=t.memoizedProps,n[Xr]=t,(s=n.nodeValue!==r)&&(e=lr,e!==null))switch(e.tag){case 3:Co(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Co(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Xr]=t,t.stateNode=n}return bt(t),null;case 13:if(Ue(Ke),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(He&&or!==null&&t.mode&1&&!(t.flags&128))np(),ws(),t.flags|=98560,s=!1;else if(s=Ao(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ae(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ae(317));s[Xr]=t}else ws(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;bt(t),s=!1}else Ir!==null&&(su(Ir),Ir=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ke.current&1?ft===0&&(ft=3):Ef())),t.updateQueue!==null&&(t.flags|=4),bt(t),null);case 4:return ks(),J0(e,t),e===null&&Li(t.stateNode.containerInfo),bt(t),null;case 10:return sf(t.type._context),bt(t),null;case 17:return er(t.type)&&vl(),bt(t),null;case 19:if(Ue(Ke),s=t.memoizedState,s===null)return bt(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)Xs(s,!1);else{if(ft!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Tl(e),i!==null){for(t.flags|=128,Xs(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Le(Ke,Ke.current&1|2),t.child}e=e.sibling}s.tail!==null&&tt()>Ss&&(t.flags|=128,n=!0,Xs(s,!1),t.lanes=4194304)}else{if(!n)if(e=Tl(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Xs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!He)return bt(t),null}else 2*tt()-s.renderingStartTime>Ss&&r!==1073741824&&(t.flags|=128,n=!0,Xs(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=tt(),t.sibling=null,r=Ke.current,Le(Ke,n?r&1|2:r&1),t):(bt(t),null);case 22:case 23:return kf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ar&1073741824&&(bt(t),t.subtreeFlags&6&&(t.flags|=8192)):bt(t),null;case 24:return null;case 25:return null}throw Error(ae(156,t.tag))}function Mw(e,t){switch(tf(t),t.tag){case 1:return er(t.type)&&vl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ks(),Ue(Zt),Ue(Dt),ff(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return uf(t),null;case 13:if(Ue(Ke),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ae(340));ws()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ue(Ke),null;case 4:return ks(),null;case 10:return sf(t.type._context),null;case 22:case 23:return kf(),null;case 24:return null;default:return null}}var Oo=!1,At=!1,Bw=typeof WeakSet=="function"?WeakSet:Set,me=null;function ss(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ye(e,t,n)}else r.current=null}function Q0(e,t,r){try{r()}catch(n){Ye(e,t,n)}}var fh=!1;function Uw(e,t){if(I0=xl,e=Vm(),Zu(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,d=e,h=null;t:for(;;){for(var x;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(x=d.firstChild)!==null;)h=d,d=x;for(;;){if(d===e)break t;if(h===r&&++c===a&&(o=i),h===s&&++f===n&&(l=i),(x=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=x}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(R0={focusedElem:e,selectionRange:r},xl=!1,me=t;me!==null;)if(t=me,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,me=e;else for(;me!==null;){t=me;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:Or(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(S){Ye(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,me=e;break}me=t.return}return p=fh,fh=!1,p}function hi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Q0(t,r,s)}a=a.next}while(a!==n)}}function ac(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Z0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Up(e){var t=e.alternate;t!==null&&(e.alternate=null,Up(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Xr],delete t[Bi],delete t[B0],delete t[kw],delete t[Ew])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $p(e){return e.tag===5||e.tag===3||e.tag===4}function dh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$p(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function eu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=gl));else if(n!==4&&(e=e.child,e!==null))for(eu(e,t,r),e=e.sibling;e!==null;)eu(e,t,r),e=e.sibling}function tu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(tu(e,t,r),e=e.sibling;e!==null;)tu(e,t,r),e=e.sibling}var vt=null,Dr=!1;function En(e,t,r){for(r=r.child;r!==null;)Hp(e,t,r),r=r.sibling}function Hp(e,t,r){if(Yr&&typeof Yr.onCommitFiberUnmount=="function")try{Yr.onCommitFiberUnmount(Yl,r)}catch{}switch(r.tag){case 5:At||ss(r,t);case 6:var n=vt,a=Dr;vt=null,En(e,t,r),vt=n,Dr=a,vt!==null&&(Dr?(e=vt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):vt.removeChild(r.stateNode));break;case 18:vt!==null&&(Dr?(e=vt,r=r.stateNode,e.nodeType===8?Bc(e.parentNode,r):e.nodeType===1&&Bc(e,r),Pi(e)):Bc(vt,r.stateNode));break;case 4:n=vt,a=Dr,vt=r.stateNode.containerInfo,Dr=!0,En(e,t,r),vt=n,Dr=a;break;case 0:case 11:case 14:case 15:if(!At&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Q0(r,t,i),a=a.next}while(a!==n)}En(e,t,r);break;case 1:if(!At&&(ss(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ye(r,t,o)}En(e,t,r);break;case 21:En(e,t,r);break;case 22:r.mode&1?(At=(n=At)||r.memoizedState!==null,En(e,t,r),At=n):En(e,t,r);break;default:En(e,t,r)}}function hh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Bw),t.forEach(function(n){var a=Xw.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Cr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:vt=o.stateNode,Dr=!1;break e;case 3:vt=o.stateNode.containerInfo,Dr=!0;break e;case 4:vt=o.stateNode.containerInfo,Dr=!0;break e}o=o.return}if(vt===null)throw Error(ae(160));Hp(s,i,a),vt=null,Dr=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Ye(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)zp(t,e),t=t.sibling}function zp(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Cr(t,e),Vr(e),n&4){try{hi(3,e,e.return),ac(3,e)}catch(m){Ye(e,e.return,m)}try{hi(5,e,e.return)}catch(m){Ye(e,e.return,m)}}break;case 1:Cr(t,e),Vr(e),n&512&&r!==null&&ss(r,r.return);break;case 5:if(Cr(t,e),Vr(e),n&512&&r!==null&&ss(r,r.return),e.flags&32){var a=e.stateNode;try{Fi(a,"")}catch(m){Ye(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&fm(a,s),T0(o,i);var c=T0(o,s);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?pm(a,d):f==="dangerouslySetInnerHTML"?xm(a,d):f==="children"?Fi(a,d):Uu(a,f,d,c)}switch(o){case"input":w0(a,s);break;case"textarea":dm(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?ls(a,!!s.multiple,x,!1):h!==!!s.multiple&&(s.defaultValue!=null?ls(a,!!s.multiple,s.defaultValue,!0):ls(a,!!s.multiple,s.multiple?[]:"",!1))}a[Bi]=s}catch(m){Ye(e,e.return,m)}}break;case 6:if(Cr(t,e),Vr(e),n&4){if(e.stateNode===null)throw Error(ae(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){Ye(e,e.return,m)}}break;case 3:if(Cr(t,e),Vr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Pi(t.containerInfo)}catch(m){Ye(e,e.return,m)}break;case 4:Cr(t,e),Vr(e);break;case 13:Cr(t,e),Vr(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(wf=tt())),n&4&&hh(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(At=(c=At)||f,Cr(t,e),At=c):Cr(t,e),Vr(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(me=e,f=e.child;f!==null;){for(d=me=f;me!==null;){switch(h=me,x=h.child,h.tag){case 0:case 11:case 14:case 15:hi(4,h,h.return);break;case 1:ss(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){Ye(n,r,m)}}break;case 5:ss(h,h.return);break;case 22:if(h.memoizedState!==null){mh(d);continue}}x!==null?(x.return=h,me=x):mh(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=mm("display",i))}catch(m){Ye(e,e.return,m)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Ye(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Cr(t,e),Vr(e),n&4&&hh(e);break;case 21:break;default:Cr(t,e),Vr(e)}}function Vr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if($p(r)){var n=r;break e}r=r.return}throw Error(ae(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Fi(a,""),n.flags&=-33);var s=dh(e);tu(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=dh(e);eu(e,o,i);break;default:throw Error(ae(161))}}catch(l){Ye(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $w(e,t,r){me=e,Vp(e)}function Vp(e,t,r){for(var n=(e.mode&1)!==0;me!==null;){var a=me,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Oo;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||At;o=Oo;var c=At;if(Oo=i,(At=l)&&!c)for(me=a;me!==null;)i=me,l=i.child,i.tag===22&&i.memoizedState!==null?ph(a):l!==null?(l.return=i,me=l):ph(a);for(;s!==null;)me=s,Vp(s),s=s.sibling;me=a,Oo=o,At=c}xh(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,me=s):xh(e)}}function xh(e){for(;me!==null;){var t=me;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:At||ac(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!At)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Or(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Qd(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Qd(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Pi(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}At||t.flags&512&&Z0(t)}catch(h){Ye(t,t.return,h)}}if(t===e){me=null;break}if(r=t.sibling,r!==null){r.return=t.return,me=r;break}me=t.return}}function mh(e){for(;me!==null;){var t=me;if(t===e){me=null;break}var r=t.sibling;if(r!==null){r.return=t.return,me=r;break}me=t.return}}function ph(e){for(;me!==null;){var t=me;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ac(4,t)}catch(l){Ye(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Ye(t,a,l)}}var s=t.return;try{Z0(t)}catch(l){Ye(t,s,l)}break;case 5:var i=t.return;try{Z0(t)}catch(l){Ye(t,i,l)}}}catch(l){Ye(t,t.return,l)}if(t===e){me=null;break}var o=t.sibling;if(o!==null){o.return=t.return,me=o;break}me=t.return}}var Hw=Math.ceil,Cl=yn.ReactCurrentDispatcher,vf=yn.ReactCurrentOwner,kr=yn.ReactCurrentBatchConfig,Oe=0,pt=null,st=null,wt=0,ar=0,is=Zn(0),ft=0,Wi=null,Sa=0,sc=0,yf=0,xi=null,Yt=null,wf=0,Ss=1/0,an=null,Al=!1,ru=null,zn=null,Do=!1,In=null,Fl=0,mi=0,nu=null,al=-1,sl=0;function zt(){return Oe&6?tt():al!==-1?al:al=tt()}function Vn(e){return e.mode&1?Oe&2&&wt!==0?wt&-wt:Tw.transition!==null?(sl===0&&(sl=Cm()),sl):(e=Ie,e!==0||(e=window.event,e=e===void 0?16:Im(e.type)),e):1}function Ur(e,t,r,n){if(50<mi)throw mi=0,nu=null,Error(ae(185));no(e,r,n),(!(Oe&2)||e!==pt)&&(e===pt&&(!(Oe&2)&&(sc|=r),ft===4&&Fn(e,wt)),tr(e,n),r===1&&Oe===0&&!(t.mode&1)&&(Ss=tt()+500,tc&&ea()))}function tr(e,t){var r=e.callbackNode;Ty(e,t);var n=hl(e,e===pt?wt:0);if(n===0)r!==null&&Td(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Td(r),t===1)e.tag===0?Sw(gh.bind(null,e)):ep(gh.bind(null,e)),ww(function(){!(Oe&6)&&ea()}),r=null;else{switch(Am(n)){case 1:r=Wu;break;case 4:r=bm;break;case 16:r=dl;break;case 536870912:r=Nm;break;default:r=dl}r=Qp(r,Wp.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Wp(e,t){if(al=-1,sl=0,Oe&6)throw Error(ae(327));var r=e.callbackNode;if(hs()&&e.callbackNode!==r)return null;var n=hl(e,e===pt?wt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=jl(e,n);else{t=n;var a=Oe;Oe|=2;var s=Kp();(pt!==e||wt!==t)&&(an=null,Ss=tt()+500,pa(e,t));do try{Ww();break}catch(o){Gp(e,o)}while(!0);af(),Cl.current=s,Oe=a,st!==null?t=0:(pt=null,wt=0,t=ft)}if(t!==0){if(t===2&&(a=F0(e),a!==0&&(n=a,t=au(e,a))),t===1)throw r=Wi,pa(e,0),Fn(e,n),tr(e,tt()),r;if(t===6)Fn(e,n);else{if(a=e.current.alternate,!(n&30)&&!zw(a)&&(t=jl(e,n),t===2&&(s=F0(e),s!==0&&(n=s,t=au(e,s))),t===1))throw r=Wi,pa(e,0),Fn(e,n),tr(e,tt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ae(345));case 2:la(e,Yt,an);break;case 3:if(Fn(e,n),(n&130023424)===n&&(t=wf+500-tt(),10<t)){if(hl(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){zt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=M0(la.bind(null,e,Yt,an),t);break}la(e,Yt,an);break;case 4:if(Fn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Br(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=tt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Hw(n/1960))-n,10<n){e.timeoutHandle=M0(la.bind(null,e,Yt,an),n);break}la(e,Yt,an);break;case 5:la(e,Yt,an);break;default:throw Error(ae(329))}}}return tr(e,tt()),e.callbackNode===r?Wp.bind(null,e):null}function au(e,t){var r=xi;return e.current.memoizedState.isDehydrated&&(pa(e,t).flags|=256),e=jl(e,t),e!==2&&(t=Yt,Yt=r,t!==null&&su(t)),e}function su(e){Yt===null?Yt=e:Yt.push.apply(Yt,e)}function zw(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Hr(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fn(e,t){for(t&=~yf,t&=~sc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Br(t),n=1<<r;e[r]=-1,t&=~n}}function gh(e){if(Oe&6)throw Error(ae(327));hs();var t=hl(e,0);if(!(t&1))return tr(e,tt()),null;var r=jl(e,t);if(e.tag!==0&&r===2){var n=F0(e);n!==0&&(t=n,r=au(e,n))}if(r===1)throw r=Wi,pa(e,0),Fn(e,t),tr(e,tt()),r;if(r===6)throw Error(ae(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,la(e,Yt,an),tr(e,tt()),null}function _f(e,t){var r=Oe;Oe|=1;try{return e(t)}finally{Oe=r,Oe===0&&(Ss=tt()+500,tc&&ea())}}function Ta(e){In!==null&&In.tag===0&&!(Oe&6)&&hs();var t=Oe;Oe|=1;var r=kr.transition,n=Ie;try{if(kr.transition=null,Ie=1,e)return e()}finally{Ie=n,kr.transition=r,Oe=t,!(Oe&6)&&ea()}}function kf(){ar=is.current,Ue(is)}function pa(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,yw(r)),st!==null)for(r=st.return;r!==null;){var n=r;switch(tf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&vl();break;case 3:ks(),Ue(Zt),Ue(Dt),ff();break;case 5:uf(n);break;case 4:ks();break;case 13:Ue(Ke);break;case 19:Ue(Ke);break;case 10:sf(n.type._context);break;case 22:case 23:kf()}r=r.return}if(pt=e,st=e=Wn(e.current,null),wt=ar=t,ft=0,Wi=null,yf=sc=Sa=0,Yt=xi=null,ha!==null){for(t=0;t<ha.length;t++)if(r=ha[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}ha=null}return e}function Gp(e,t){do{var r=st;try{if(af(),tl.current=Nl,bl){for(var n=qe.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}bl=!1}if(Ea=0,mt=ut=qe=null,di=!1,Hi=0,vf.current=null,r===null||r.return===null){ft=1,Wi=t,st=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=wt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var x=ah(i);if(x!==null){x.flags&=-257,sh(x,i,o,s,t),x.mode&1&&nh(s,c,t),t=x,l=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(l),t.updateQueue=m}else p.add(l);break e}else{if(!(t&1)){nh(s,c,t),Ef();break e}l=Error(ae(426))}}else if(He&&o.mode&1){var v=ah(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),sh(v,i,o,s,t),rf(Es(l,o));break e}}s=l=Es(l,o),ft!==4&&(ft=2),xi===null?xi=[s]:xi.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=Ap(s,l,t);Jd(s,y);break e;case 1:o=l;var w=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(zn===null||!zn.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=Fp(s,o,t);Jd(s,S);break e}}s=s.return}while(s!==null)}Xp(r)}catch(k){t=k,st===r&&r!==null&&(st=r=r.return);continue}break}while(!0)}function Kp(){var e=Cl.current;return Cl.current=Nl,e===null?Nl:e}function Ef(){(ft===0||ft===3||ft===2)&&(ft=4),pt===null||!(Sa&268435455)&&!(sc&268435455)||Fn(pt,wt)}function jl(e,t){var r=Oe;Oe|=2;var n=Kp();(pt!==e||wt!==t)&&(an=null,pa(e,t));do try{Vw();break}catch(a){Gp(e,a)}while(!0);if(af(),Oe=r,Cl.current=n,st!==null)throw Error(ae(261));return pt=null,wt=0,ft}function Vw(){for(;st!==null;)qp(st)}function Ww(){for(;st!==null&&!py();)qp(st)}function qp(e){var t=Jp(e.alternate,e,ar);e.memoizedProps=e.pendingProps,t===null?Xp(e):st=t,vf.current=null}function Xp(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Mw(r,t),r!==null){r.flags&=32767,st=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ft=6,st=null;return}}else if(r=Lw(r,t,ar),r!==null){st=r;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);ft===0&&(ft=5)}function la(e,t,r){var n=Ie,a=kr.transition;try{kr.transition=null,Ie=1,Gw(e,t,r,n)}finally{kr.transition=a,Ie=n}return null}function Gw(e,t,r,n){do hs();while(In!==null);if(Oe&6)throw Error(ae(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ae(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(by(e,s),e===pt&&(st=pt=null,wt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Do||(Do=!0,Qp(dl,function(){return hs(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=kr.transition,kr.transition=null;var i=Ie;Ie=1;var o=Oe;Oe|=4,vf.current=null,Uw(e,r),zp(r,e),dw(R0),xl=!!I0,R0=I0=null,e.current=r,$w(r),gy(),Oe=o,Ie=i,kr.transition=s}else e.current=r;if(Do&&(Do=!1,In=e,Fl=a),s=e.pendingLanes,s===0&&(zn=null),wy(r.stateNode),tr(e,tt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Al)throw Al=!1,e=ru,ru=null,e;return Fl&1&&e.tag!==0&&hs(),s=e.pendingLanes,s&1?e===nu?mi++:(mi=0,nu=e):mi=0,ea(),null}function hs(){if(In!==null){var e=Am(Fl),t=kr.transition,r=Ie;try{if(kr.transition=null,Ie=16>e?16:e,In===null)var n=!1;else{if(e=In,In=null,Fl=0,Oe&6)throw Error(ae(331));var a=Oe;for(Oe|=4,me=e.current;me!==null;){var s=me,i=s.child;if(me.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(me=c;me!==null;){var f=me;switch(f.tag){case 0:case 11:case 15:hi(8,f,s)}var d=f.child;if(d!==null)d.return=f,me=d;else for(;me!==null;){f=me;var h=f.sibling,x=f.return;if(Up(f),f===c){me=null;break}if(h!==null){h.return=x,me=h;break}me=x}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}me=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,me=i;else e:for(;me!==null;){if(s=me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:hi(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,me=y;break e}me=s.return}}var w=e.current;for(me=w;me!==null;){i=me;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,me=g;else e:for(i=w;me!==null;){if(o=me,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ac(9,o)}}catch(k){Ye(o,o.return,k)}if(o===i){me=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,me=S;break e}me=o.return}}if(Oe=a,ea(),Yr&&typeof Yr.onPostCommitFiberRoot=="function")try{Yr.onPostCommitFiberRoot(Yl,e)}catch{}n=!0}return n}finally{Ie=r,kr.transition=t}}return!1}function vh(e,t,r){t=Es(r,t),t=Ap(e,t,1),e=Hn(e,t,1),t=zt(),e!==null&&(no(e,1,t),tr(e,t))}function Ye(e,t,r){if(e.tag===3)vh(e,e,r);else for(;t!==null;){if(t.tag===3){vh(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(zn===null||!zn.has(n))){e=Es(r,e),e=Fp(t,e,1),t=Hn(t,e,1),e=zt(),t!==null&&(no(t,1,e),tr(t,e));break}}t=t.return}}function Kw(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=zt(),e.pingedLanes|=e.suspendedLanes&r,pt===e&&(wt&r)===r&&(ft===4||ft===3&&(wt&130023424)===wt&&500>tt()-wf?pa(e,0):yf|=r),tr(e,t)}function Yp(e,t){t===0&&(e.mode&1?(t=Eo,Eo<<=1,!(Eo&130023424)&&(Eo=4194304)):t=1);var r=zt();e=pn(e,t),e!==null&&(no(e,t,r),tr(e,r))}function qw(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Yp(e,r)}function Xw(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ae(314))}n!==null&&n.delete(t),Yp(e,r)}var Jp;Jp=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Zt.current)Qt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Qt=!1,Rw(e,t,r);Qt=!!(e.flags&131072)}else Qt=!1,He&&t.flags&1048576&&tp(t,_l,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;nl(e,t),e=t.pendingProps;var a=ys(t,Dt.current);ds(t,r),a=hf(null,t,n,e,a,r);var s=xf();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,er(n)?(s=!0,yl(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,lf(t),a.updater=nc,t.stateNode=a,a._reactInternals=t,W0(t,n,e,r),t=q0(null,t,n,!0,s,r)):(t.tag=0,He&&s&&ef(t),Bt(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(nl(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Jw(n),e=Or(n,e),a){case 0:t=K0(null,t,n,e,r);break e;case 1:t=lh(null,t,n,e,r);break e;case 11:t=ih(null,t,n,e,r);break e;case 14:t=oh(null,t,n,Or(n.type,e),r);break e}throw Error(ae(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Or(n,a),K0(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Or(n,a),lh(e,t,n,a,r);case 3:e:{if(Pp(t),e===null)throw Error(ae(387));n=t.pendingProps,s=t.memoizedState,a=s.element,op(e,t),Sl(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Es(Error(ae(423)),t),t=ch(e,t,n,r,a);break e}else if(n!==a){a=Es(Error(ae(424)),t),t=ch(e,t,n,r,a);break e}else for(or=$n(t.stateNode.containerInfo.firstChild),lr=t,He=!0,Ir=null,r=sp(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ws(),n===a){t=gn(e,t,r);break e}Bt(e,t,n,r)}t=t.child}return t;case 5:return lp(t),e===null&&H0(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,L0(n,a)?i=null:s!==null&&L0(n,s)&&(t.flags|=32),Dp(e,t),Bt(e,t,i,r),t.child;case 6:return e===null&&H0(t),null;case 13:return Ip(e,t,r);case 4:return cf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=_s(t,null,n,r):Bt(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Or(n,a),ih(e,t,n,a,r);case 7:return Bt(e,t,t.pendingProps,r),t.child;case 8:return Bt(e,t,t.pendingProps.children,r),t.child;case 12:return Bt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Le(kl,n._currentValue),n._currentValue=i,s!==null)if(Hr(s.value,i)){if(s.children===a.children&&!Zt.current){t=gn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=fn(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),z0(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(ae(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),z0(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Bt(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ds(t,r),a=Sr(a),n=n(a),t.flags|=1,Bt(e,t,n,r),t.child;case 14:return n=t.type,a=Or(n,t.pendingProps),a=Or(n.type,a),oh(e,t,n,a,r);case 15:return jp(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Or(n,a),nl(e,t),t.tag=1,er(n)?(e=!0,yl(t)):e=!1,ds(t,r),Cp(t,n,a),W0(t,n,a,r),q0(null,t,n,!0,e,r);case 19:return Rp(e,t,r);case 22:return Op(e,t,r)}throw Error(ae(156,t.tag))};function Qp(e,t){return Tm(e,t)}function Yw(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _r(e,t,r,n){return new Yw(e,t,r,n)}function Sf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Jw(e){if(typeof e=="function")return Sf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Hu)return 11;if(e===zu)return 14}return 2}function Wn(e,t){var r=e.alternate;return r===null?(r=_r(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function il(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")Sf(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ya:return ga(r.children,a,s,t);case $u:i=8,a|=8;break;case m0:return e=_r(12,r,t,a|2),e.elementType=m0,e.lanes=s,e;case p0:return e=_r(13,r,t,a),e.elementType=p0,e.lanes=s,e;case g0:return e=_r(19,r,t,a),e.elementType=g0,e.lanes=s,e;case lm:return ic(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case im:i=10;break e;case om:i=9;break e;case Hu:i=11;break e;case zu:i=14;break e;case Nn:i=16,n=null;break e}throw Error(ae(130,e==null?e:typeof e,""))}return t=_r(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function ga(e,t,r,n){return e=_r(7,e,n,t),e.lanes=r,e}function ic(e,t,r,n){return e=_r(22,e,n,t),e.elementType=lm,e.lanes=r,e.stateNode={isHidden:!1},e}function Kc(e,t,r){return e=_r(6,e,null,t),e.lanes=r,e}function qc(e,t,r){return t=_r(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qw(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cc(0),this.expirationTimes=Cc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cc(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Tf(e,t,r,n,a,s,i,o,l){return e=new Qw(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=_r(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},lf(s),e}function Zw(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xa,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Zp(e){if(!e)return Xn;e=e._reactInternals;e:{if(Fa(e)!==e||e.tag!==1)throw Error(ae(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(er(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ae(171))}if(e.tag===1){var r=e.type;if(er(r))return Zm(e,r,t)}return t}function e1(e,t,r,n,a,s,i,o,l){return e=Tf(r,n,!0,e,a,s,i,o,l),e.context=Zp(null),r=e.current,n=zt(),a=Vn(r),s=fn(n,a),s.callback=t??null,Hn(r,s,a),e.current.lanes=a,no(e,a,n),tr(e,n),e}function oc(e,t,r,n){var a=t.current,s=zt(),i=Vn(a);return r=Zp(r),t.context===null?t.context=r:t.pendingContext=r,t=fn(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Hn(a,t,i),e!==null&&(Ur(e,a,i,s),el(e,a,i)),i}function Ol(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function bf(e,t){yh(e,t),(e=e.alternate)&&yh(e,t)}function e2(){return null}var t1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Nf(e){this._internalRoot=e}lc.prototype.render=Nf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ae(409));oc(e,t,null,null)};lc.prototype.unmount=Nf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ta(function(){oc(null,e,null,null)}),t[mn]=null}};function lc(e){this._internalRoot=e}lc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Om();e={blockedOn:null,target:e,priority:t};for(var r=0;r<An.length&&t!==0&&t<An[r].priority;r++);An.splice(r,0,e),r===0&&Pm(e)}};function Cf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function wh(){}function t2(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=Ol(i);s.call(c)}}var i=e1(t,n,e,0,null,!1,!1,"",wh);return e._reactRootContainer=i,e[mn]=i.current,Li(e.nodeType===8?e.parentNode:e),Ta(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Ol(l);o.call(c)}}var l=Tf(e,0,!1,null,null,!1,!1,"",wh);return e._reactRootContainer=l,e[mn]=l.current,Li(e.nodeType===8?e.parentNode:e),Ta(function(){oc(t,l,r,n)}),l}function uc(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Ol(i);o.call(l)}}oc(t,i,e,a)}else i=t2(r,t,e,a,n);return Ol(i)}Fm=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ei(t.pendingLanes);r!==0&&(Gu(t,r|1),tr(t,tt()),!(Oe&6)&&(Ss=tt()+500,ea()))}break;case 13:Ta(function(){var n=pn(e,1);if(n!==null){var a=zt();Ur(n,e,1,a)}}),bf(e,1)}};Ku=function(e){if(e.tag===13){var t=pn(e,134217728);if(t!==null){var r=zt();Ur(t,e,134217728,r)}bf(e,134217728)}};jm=function(e){if(e.tag===13){var t=Vn(e),r=pn(e,t);if(r!==null){var n=zt();Ur(r,e,t,n)}bf(e,t)}};Om=function(){return Ie};Dm=function(e,t){var r=Ie;try{return Ie=e,t()}finally{Ie=r}};N0=function(e,t,r){switch(t){case"input":if(w0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=ec(n);if(!a)throw Error(ae(90));um(n),w0(n,a)}}}break;case"textarea":dm(e,r);break;case"select":t=r.value,t!=null&&ls(e,!!r.multiple,t,!1)}};ym=_f;wm=Ta;var r2={usingClientEntryPoint:!1,Events:[so,es,ec,gm,vm,_f]},Ys={findFiberByHostInstance:da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},n2={bundleType:Ys.bundleType,version:Ys.version,rendererPackageName:Ys.rendererPackageName,rendererConfig:Ys.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Em(e),e===null?null:e.stateNode},findFiberByHostInstance:Ys.findFiberByHostInstance||e2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Po=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Po.isDisabled&&Po.supportsFiber)try{Yl=Po.inject(n2),Yr=Po}catch{}}fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r2;fr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cf(t))throw Error(ae(200));return Zw(e,t,null,r)};fr.createRoot=function(e,t){if(!Cf(e))throw Error(ae(299));var r=!1,n="",a=t1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Tf(e,1,!1,null,null,r,!1,n,a),e[mn]=t.current,Li(e.nodeType===8?e.parentNode:e),new Nf(t)};fr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ae(188)):(e=Object.keys(e).join(","),Error(ae(268,e)));return e=Em(t),e=e===null?null:e.stateNode,e};fr.flushSync=function(e){return Ta(e)};fr.hydrate=function(e,t,r){if(!cc(t))throw Error(ae(200));return uc(null,e,t,!0,r)};fr.hydrateRoot=function(e,t,r){if(!Cf(e))throw Error(ae(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=t1;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=e1(t,null,e,1,r??null,a,!1,s,i),e[mn]=t.current,Li(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new lc(t)};fr.render=function(e,t,r){if(!cc(t))throw Error(ae(200));return uc(null,e,t,!1,r)};fr.unmountComponentAtNode=function(e){if(!cc(e))throw Error(ae(40));return e._reactRootContainer?(Ta(function(){uc(null,null,e,!1,function(){e._reactRootContainer=null,e[mn]=null})}),!0):!1};fr.unstable_batchedUpdates=_f;fr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!cc(r))throw Error(ae(200));if(e==null||e._reactInternals===void 0)throw Error(ae(38));return uc(e,t,r,!1,n)};fr.version="18.3.1-next-f1338f8080-20240426";function r1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r1)}catch(e){console.error(e)}}r1(),rm.exports=fr;var a2=rm.exports,n1,_h=a2;n1=_h.createRoot,_h.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var s2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),we=(e,t)=>{const r=Y.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},f)=>Y.createElement("svg",{ref:f,...s2,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${i2(e)}`,o].join(" "),...c},[...t.map(([d,h])=>Y.createElement(d,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=we("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=we("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ou=we("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o2=we("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a1=we("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=we("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=we("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=we("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gi=we("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=we("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=we("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=we("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=we("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=we("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=we("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i1=we("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=we("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=we("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=we("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=we("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ff=we("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=we("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o1=we("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=we("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=we("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=we("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=we("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=we("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=we("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=we("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=we("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c1=we("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=we("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=we("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=we("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=we("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=we("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=we("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=we("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u1=we("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=we("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=we("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=we("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),E2="modulepreload",S2=function(e){return"/ValoareDiary/"+e},Eh={},oo=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=S2(l),l in Eh)return;Eh[l]=!0;const c=l.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":E2,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,x)=>{d.addEventListener("load",h),d.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},T2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>oo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ps);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class jf extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class b2 extends jf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Sh extends jf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Th extends jf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var uu;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(uu||(uu={}));var N2=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class C2{constructor(t,{headers:r={},customFetch:n,region:a=uu.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=T2(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return N2(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let f;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",f=i):typeof i=="string"?(o["Content-Type"]="text/plain",f=i):typeof FormData<"u"&&i instanceof FormData?f=i:(o["Content-Type"]="application/json",f=JSON.stringify(i)));const d=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:f}).catch(m=>{throw new b2(m)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new Sh(d);if(!d.ok)throw new Th(d);let x=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return x==="application/json"?p=yield d.json():x==="application/octet-stream"?p=yield d.blob():x==="text/event-stream"?p=d:x==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null,response:d}}catch(a){return{data:null,error:a,response:a instanceof Th||a instanceof Sh?a.context:void 0}}})}}var Jt={},Of={},dc={},lo={},hc={},xc={},A2=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Cs=A2();const F2=Cs.fetch,f1=Cs.fetch.bind(Cs),d1=Cs.Headers,j2=Cs.Request,O2=Cs.Response,Ps=Object.freeze(Object.defineProperty({__proto__:null,Headers:d1,Request:j2,Response:O2,default:f1,fetch:F2},Symbol.toStringTag,{value:"Module"})),D2=Ov(Ps);var mc={};Object.defineProperty(mc,"__esModule",{value:!0});let P2=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};mc.default=P2;var h1=Er&&Er.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xc,"__esModule",{value:!0});const I2=h1(D2),R2=h1(mc);let L2=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=I2.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l,c;let f=null,d=null,h=null,x=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const w=await s.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?d=w:d=JSON.parse(w))}const v=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");v&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(f={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,x=406,p="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const v=await s.text();try{f=JSON.parse(v),Array.isArray(f)&&s.status===404&&(d=[],f=null,x=200,p="OK")}catch{s.status===404&&v===""?(x=204,p="No Content"):f={message:v}}if(f&&this.isMaybeSingle&&(!((c=f==null?void 0:f.details)===null||c===void 0)&&c.includes("0 rows"))&&(f=null,x=200,p="OK"),f&&this.shouldThrowOnError)throw new R2.default(f)}return{error:f,data:d,count:h,status:x,statusText:p}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};xc.default=L2;var M2=Er&&Er.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hc,"__esModule",{value:!0});const B2=M2(xc);let U2=class extends B2.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};hc.default=U2;var $2=Er&&Er.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lo,"__esModule",{value:!0});const H2=$2(hc);let z2=class extends H2.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};lo.default=z2;var V2=Er&&Er.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dc,"__esModule",{value:!0});const Js=V2(lo);let W2=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new Js.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const s="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Js.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,f)=>c.concat(Object.keys(f)),[]);if(l.length>0){const c=[...new Set(l)].map(f=>`"${f}"`);this.url.searchParams.set("columns",c.join(","))}}return new Js.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Js.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Js.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};dc.default=W2;var x1=Er&&Er.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Of,"__esModule",{value:!0});const G2=x1(dc),K2=x1(lo);let q2=class m1{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new G2.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new m1(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",c=r);const f=new Headers(this.headers);return s&&f.set("Prefer",`count=${s}`),new K2.default({method:o,url:l,headers:f,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Of.default=q2;var Is=Er&&Er.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.PostgrestError=Jt.PostgrestBuilder=Jt.PostgrestTransformBuilder=Jt.PostgrestFilterBuilder=Jt.PostgrestQueryBuilder=Jt.PostgrestClient=void 0;const p1=Is(Of);Jt.PostgrestClient=p1.default;const g1=Is(dc);Jt.PostgrestQueryBuilder=g1.default;const v1=Is(lo);Jt.PostgrestFilterBuilder=v1.default;const y1=Is(hc);Jt.PostgrestTransformBuilder=y1.default;const w1=Is(xc);Jt.PostgrestBuilder=w1.default;const _1=Is(mc);Jt.PostgrestError=_1.default;var X2=Jt.default={PostgrestClient:p1.default,PostgrestQueryBuilder:g1.default,PostgrestFilterBuilder:v1.default,PostgrestTransformBuilder:y1.default,PostgrestBuilder:w1.default,PostgrestError:_1.default};const{PostgrestClient:Y2,PostgrestQueryBuilder:yF,PostgrestFilterBuilder:wF,PostgrestTransformBuilder:_F,PostgrestBuilder:kF,PostgrestError:EF}=X2;class J2{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Q2="2.15.5",Z2=`realtime-js/${Q2}`,e_="1.0.0",fu=1e4,t_=1e3,r_=100;var pi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(pi||(pi={}));var ot;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ot||(ot={}));var Pr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Pr||(Pr={}));var du;(function(e){e.websocket="websocket"})(du||(du={}));var ua;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ua||(ua={}));class n_{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const l=n.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class k1{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Re;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Re||(Re={}));const bh=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=a_(i,e,t,a),s),{})},a_=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?E1(s,i):hu(i)},E1=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return l_(t,r)}switch(e){case Re.bool:return s_(t);case Re.float4:case Re.float8:case Re.int2:case Re.int4:case Re.int8:case Re.numeric:case Re.oid:return i_(t);case Re.json:case Re.jsonb:return o_(t);case Re.timestamp:return c_(t);case Re.abstime:case Re.date:case Re.daterange:case Re.int4range:case Re.int8range:case Re.money:case Re.reltime:case Re.text:case Re.time:case Re.timestamptz:case Re.timetz:case Re.tsrange:case Re.tstzrange:return hu(t);default:return hu(t)}},hu=e=>e,s_=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},i_=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},o_=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},l_=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>E1(t,o))}return e},c_=e=>typeof e=="string"?e.replace(" ","T"):e,S1=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Xc{constructor(t,r,n={},a=fu){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Nh;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Nh||(Nh={}));class gi{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gi.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=gi.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=gi.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,f)=>{i[c]||(l[c]=f)}),this.map(i,(c,f)=>{const d=s[c];if(d){const h=f.map(v=>v.presence_ref),x=d.map(v=>v.presence_ref),p=f.filter(v=>x.indexOf(v.presence_ref)<0),m=d.filter(v=>h.indexOf(v.presence_ref)<0);p.length>0&&(o[c]=p),m.length>0&&(l[c]=m)}else o[c]=f}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const f=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),f.length>0){const d=t[o].map(x=>x.presence_ref),h=f.filter(x=>d.indexOf(x.presence_ref)<0);t[o].unshift(...h)}n(o,f,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const f=l.map(d=>d.presence_ref);c=c.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ch;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ch||(Ch={}));var vi;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(vi||(vi={}));var sn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(sn||(sn={}));class Df{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=ot.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Xc(this,Pr.join,this.params,this.timeout),this.rejoinTimer=new k1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ot.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ot.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ot.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Pr.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new gi(this),this.broadcastEndpointURL=S1(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==ot.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(x=>x.filter))!==null&&a!==void 0?a:[],f=!!this.bindings[vi.PRESENCE]&&this.bindings[vi.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,d={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(x=>t==null?void 0:t(sn.CHANNEL_ERROR,x)),this._onClose(()=>t==null?void 0:t(sn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:x})=>{var p;if(this.socket.setAuth(),x===void 0){t==null||t(sn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(p=m==null?void 0:m.length)!==null&&p!==void 0?p:0,y=[];for(let w=0;w<v;w++){const g=m[w],{filter:{event:S,schema:k,table:T,filter:_}}=g,A=x&&x[w];if(A&&A.event===S&&A.schema===k&&A.table===T&&A.filter===_)y.push(Object.assign(Object.assign({},g),{id:A.id}));else{this.unsubscribe(),this.state=ot.errored,t==null||t(sn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(sn.SUBSCRIBED);return}}).receive("error",x=>{this.state=ot.errored,t==null||t(sn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(sn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===ot.joined&&t===vi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ot.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Pr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Xc(this,Pr.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ot.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Xc(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>r_){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:f}=Pr;if(n&&[o,l,c,f].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(x=>{var p,m,v;return((p=x.filter)===null||p===void 0?void 0:p.event)==="*"||((v=(m=x.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(x=>x.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(x=>{var p,m,v,y,w,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in x){const S=x.id,k=(p=x.filter)===null||p===void 0?void 0:p.event;return S&&((m=r.ids)===null||m===void 0?void 0:m.includes(S))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const S=(w=(y=x==null?void 0:x.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return S==="*"||S===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===i}).map(x=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:m,table:v,commit_timestamp:y,type:w,errors:g}=p;h=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:y,eventType:w,new:{},old:{},errors:g}),this._getPayloadRecords(p))}x.callback(h,n)})}_isClosed(){return this.state===ot.closed}_isJoined(){return this.state===ot.joined}_isJoining(){return this.state===ot.joining}_isLeaving(){return this.state===ot.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Df.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Pr.close,{},t)}_onError(t){this._on(Pr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ot.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=bh(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=bh(t.columns,t.old_record)),r}}const Yc=()=>{},Io={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},u_=[1e3,2e3,5e3,1e4],f_=1e4,d_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class h_{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=fu,this.transport=null,this.heartbeatIntervalMs=Io.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Yc,this.ref=0,this.reconnectTimer=null,this.logger=Yc,this.conn=null,this.sendBuffer=[],this.serializer=new n_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...i)=>oo(async()=>{const{default:o}=await Promise.resolve().then(()=>Ps);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${du.websocket}`,this.httpEndpoint=S1(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=J2.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:e_}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case pi.connecting:return ua.Connecting;case pi.open:return ua.Open;case pi.closing:return ua.Closing;default:return ua.Closed}}isConnected(){return this.connectionState()===ua.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new Df(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(t_,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Io.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Pr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([d_],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:Z2};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Pr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new k1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Io.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,l,c,f;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:fu,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Io.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Yc,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:d=>u_[d-1]||f_,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(d,h)=>h(JSON.stringify(d)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Pf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function lt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class x_ extends Pf{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class xu extends Pf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var m_=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const T1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>oo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ps);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},p_=()=>m_(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield oo(()=>Promise.resolve().then(()=>Ps),void 0)).Response:Response}),mu=e=>{if(Array.isArray(e))return e.map(r=>mu(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=mu(n)}),t},g_=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var ja=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Jc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),v_=(e,t,r)=>ja(void 0,void 0,void 0,function*(){const n=yield p_();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,i=(a==null?void 0:a.statusCode)||s+"";t(new x_(Jc(a),s,i))}).catch(a=>{t(new xu(Jc(a),a))}):t(new xu(Jc(e),e))}),y_=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(g_(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function co(e,t,r,n,a,s){return ja(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,y_(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>v_(l,o,n))})})}function Il(e,t,r,n){return ja(this,void 0,void 0,function*(){return co(e,"GET",t,r,n)})}function qr(e,t,r,n,a){return ja(this,void 0,void 0,function*(){return co(e,"POST",t,n,a,r)})}function pu(e,t,r,n,a){return ja(this,void 0,void 0,function*(){return co(e,"PUT",t,n,a,r)})}function w_(e,t,r,n){return ja(this,void 0,void 0,function*(){return co(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function b1(e,t,r,n,a){return ja(this,void 0,void 0,function*(){return co(e,"DELETE",t,n,a,r)})}var Mt=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const __={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ah={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class k_{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=T1(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Mt(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Ah),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),f=this._getFinalPath(c),d=yield(t=="PUT"?pu:qr)(this.fetch,`${this.url}/object/${f}`,s,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(lt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Mt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Mt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Ah.upsert},a),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType);const d=yield pu(this.fetch,o.toString(),l,{headers:f});return{data:{path:s,fullPath:d.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(lt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Mt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield qr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new Pf("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Mt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Mt(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Mt(this,void 0,void 0,function*(){try{return{data:{path:(yield qr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Mt(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield qr(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Mt(this,void 0,void 0,function*(){try{const a=yield qr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}})}download(t,r){return Mt(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Il(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(lt(o))return{data:null,error:o};throw o}})}info(t){return Mt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Il(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:mu(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}})}exists(t){return Mt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield w_(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(lt(n)&&n instanceof xu){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Mt(this,void 0,void 0,function*(){try{return{data:yield b1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Mt(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},__),r),{prefix:t||""});return{data:yield qr(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(lt(a))return{data:null,error:a};throw a}})}listV2(t,r){return Mt(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield qr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const E_="2.12.1",S_={"X-Client-Info":`storage-js/${E_}`};var Ua=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class T_{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},S_),r),this.fetch=T1(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Ua(this,void 0,void 0,function*(){try{return{data:yield Il(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(lt(t))return{data:null,error:t};throw t}})}getBucket(t){return Ua(this,void 0,void 0,function*(){try{return{data:yield Il(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Ua(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ua(this,void 0,void 0,function*(){try{return{data:yield pu(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(lt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ua(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ua(this,void 0,void 0,function*(){try{return{data:yield b1(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lt(r))return{data:null,error:r};throw r}})}}class b_ extends T_{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new k_(this.url,this.headers,t,this.fetch)}}const N_="2.57.4";let ri="";typeof Deno<"u"?ri="deno":typeof document<"u"?ri="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ri="react-native":ri="node";const C_={"X-Client-Info":`supabase-js-${ri}/${N_}`},A_={headers:C_},F_={schema:"public"},j_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},O_={};var D_=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const P_=e=>{let t;return e?t=e:typeof fetch>"u"?t=f1:t=fetch,(...r)=>t(...r)},I_=()=>typeof Headers>"u"?d1:Headers,R_=(e,t,r)=>{const n=P_(r),a=I_();return(s,i)=>D_(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var L_=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function M_(e){return e.endsWith("/")?e:e+"/"}function B_(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:f,global:d}=t,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},f),i),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>L_(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function U_(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(M_(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const N1="2.71.1",Ga=30*1e3,gu=3,Qc=gu*Ga,$_="http://localhost:9999",H_="supabase.auth.token",z_={"X-Client-Info":`gotrue-js/${N1}`},vu="X-Supabase-Api-Version",C1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},V_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,W_=10*60*1e3;class If extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function _e(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class G_ extends If{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function K_(e){return _e(e)&&e.name==="AuthApiError"}class A1 extends If{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ta extends If{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class bn extends ta{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function q_(e){return _e(e)&&e.name==="AuthSessionMissingError"}class Ro extends ta{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Lo extends ta{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Mo extends ta{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function X_(e){return _e(e)&&e.name==="AuthImplicitGrantRedirectError"}class Fh extends ta{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class yu extends ta{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Zc(e){return _e(e)&&e.name==="AuthRetryableFetchError"}class jh extends ta{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class wu extends ta{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Rl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Oh=` 	
\r=`.split(""),Y_=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Oh.length;t+=1)e[Oh[t].charCodeAt(0)]=-2;for(let t=0;t<Rl.length;t+=1)e[Rl[t].charCodeAt(0)]=t;return e})();function Dh(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Rl[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Rl[n]),t.queuedBits-=6}}function F1(e,t,r){const n=Y_[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Ph(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{Z_(i,n,r)};for(let i=0;i<e.length;i+=1)F1(e.charCodeAt(i),a,s);return t.join("")}function J_(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Q_(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}J_(n,t)}}function Z_(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ek(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)F1(e.charCodeAt(a),r,n);return new Uint8Array(t)}function tk(e){const t=[];return Q_(e,r=>t.push(r)),new Uint8Array(t)}function rk(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Dh(a,r,n)),Dh(null,r,n),t.join("")}function nk(e){return Math.round(Date.now()/1e3)+e}function ak(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const jr=()=>typeof window<"u"&&typeof document<"u",sa={tested:!1,writable:!1},j1=()=>{if(!jr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(sa.tested)return sa.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),sa.tested=!0,sa.writable=!0}catch{sa.tested=!0,sa.writable=!1}return sa.writable};function sk(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const O1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>oo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ps);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},ik=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ka=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ia=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Sn=async(e,t)=>{await e.removeItem(t)};class pc{constructor(){this.promise=new pc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}pc.promiseConstructor=Promise;function e0(e){const t=e.split(".");if(t.length!==3)throw new wu("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!V_.test(t[n]))throw new wu("JWT not in base64url format");return{header:JSON.parse(Ph(t[0])),payload:JSON.parse(Ph(t[1])),signature:ek(t[2]),raw:{header:t[0],payload:t[1]}}}async function ok(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function lk(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function ck(e){return("0"+e.toString(16)).substr(-2)}function uk(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,ck).join("")}async function fk(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function dk(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await fk(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $a(e,t,r=!1){const n=uk();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Ka(e,`${t}-code-verifier`,a);const s=await dk(n);return[s,n===s?"plain":"s256"]}const hk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xk(e){const t=e.headers.get(vu);if(!t||!t.match(hk))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function mk(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function pk(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const gk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ha(e){if(!gk.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function t0(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ih(e){return JSON.parse(JSON.stringify(e))}var vk=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const ca=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),yk=[502,503,504];async function Rh(e){var t;if(!ik(e))throw new yu(ca(e),0);if(yk.includes(e.status))throw new yu(ca(e),e.status);let r;try{r=await e.json()}catch(s){throw new A1(ca(s),s)}let n;const a=xk(e);if(a&&a.getTime()>=C1["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new jh(ca(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new bn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new jh(ca(r),e.status,r.weak_password.reasons);throw new G_(ca(r),e.status||500,n)}const wk=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function be(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[vu]||(s[vu]=C1["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await _k(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function _k(e,t,r,n,a,s){const i=wk(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new yu(ca(l),0)}if(o.ok||await Rh(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Rh(l)}}function nn(e){var t;let r=null;Tk(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=nk(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Lh(e){const t=nn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function jn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function kk(e){return{data:e,error:null}}function Ek(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=vk(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function Sk(e){return e}function Tk(e){return e.access_token&&e.refresh_token&&e.expires_in}const r0=["global","local","others"];var bk=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class Nk{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=O1(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=r0[0]){if(r0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${r0.join(", ")}`);try{return await be(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(_e(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await be(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:jn})}catch(n){if(_e(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=bk(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Ek,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(_e(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await be(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:jn})}catch(r){if(_e(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},f=await be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:Sk});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,x=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return x.length>0&&(x.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);c[`${v}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(_e(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Ha(t);try{return await be(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:jn})}catch(r){if(_e(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Ha(t);try{return await be(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:jn})}catch(n){if(_e(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Ha(t);try{return await be(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:jn})}catch(n){if(_e(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Ha(t.userId);try{const{data:r,error:n}=await be(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Ha(t.userId),Ha(t.id);try{return{data:await be(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(_e(r))return{data:null,error:r};throw r}}}function Mh(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Ck(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const za={debug:!!(globalThis&&j1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class D1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Ak extends D1{}async function Fk(e,t,r){za.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),za.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){za.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{za.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw za.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Ak(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(za.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Ck();const jk={url:$_,storageKey:H_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:z_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Bh(e,t,r){return await r()}const Va={};class Ki{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ki.nextInstanceID,Ki.nextInstanceID+=1,this.instanceID>0&&jr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},jk),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Nk({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=O1(a.fetch),this.lock=a.lock||Bh,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:jr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Fk:this.lock=Bh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:j1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Mh(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Mh(this.memoryStorage)),jr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Va[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Va[this.storageKey]=Object.assign(Object.assign({},Va[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Va[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Va[this.storageKey]=Object.assign(Object.assign({},Va[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${N1}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=sk(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),jr()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),X_(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return _e(r)?{error:r}:{error:new A1("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:nn}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(_e(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:f,password:d,options:h}=t;let x=null,p=null;this.flowType==="pkce"&&([x,p]=await $a(this.storage,this.storageKey)),s=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:x,code_challenge_method:p},xform:nn})}else if("phone"in t){const{phone:f,password:d,options:h}=t;s=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:nn})}else throw new Lo("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(_e(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Lh})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Lh})}else throw new Lo("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ro}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(_e(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,i,o,l,c,f,d,h,x;let p,m;if("message"in t)p=t.message,m=t.signature;else{const{chain:v,wallet:y,statement:w,options:g}=t;let S;if(jr())if(typeof y=="object")S=y;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))S=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=y}const k=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in S&&S.signIn){const T=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),w?{statement:w}:null));let _;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")_=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)_=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)p=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),m=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${k.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(a=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((d=(f=g==null?void 0:g.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...g.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const T=await S.signMessage(new TextEncoder().encode(p),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=T}}try{const{data:v,error:y}=await be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:rk(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(x=t.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:nn});if(y)throw y;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new Ro}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:y})}catch(v){if(_e(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(t){const r=await ia(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:nn});if(await Sn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Ro}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(_e(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:nn}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ro}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(_e(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await $a(this.storage,this.storageKey));const{error:d}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:f}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f}}throw new Lo("You must provide either an email or phone number.")}catch(o){if(_e(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:nn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(_e(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await $a(this.storage,this.storageKey)),await be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:kk})}catch(s){if(_e(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new bn;const{error:a}=await be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(_e(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await be(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await be(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Lo("You must provide either an email or phone number and a type")}catch(r){if(_e(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ia(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Qc:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await ia(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=t0()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,f)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,f))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:jn}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new bn}:await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:jn})})}catch(r){if(_e(r))return q_(r)&&(await this._removeSession(),await Sn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new bn;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await $a(this.storage,this.storageKey));const{data:c,error:f}=await be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:jn});if(f)throw f;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(_e(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new bn;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=e0(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(_e(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new bn;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(_e(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!jr())throw new Mo("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Mo(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Fh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Mo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Fh("No code detected.");const{data:w,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new Mo("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let h=f+d;l&&(h=parseInt(l));const x=h-f;x*1e3<=Ga&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${d}s`);const p=h-d;f-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,f):f-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,f);const{data:m,error:v}=await this._getUser(s);if(v)throw v;const y={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:h,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(_e(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ia(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(K_(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Sn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=ak(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await $a(this.storage,this.storageKey,!0));try{return await be(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(_e(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(_e(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,f;const{data:d,error:h}=s;if(h)throw h;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await be(this.fetch,"GET",x,{headers:this.headers,jwt:(f=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return jr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(_e(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await be(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await lk(async a=>(a>0&&await ok(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:nn})),(a,s)=>{const i=200*Math.pow(2,a);return s&&Zc(s)&&Date.now()+i-n<Ga})}catch(n){if(this._debug(r,"error",n),_e(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),jr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await ia(this.storage,this.storageKey);if(a&&this.userStorage){let i=await ia(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await Ka(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:t0()}else if(a&&!a.user&&!a.user){const i=await ia(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await Sn(this.storage,this.storageKey+"-user"),await Ka(this.storage,this.storageKey,a)):a.user=t0()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Qc;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Qc}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),Zc(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new bn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new pc;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new bn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),_e(s)){const i={session:null,error:s};return Zc(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ka(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=Ih(a);await Ka(this.storage,this.storageKey,s)}else{const a=Ih(r);await Ka(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Sn(this.storage,this.storageKey),await Sn(this.storage,this.storageKey+"-code-verifier"),await Sn(this.storage,this.storageKey+"-user"),this.userStorage&&await Sn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&jr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ga);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Ga);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ga}ms, refresh threshold is ${gu} ticks`),a<=gu&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof D1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!jr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await $a(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await be(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await be(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await be(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(_e(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await be(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(_e(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=e0(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const f=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+W_>a)return n;const{data:s,error:i}=await be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:x,error:p}=await this.getSession();if(p||!x.session)return{data:null,error:p};n=x.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=e0(n);r!=null&&r.allowExpired||mk(s.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:s,header:a,signature:i},error:null}}const f=pk(a.alg),d=await crypto.subtle.importKey("jwk",c,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,i,tk(`${o}.${l}`)))throw new wu("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(_e(n))return{data:null,error:n};throw n}}}Ki.nextInstanceID=0;const Ok=Ki;class Dk extends Ok{constructor(t){super(t)}}var Pk=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class Ik{constructor(t,r,n){var a,s,i;this.supabaseUrl=t,this.supabaseKey=r;const o=U_(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:F_,realtime:O_,auth:Object.assign(Object.assign({},j_),{storageKey:l}),global:A_},f=B_(n??{},c);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=R_(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new Y2(new URL("rest/v1",o).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new b_(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new C2(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Pk(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,storageKey:i,flowType:o,lock:l,debug:c},f,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Dk({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),f),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new h_(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Rk=(e,t,r)=>new Ik(e,t,r);function Lk(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Lk()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Mk="https://kudptumbipdlayxvvbhc.supabase.co",Bk="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1ZHB0dW1iaXBkbGF5eHZ2YmhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NTM5ODQsImV4cCI6MjA3NzEyOTk4NH0.d8ztlRXIiAdVZ0m1neC55c7rhB0qJoA9qy75rNak5RY",pe=Rk(Mk,Bk),Bo="app_auth_user",Uk=8*60*60*1e3,Ll={async signIn(e,t){try{const{data:r,error:n}=await pe.rpc("verify_credentials",{p_username:e,p_password:t});if(n)throw console.error("Sign in error:",n),new Error(n.message||"Invalid username or password");if(!r||r.length===0)throw new Error("Invalid username or password");const a=r[0],s={userId:a.user_id,id:a.user_id,organisationId:a.organisation_id,role:a.role,username:e.toLowerCase(),fullName:e.toLowerCase()};await pe.rpc("update_last_login",{p_user_id:a.user_id});const i={...s,timestamp:Date.now()};return localStorage.setItem(Bo,JSON.stringify(i)),s}catch(r){throw console.error("Authentication error:",r),r}},signOut(){localStorage.removeItem(Bo)},getCurrentUser(){try{const e=localStorage.getItem(Bo);if(!e)return null;const t=JSON.parse(e);return Date.now()-t.timestamp>Uk?(this.signOut(),null):{userId:t.userId,id:t.id||t.userId,organisationId:t.organisationId,role:t.role,username:t.username,fullName:t.fullName||t.username}}catch(e){return console.error("Error getting current user:",e),null}},isAuthenticated(){return this.getCurrentUser()!==null},refreshSession(){const e=this.getCurrentUser();if(e){const t={...e,timestamp:Date.now()};localStorage.setItem(Bo,JSON.stringify(t))}}};function $k({onSuccess:e}){const[t,r]=Y.useState(""),[n,a]=Y.useState(""),[s,i]=Y.useState(""),[o,l]=Y.useState(!1),c=async f=>{f.preventDefault(),i(""),l(!0);try{await Ll.signIn(t,n),e()}catch(d){const h=d instanceof Error?d.message:"Invalid username or password";i(h)}finally{l(!1)}};return u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-slate-100",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full mx-4",children:[u.jsxs("div",{className:"px-8 py-6 border-b border-gray-200",children:[u.jsx("div",{className:"flex items-center justify-center mb-2",children:u.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center",children:u.jsx(kh,{className:"w-6 h-6 text-white"})})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-center",children:"Welcome Back"}),u.jsx("p",{className:"text-sm text-gray-600 text-center mt-1",children:"Sign in to your account"})]}),u.jsxs("form",{onSubmit:c,className:"px-8 py-6 space-y-5",children:[s&&u.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:s}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),u.jsx("input",{type:"text",id:"username",name:"username",value:t,onChange:f=>r(f.target.value),required:!0,disabled:o,className:"w-full px-4 py-3 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Enter your username",autoComplete:"username"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),u.jsx("input",{type:"password",id:"password",name:"password",value:n,onChange:f=>a(f.target.value),required:!0,disabled:o,className:"w-full px-4 py-3 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Enter your password",autoComplete:"current-password"})]}),u.jsx("button",{type:"submit",disabled:o,className:"w-full px-4 py-3 text-sm font-medium text-white bg-blue-500 rounded-lg hover:bg-blue-600 transition-colors disabled:bg-blue-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Signing in..."]}):u.jsxs(u.Fragment,{children:[u.jsx(kh,{className:"w-4 h-4"}),"Sign In"]})})]}),u.jsx("div",{className:"px-8 py-4 bg-gray-50 rounded-b-2xl border-t border-gray-200",children:u.jsx("p",{className:"text-xs text-gray-600 text-center",children:"Contact your administrator if you need help accessing your account."})})]})})}function P1({user:e,onClose:t}){const[r,n]=Y.useState([]),[a,s]=Y.useState(!0),[i,o]=Y.useState(!1),[l,c]=Y.useState(""),[f,d]=Y.useState(""),[h,x]=Y.useState("associate-editor"),[p,m]=Y.useState(!1),[v,y]=Y.useState(""),[w,g]=Y.useState(""),[S,k]=Y.useState(!1);Y.useEffect(()=>{T()},[]);const T=async()=>{s(!0),y("");try{const{data:H,error:Z}=await pe.from("user_profiles").select("id, role, created_at, last_login").eq("organisation_id",e.organisationId).order("created_at",{ascending:!1});if(Z)throw Z;const X=(H==null?void 0:H.map(q=>q.id))||[],{data:ee,error:oe}=await pe.from("auth_credentials").select("user_id, username, is_active").in("user_id",X);if(oe)throw oe;const te=new Map((ee==null?void 0:ee.map(q=>[q.user_id,{username:q.username,is_active:q.is_active}]))||[]),U=(H||[]).map(q=>{const se=te.get(q.id);return{id:q.id,username:(se==null?void 0:se.username)||"N/A",role:q.role,is_active:(se==null?void 0:se.is_active)??!0,created_at:q.created_at,last_login:q.last_login}});n(U)}catch(H){console.error("Error loading users:",H),y(H.message||"Failed to load users")}finally{s(!1)}},_=()=>{const H="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789!@#$%";let Z="";for(let X=0;X<12;X++)Z+=H.charAt(Math.floor(Math.random()*H.length));d(Z),m(!0)},A=async H=>{H.preventDefault(),y(""),g(""),k(!0);try{const Z=`${l.toLowerCase().replace(/\s+/g,"")}@temp.local`,{data:X,error:ee}=await pe.rpc("create_user_with_credentials",{p_email:Z,p_username:l.toLowerCase(),p_password:f,p_organisation_id:e.organisationId,p_role:h});if(ee)throw ee;g(`User created successfully! Username: ${l.toLowerCase()}`),c(""),d(""),x("associate-editor"),m(!1),o(!1),await T()}catch(Z){console.error("Error creating user:",Z),y(Z.message||"Failed to create user")}finally{k(!1)}},b=async(H,Z)=>{y(""),g("");try{const{error:X}=await pe.rpc("toggle_user_active_status",{p_user_id:H,p_is_active:!Z});if(X)throw X;g(`User ${Z?"deactivated":"activated"} successfully`),await T()}catch(X){console.error("Error toggling user status:",X),y(X.message||"Failed to update user status")}},R=async(H,Z)=>{y(""),g("");try{const{error:X}=await pe.from("user_profiles").update({role:Z}).eq("id",H);if(X)throw X;g("User role updated successfully"),await T()}catch(X){console.error("Error changing user role:",X),y(X.message||"Failed to update user role")}},L=async(H,Z)=>{if(window.confirm(`Are you sure you want to permanently delete user "${Z}"? This action cannot be undone.`)){y(""),g("");try{const{error:ee}=await pe.from("auth_credentials").delete().eq("user_id",H);if(ee)throw ee;const{error:oe}=await pe.from("user_profiles").delete().eq("id",H);if(oe)throw oe;g(`User "${Z}" deleted successfully`),await T()}catch(ee){console.error("Error deleting user:",ee),y(ee.message||"Failed to delete user")}}},I=e.role==="manager";return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-6 bg-black bg-opacity-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User Management"}),u.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(Pt,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"px-6 py-6",children:[v&&u.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:v}),w&&u.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg text-sm",children:w}),I&&!i&&u.jsxs("button",{onClick:()=>o(!0),className:"mb-4 inline-flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[u.jsx(w2,{className:"w-4 h-4"}),"Add New User"]}),i&&u.jsxs("form",{onSubmit:A,className:"mb-6 p-4 border border-gray-200 rounded-lg",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add New User"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),u.jsx("input",{type:"text",value:l,onChange:H=>c(H.target.value),required:!0,disabled:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter username"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("input",{type:p?"text":"password",value:f,onChange:H=>d(H.target.value),required:!0,disabled:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter password"}),u.jsx("button",{type:"button",onClick:()=>m(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:p?u.jsx(ol,{className:"w-4 h-4"}):u.jsx(ll,{className:"w-4 h-4"})})]}),u.jsx("button",{type:"button",onClick:_,disabled:S,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Generate"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),u.jsxs("select",{value:h,onChange:H=>x(H.target.value),disabled:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"manager",children:"Manager"}),u.jsx("option",{value:"associate-editor",children:"Associate - Editor"}),u.jsx("option",{value:"associate-viewer",children:"Associate - Viewer"})]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{type:"submit",disabled:S,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:bg-blue-300",children:S?"Creating...":"Create User"}),u.jsx("button",{type:"button",onClick:()=>{o(!1),c(""),d(""),x("associate-editor"),m(!1),y("")},disabled:S,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"})]})]})]}),a?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Loading users..."})]}):u.jsxs("div",{className:"overflow-x-auto",children:[u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Username"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Role"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Status"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Last Login"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Created"}),I&&u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(H=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:H.username}),u.jsx("td",{className:"px-4 py-3 text-sm",children:I&&H.id!==e.userId?u.jsxs("select",{value:H.role,onChange:Z=>R(H.id,Z.target.value),className:"px-2 py-1 text-xs font-medium border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",children:[u.jsx("option",{value:"manager",children:"Manager"}),u.jsx("option",{value:"associate-editor",children:"Associate - Editor"}),u.jsx("option",{value:"associate-viewer",children:"Associate - Viewer"})]}):u.jsx("span",{className:"inline-flex px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:H.role==="associate-editor"?"Associate - Editor":H.role==="associate-viewer"?"Associate - Viewer":"Manager"})}),u.jsx("td",{className:"px-4 py-3 text-sm",children:u.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium ${H.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:H.is_active?"Active":"Inactive"})}),u.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:H.last_login?u.jsxs(u.Fragment,{children:[u.jsx("div",{children:new Date(H.last_login).toLocaleDateString()}),u.jsx("div",{className:"text-xs text-gray-500",children:new Date(H.last_login).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}):u.jsx("span",{className:"text-gray-400 italic",children:"Never"})}),u.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(H.created_at).toLocaleDateString()}),I&&H.id!==e.userId&&u.jsx("td",{className:"px-4 py-3 text-sm",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>b(H.id,H.is_active),className:`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-xs font-medium transition-colors ${H.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:H.is_active?u.jsxs(u.Fragment,{children:[u.jsx(_2,{className:"w-3 h-3"}),"Deactivate"]}):u.jsxs(u.Fragment,{children:[u.jsx(y2,{className:"w-3 h-3"}),"Activate"]})}),u.jsxs("button",{onClick:()=>L(H.id,H.username),className:"inline-flex items-center gap-1 px-3 py-1 rounded-lg text-xs font-medium bg-red-600 text-white hover:bg-red-700 transition-colors",title:"Delete user permanently",children:[u.jsx(Ns,{className:"w-3 h-3"}),"Delete"]})]})}),I&&H.id===e.userId&&u.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:"Current user"})]},H.id))})]}),r.length===0&&u.jsx("div",{className:"text-center py-8 text-gray-600",children:"No users found"})]})]})]})})}function I1({user:e,onClose:t}){const[r,n]=Y.useState([]),[a,s]=Y.useState(!0),[i,o]=Y.useState(""),[l,c]=Y.useState("all"),[f,d]=Y.useState("all"),[h,x]=Y.useState([]),[p,m]=Y.useState(null);Y.useEffect(()=>{y(),v()},[]);const v=async()=>{try{const{data:k,error:T}=await pe.from("user_profiles").select("id").eq("organisation_id",e.organisationId);if(T)throw T;const _=(k==null?void 0:k.map(L=>L.id))||[];if(_.length===0)return;const{data:A,error:b}=await pe.from("auth_credentials").select("username").in("user_id",_);if(b)throw b;const R=(A==null?void 0:A.map(L=>L.username))||[];x(R.sort())}catch(k){console.error("Error loading users for filter:",k)}},y=async()=>{s(!0),o("");try{const{data:k,error:T}=await pe.from("activity_log").select("id, username, action_type, table_name, record_id, created_at, new_data").eq("organisation_id",e.organisationId).order("created_at",{ascending:!1}).limit(500);if(T)throw T;n(k||[]),n(k||[])}catch(k){console.error("Error loading activities:",k),o("Failed to load activity log")}finally{s(!1)}},w=k=>{switch(k){case"create":return"bg-green-100 text-green-800";case"update":return"bg-blue-100 text-blue-800";case"delete":return"bg-red-100 text-red-800";case"login":return"bg-purple-100 text-purple-800";case"logout":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},g=r.filter(k=>!(l!=="all"&&k.action_type!==l||f!=="all"&&k.username!==f)),S=()=>{const k=["Date","Time","User","Action","Table","Record ID"],T=g.map(L=>[new Date(L.created_at).toLocaleDateString(),new Date(L.created_at).toLocaleTimeString(),L.username,L.action_type,L.table_name,L.record_id]),_=[k.join(","),...T.map(L=>L.map(I=>`"${I}"`).join(","))].join(`
`),A=new Blob([_],{type:"text/csv"}),b=window.URL.createObjectURL(A),R=document.createElement("a");R.href=b,R.download=`activity-log-${new Date().toISOString().split("T")[0]}.csv`,R.click(),window.URL.revokeObjectURL(b)};return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-6",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:u.jsx(i1,{className:"w-5 h-5 text-white"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Activity Log"}),u.jsx("p",{className:"text-sm text-gray-600",children:"All user activities in your organisation"})]})]}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(Pt,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Af,{className:"w-4 h-4 text-gray-500"}),u.jsxs("select",{value:l,onChange:k=>c(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"all",children:"All Actions"}),u.jsx("option",{value:"create",children:"Create"}),u.jsx("option",{value:"update",children:"Update"}),u.jsx("option",{value:"delete",children:"Delete"}),u.jsx("option",{value:"login",children:"Login"}),u.jsx("option",{value:"logout",children:"Logout"})]})]}),u.jsxs("select",{value:f,onChange:k=>d(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"all",children:"All Users"}),h.map(k=>u.jsx("option",{value:k,children:k},k))]}),u.jsxs("button",{onClick:S,className:"ml-auto px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2 text-sm",children:[u.jsx(Gi,{className:"w-4 h-4"}),"Export CSV"]})]}),i&&u.jsx("div",{className:"mx-6 mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:i}),u.jsx("div",{className:"flex-1 overflow-auto px-6 py-4",children:a?u.jsxs("div",{className:"text-center py-12",children:[u.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("p",{className:"text-gray-600 mt-4",children:"Loading activity log..."})]}):g.length===0?u.jsx("div",{className:"text-center py-12 text-gray-600",children:"No activities found"}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Date & Time"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"User"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Action"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Table"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Record ID"}),u.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:"Details"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:g.map(k=>u.jsxs(u.Fragment,{children:[u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[u.jsx("div",{children:new Date(k.created_at).toLocaleDateString()}),u.jsx("div",{className:"text-xs text-gray-500",children:new Date(k.created_at).toLocaleTimeString()})]}),u.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:k.username}),u.jsx("td",{className:"px-4 py-3 text-sm",children:u.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium ${w(k.action_type)}`,children:k.action_type})}),u.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:k.table_name}),u.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 font-mono text-xs",children:k.record_id||"-"}),u.jsx("td",{className:"px-4 py-3 text-sm",children:k.new_data&&u.jsx("button",{onClick:()=>m(p===k.id?null:k.id),className:"text-gray-400 hover:text-blue-500 focus:outline-none",children:p===k.id?u.jsx(c2,{className:"w-5 h-5"}):u.jsx(o2,{className:"w-5 h-5"})})})]},k.id),p===k.id&&k.new_data&&u.jsx("tr",{className:"bg-gray-50",children:u.jsx("td",{colSpan:6,className:"px-4 py-3",children:u.jsxs("div",{className:"bg-white p-3 rounded border border-gray-200",children:[u.jsxs("h4",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wider flex items-center gap-1",children:[u.jsx(u2,{className:"w-3 h-3"}),"Change Details"]}),u.jsx("pre",{className:"text-xs text-gray-700 font-mono whitespace-pre-wrap overflow-x-auto",children:JSON.stringify(k.new_data,null,2)})]})})})]}))})]})})}),u.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:u.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",g.length," of ",r.length," activities"]})})]})})}function R1({user:e,onClose:t}){const[r,n]=Y.useState(""),[a,s]=Y.useState(""),[i,o]=Y.useState(""),[l,c]=Y.useState(!1),[f,d]=Y.useState(!1),[h,x]=Y.useState(!1),[p,m]=Y.useState(""),[v,y]=Y.useState(""),[w,g]=Y.useState(!1),S=async k=>{if(k.preventDefault(),m(""),y(""),!r||!a||!i){m("All fields are required");return}if(a!==i){m("New passwords do not match");return}if(a.length<6){m("New password must be at least 6 characters long");return}if(r===a){m("New password must be different from current password");return}g(!0);try{const A=await fetch("https://kudptumbipdlayxvvbhc.supabase.co/functions/v1/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1ZHB0dW1iaXBkbGF5eHZ2YmhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NTM5ODQsImV4cCI6MjA3NzEyOTk4NH0.d8ztlRXIiAdVZ0m1neC55c7rhB0qJoA9qy75rNak5RY"},body:JSON.stringify({username:e.username,current_password:r,new_password:a})}),b=await A.json();if(!A.ok)throw new Error(b.error||"Failed to change password");y("Password changed successfully!"),n(""),s(""),o(""),setTimeout(()=>{t()},2e3)}catch(T){m(T instanceof Error?T.message:"An error occurred")}finally{g(!1)}};return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(o1,{className:"w-5 h-5 text-blue-600"}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Change Password"})]}),u.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close",children:u.jsx(Pt,{className:"w-5 h-5 text-gray-500"})})]}),u.jsxs("form",{onSubmit:S,className:"p-6 space-y-4",children:[p&&u.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:p}),v&&u.jsx("div",{className:"p-3 bg-green-50 border border-green-200 text-green-700 rounded-lg text-sm",children:v}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:l?"text":"password",value:r,onChange:k=>n(k.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter current password",disabled:w}),u.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",tabIndex:-1,children:l?u.jsx(ol,{className:"w-4 h-4"}):u.jsx(ll,{className:"w-4 h-4"})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:f?"text":"password",value:a,onChange:k=>s(k.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter new password (min. 6 characters)",disabled:w}),u.jsx("button",{type:"button",onClick:()=>d(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",tabIndex:-1,children:f?u.jsx(ol,{className:"w-4 h-4"}):u.jsx(ll,{className:"w-4 h-4"})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:h?"text":"password",value:i,onChange:k=>o(k.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirm new password",disabled:w}),u.jsx("button",{type:"button",onClick:()=>x(!h),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",tabIndex:-1,children:h?u.jsx(ol,{className:"w-4 h-4"}):u.jsx(ll,{className:"w-4 h-4"})})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:w,children:"Cancel"}),u.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",disabled:w,children:w?"Changing...":"Change Password"})]})]})]})})}function Hk({user:e,onSignOut:t,children:r}){const[n,a]=Y.useState(!1),[s,i]=Y.useState(!1),[o,l]=Y.useState(!1),[c,f]=Y.useState(!1);return Y.useEffect(()=>{const d=()=>a(!1);if(n)return document.addEventListener("click",d),()=>document.removeEventListener("click",d)},[n]),u.jsxs(u.Fragment,{children:[s&&u.jsx(P1,{user:e,onClose:()=>i(!1)}),o&&u.jsx(I1,{user:e,onClose:()=>l(!1)}),c&&u.jsx(R1,{user:e,onClose:()=>f(!1)}),r]})}function zk({user:e,onShowUserManagement:t,onShowActivityLog:r,onShowChangePassword:n,onShowGoogleOAuth:a,onSignOut:s}){const[i,o]=Y.useState(!1);return Y.useEffect(()=>{const l=()=>o(!1);if(i)return document.addEventListener("click",l),()=>document.removeEventListener("click",l)},[i]),u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:l=>{l.stopPropagation(),o(!i)},className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"User menu",children:u.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:u.jsx(u1,{className:"w-4 h-4 text-white"})})}),i&&u.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[u.jsxs("div",{className:"px-4 py-3 border-b border-gray-200",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.username}),u.jsx("div",{className:"text-xs text-gray-600 capitalize",children:e.role})]}),e.role==="manager"&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:()=>{t(),o(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2",children:[u.jsx(fc,{className:"w-4 h-4"}),"Manage Users"]}),u.jsxs("button",{onClick:()=>{r(),o(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2",children:[u.jsx(i1,{className:"w-4 h-4"}),"Activity Log"]}),u.jsxs("button",{onClick:()=>{a(),o(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2",children:[u.jsx(lu,{className:"w-4 h-4"}),"Google Integration"]})]}),u.jsxs("button",{onClick:()=>{n(),o(!1)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2",children:[u.jsx(o1,{className:"w-4 h-4"}),"Change Password"]}),u.jsxs("button",{onClick:()=>{s(),o(!1)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 transition-colors flex items-center gap-2",children:[u.jsx(h2,{className:"w-4 h-4"}),"Sign Out"]})]})]})}const Vk=["https://www.googleapis.com/auth/calendar","https://www.googleapis.com/auth/calendar.events","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/gmail.send"].join(" "),n0={initiateGoogleOAuth(e,t){const r=window.location.origin,n=btoa(JSON.stringify({userId:e,organisationId:t,returnUrl:r,timestamp:Date.now()})),s=`https://accounts.google.com/o/oauth2/v2/auth?${new URLSearchParams({client_id:"79967112788-lohda0rikfi8boj78u0c3uc03kaj81g1.apps.googleusercontent.com",redirect_uri:"https://kudptumbipdlayxvvbhc.supabase.co/functions/v1/google-oauth-callback",response_type:"code",scope:Vk,access_type:"offline",prompt:"consent",state:n}).toString()}`;console.log("OAuth URL:",s),console.log("Client ID:","79967112788-lohda0rikfi8boj78u0c3uc03kaj81g1.apps.googleusercontent.com"),console.log("Redirect URI:","https://kudptumbipdlayxvvbhc.supabase.co/functions/v1/google-oauth-callback"),console.log("Return URL:",r),window.location.href=s},async getOAuthConnection(e){try{const{data:t,error:r}=await pe.from("google_oauth_tokens").select("*").eq("organisation_id",e).eq("is_active",!0).maybeSingle();return r?(console.error("Error fetching OAuth connection:",r),null):t?{id:t.id,organisationId:t.organisation_id,connectedByUserId:t.connected_by_user_id,googleEmail:t.google_email,tokenExpiry:t.token_expiry,isActive:t.is_active,createdAt:t.created_at,updatedAt:t.updated_at}:null}catch(t){return console.error("Error getting OAuth connection:",t),null}},async disconnectOAuth(e){try{const{error:t}=await pe.from("google_oauth_tokens").update({is_active:!1,updated_at:new Date().toISOString()}).eq("organisation_id",e).eq("is_active",!0);return t?(console.error("Error disconnecting OAuth:",t),!1):!0}catch(t){return console.error("Error disconnecting OAuth:",t),!1}},async checkTokenExpiry(e){const t=await this.getOAuthConnection(e);if(!t)return!1;const r=new Date(t.tokenExpiry),n=new Date,a=5*60*1e3;return r.getTime()-n.getTime()<a},async refreshTokenIfNeeded(e){if(await this.checkTokenExpiry(e))try{(await fetch("https://kudptumbipdlayxvvbhc.supabase.co/functions/v1/refresh-google-token",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1ZHB0dW1iaXBkbGF5eHZ2YmhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NTM5ODQsImV4cCI6MjA3NzEyOTk4NH0.d8ztlRXIiAdVZ0m1neC55c7rhB0qJoA9qy75rNak5RY"},body:JSON.stringify({organisationId:e})})).ok||console.error("Failed to refresh token")}catch(r){console.error("Error refreshing token:",r)}}};function Uh(){const[e,t]=Y.useState(null),[r,n]=Y.useState(!0),[a,s]=Y.useState(!1),[i,o]=Y.useState(null),[l,c]=Y.useState(null),f=Ll.getCurrentUser();Y.useEffect(()=>{d();const m=new URLSearchParams(window.location.search),v=m.get("oauth_success"),y=m.get("oauth_error");v==="true"?(c("Google account connected successfully"),window.history.replaceState({},"",window.location.pathname),d()):y&&(o(`Failed to connect Google account: ${y}`),window.history.replaceState({},"",window.location.pathname))},[]);const d=async()=>{if(f){n(!0);try{const m=await n0.getOAuthConnection(f.organisationId);t(m)}catch(m){console.error("Error checking OAuth status:",m)}finally{n(!1)}}},h=()=>{f&&(o(null),c(null),n0.initiateGoogleOAuth(f.userId,f.organisationId))},x=async()=>{if(!(!f||!e)&&confirm("Are you sure you want to disconnect your Google account? This will disable automatic Google Meet link generation.")){s(!0),o(null),c(null);try{await n0.disconnectOAuth(f.organisationId)?(t(null),c("Google account disconnected successfully")):o("Failed to disconnect Google account")}catch(m){console.error("Error disconnecting:",m),o("Failed to disconnect Google account")}finally{s(!1)}}},p=e&&new Date(e.tokenExpiry)<new Date;return r?u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx(cu,{className:"w-5 h-5 text-gray-400 animate-spin"}),u.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading connection status..."})]})}):u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsx("div",{className:"flex items-center justify-between mb-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${e?"bg-green-100":"bg-gray-100"}`,children:e?u.jsx(ou,{className:"w-5 h-5 text-green-600"}):u.jsx(lu,{className:"w-5 h-5 text-gray-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Google Account"}),u.jsx("p",{className:"text-sm text-gray-600",children:e?"Connected":"Not connected"})]})]})}),i&&u.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-3 flex items-start gap-2",children:[u.jsx(iu,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),u.jsx("div",{className:"text-sm text-red-700",children:i})]}),l&&u.jsxs("div",{className:"mb-4 bg-green-50 border border-green-200 rounded-lg p-3 flex items-start gap-2",children:[u.jsx(ou,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),u.jsx("div",{className:"text-sm text-green-700",children:l})]}),e?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Email"}),u.jsx("span",{className:"text-sm text-gray-900",children:e.googleEmail})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status"}),u.jsx("span",{className:`text-sm ${p?"text-red-600":"text-green-600"}`,children:p?"Expired":"Active"})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Connected"}),u.jsx("span",{className:"text-sm text-gray-900",children:new Date(e.createdAt).toLocaleDateString()})]})]}),p&&u.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[u.jsx(iu,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),u.jsx("div",{className:"text-sm text-yellow-700",children:"Your token has expired. Please reconnect your Google account."})]}),u.jsx("button",{onClick:x,disabled:a,className:"w-full px-4 py-2 text-sm font-medium text-red-600 bg-red-50 rounded-lg hover:bg-red-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:a?u.jsxs(u.Fragment,{children:[u.jsx(cu,{className:"w-4 h-4 animate-spin"}),"Disconnecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(v2,{className:"w-4 h-4"}),"Disconnect Google Account"]})})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Connect your Google account to automatically generate Google Meet links for scheduled meetings."}),u.jsxs("button",{onClick:h,className:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-500 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[u.jsx(lu,{className:"w-4 h-4"}),"Connect Google Account"]})]}),u.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:u.jsx("p",{className:"text-xs text-gray-500",children:"By connecting your Google account, you grant access to create calendar events and generate Meet links."})})]})}const Wk=["January","February","March","April","May","June","July","August","September","October","November","December"],Gk=e=>{const t=e.getFullYear(),r=e.getMonth(),n=new Date(t,r,1),s=new Date(t,r+1,0).getDate(),i=n.getDay();return{daysInMonth:s,startingDayOfWeek:i,year:t,month:r}},$h=(e,t,r)=>{const n=[];return e.due_dates.forEach(a=>{const s=new Date(a),i=s.getDate(),o=s.getMonth(),l=s.getFullYear();if(e.frequency==="one-time")o===t&&l===r&&n.push(new Date(r,t,i));else if(e.frequency==="quarterly"){let c=new Date(l,o,i);const f=new Date(r+10,11,31);for(;c<=f;){if(c.getMonth()===t&&c.getFullYear()===r){n.push(new Date(c));break}c.setMonth(c.getMonth()+3)}}else if(e.frequency==="half-yearly"){let c=new Date(l,o,i);const f=new Date(r+10,11,31);for(;c<=f;){if(c.getMonth()===t&&c.getFullYear()===r){n.push(new Date(c));break}c.setMonth(c.getMonth()+6)}}else e.frequency==="annual"&&o===t&&r>=l&&n.push(new Date(r,t,i))}),n};function Kk({currentDate:e,events:t,payments:r,onSelectEvent:n,onTogglePaymentStatus:a}){const{daysInMonth:s,startingDayOfWeek:i}=Gk(e),o=d=>t.filter(h=>h.date.getDate()===d&&h.date.getMonth()===e.getMonth()&&h.date.getFullYear()===e.getFullYear()),l=d=>r.filter(h=>$h(h,e.getMonth(),e.getFullYear()).some(p=>p.getDate()===d)),c=[],f=Math.ceil((s+i)/7)*7;for(let d=0;d<f;d++){const h=d-i+1,x=h>0&&h<=s,p=x?o(h):[],m=x?l(h):[];c.push(u.jsx("div",{className:`min-h-24 border border-gray-200 p-2 ${x?"bg-white":"bg-gray-50"}`,children:x&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:h}),u.jsxs("div",{className:"space-y-1",children:[p.map(v=>u.jsx("div",{onClick:()=>n(v),className:`text-xs px-2 py-1 rounded ${v.color} cursor-pointer hover:opacity-80 transition-opacity`,children:v.title},v.id)),m.map(v=>{const w=$h(v,e.getMonth(),e.getFullYear()).find(b=>b.getDate()===h),g=w?w.toISOString().split("T")[0]:"",S=v.payment_status[g]||"unpaid",k=new Date;k.setHours(0,0,0,0);const T=w?new Date(w):null;T&&T.setHours(0,0,0,0);const _=T&&T.getTime()===k.getTime();return T&&T.getTime()<k.getTime()?null:u.jsx("div",{className:`text-xs px-2 py-1 rounded cursor-pointer hover:opacity-80 transition-opacity ${S==="paid"?"bg-green-100 text-green-800":"bg-emerald-100 text-emerald-800"}`,title:`Payment: ${v.client_name} - ${v.amount} (${S})`,children:u.jsxs("div",{className:"flex items-center justify-between gap-1",children:[u.jsxs("span",{children:["",v.amount," - ",v.client_name]}),_&&u.jsx("button",{onClick:b=>{b.stopPropagation(),a(v,g)},disabled:S==="paid",className:`px-1.5 py-0.5 rounded text-xs font-medium ${S==="paid"?"bg-green-600 text-white cursor-not-allowed opacity-90":"bg-orange-500 text-white hover:bg-orange-600 cursor-pointer"}`,title:S==="paid"?"Payment already marked as paid":"Mark as paid",children:S==="paid"?"Paid":"Unpaid"})]})},`${v.id}-${g}`)})]})]})},d))}return u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[u.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(d=>u.jsx("div",{className:"text-center text-xs font-semibold text-gray-600 py-3 border-r border-gray-200 last:border-r-0",children:d},d))}),u.jsx("div",{className:"grid grid-cols-7",children:c})]})}function qk({events:e,onSelectEvent:t}){const r=e.reduce((a,s)=>{const i=s.date.toDateString();return a[i]||(a[i]=[]),a[i].push(s),a},{}),n=Object.keys(r).sort((a,s)=>new Date(a).getTime()-new Date(s).getTime());return e.length===0?u.jsx("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-200",children:u.jsx("p",{className:"text-gray-500",children:"No upcoming events scheduled"})}):u.jsx("div",{className:"space-y-8",children:n.map(a=>u.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[u.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:u.jsx("h3",{className:"font-semibold text-gray-900",children:new Date(a).toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})})}),u.jsx("div",{className:"divide-y divide-gray-200",children:r[a].sort((s,i)=>s.time.localeCompare(i.time)).map(s=>u.jsx("div",{onClick:()=>t(s),className:"p-6 hover:bg-gray-50 transition-colors cursor-pointer group",children:u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:`p-3 rounded-lg ${s.color} bg-opacity-10`,children:s.isOnline?u.jsx(k2,{className:`w-6 h-6 ${s.color.replace("bg-","text-").replace("text-white","")}`}):s.location==="On Call"?u.jsx(p2,{className:`w-6 h-6 ${s.color.replace("bg-","text-").replace("text-white","")}`}):u.jsx(va,{className:`w-6 h-6 ${s.color.replace("bg-","text-").replace("text-white","")}`})}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 group-hover:text-amber-600 transition-colors",children:s.title}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-1 text-sm text-gray-500",children:[u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(va,{className:"w-4 h-4"}),s.time]}),u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(l1,{className:"w-4 h-4"}),s.location]})]})]})]}),u.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium self-start sm:self-center ${s.alert_type==="remind"?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}`,children:s.alert_type==="remind"?"Reminder Set":"No Reminder"})]})},s.id))})]},a))})}function Xk({payments:e,loading:t,user:r,onEdit:n,onDelete:a,onToggleStatus:s}){const[i,o]=Y.useState(""),[l,c]=Y.useState("all"),[f,d]=Y.useState("all"),[h,x]=Y.useState("all"),p=r.role==="manager"||r.role==="associate_editor",m=r.role==="manager",v=r.role==="associate_viewer",y=new Date;y.setHours(0,0,0,0);const w=[];e.forEach(k=>{k.due_dates.forEach(T=>{T&&w.push({payment:k,dateKey:T,date:new Date(T)})})});const g=w.filter(({payment:k,dateKey:T})=>{const _=k.payment_status[T]||"unpaid";return!(h!=="all"&&(h==="pending"&&_!=="unpaid"||h==="completed"&&_!=="paid")||i&&!k.client_name.toLowerCase().includes(i.toLowerCase())||l!=="all"&&k.frequency!==l||f!=="all"&&k.payment_method!==f)}),S={};return g.forEach(k=>{const T=k.date.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});S[T]||(S[T]=[]),S[T].push(k)}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[u.jsxs("div",{className:"p-6 border-b border-gray-200 space-y-4",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Payment Schedule"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(c1,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search client...",value:i,onChange:k=>o(k.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm w-full sm:w-64"})]})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Af,{className:"w-4 h-4 text-gray-500"}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filters:"})]}),u.jsxs("select",{value:h,onChange:k=>x(k.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 bg-white",children:[u.jsx("option",{value:"all",children:"All Status"}),u.jsx("option",{value:"pending",children:"Pending"}),u.jsx("option",{value:"completed",children:"Completed"})]}),u.jsxs("select",{value:l,onChange:k=>c(k.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 bg-white",children:[u.jsx("option",{value:"all",children:"All Frequencies"}),u.jsx("option",{value:"one-time",children:"One-time"}),u.jsx("option",{value:"quarterly",children:"Quarterly"}),u.jsx("option",{value:"half-yearly",children:"Half Yearly"}),u.jsx("option",{value:"annual",children:"Annual"})]}),u.jsxs("select",{value:f,onChange:k=>d(k.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 bg-white",children:[u.jsx("option",{value:"all",children:"All Methods"}),u.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),u.jsx("option",{value:"cash",children:"Cash"}),u.jsx("option",{value:"upi",children:"UPI"})]}),(h!=="all"||l!=="all"||f!=="all"||i)&&u.jsx("button",{onClick:()=>{x("all"),c("all"),d("all"),o("")},className:"text-sm text-red-600 hover:text-red-700 hover:underline px-2",children:"Clear all"})]})]}),u.jsx("div",{className:"divide-y divide-gray-200",children:t?u.jsxs("div",{className:"p-12 text-center",children:[u.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"}),u.jsx("p",{className:"text-gray-500 text-sm mt-3",children:"Loading payments..."})]}):Object.keys(S).length===0?u.jsxs("div",{className:"p-12 text-center",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-emerald-100 mb-4",children:u.jsx(Ts,{className:"w-6 h-6 text-emerald-600"})}),u.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No payments found"}),u.jsx("p",{className:"mt-1 text-gray-500",children:i||h!=="all"||l!=="all"||f!=="all"?"No payments found matching your filters.":"No payments have been scheduled yet."})]}):Object.entries(S).sort(([,k],[,T])=>k[0].date.getTime()-T[0].date.getTime()).map(([k,T])=>u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-gray-100",children:[u.jsx(xs,{className:"w-4 h-4 text-emerald-600"}),u.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:k}),u.jsxs("span",{className:"text-xs text-gray-500",children:["(",T.length," payment",T.length!==1?"s":"",")"]})]}),u.jsx("div",{className:"space-y-3",children:T.map(({payment:_,dateKey:A,date:b})=>{const R=_.payment_status[A]||"unpaid",L=new Date(b);L.setHours(0,0,0,0);const I=L.getTime()<=y.getTime(),H=_.due_dates.findIndex(X=>X===A),Z=_.amounts&&_.amounts.length>H&&H>=0?_.amounts[H]:_.amount;return u.jsx("div",{className:"p-4 hover:bg-gray-50 rounded-lg transition-colors border border-gray-100",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-2",children:_.client_name}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(Ts,{className:"w-4 h-4"}),u.jsxs("span",{className:"font-medium",children:["",Z.toFixed(2)]})]}),u.jsx("div",{className:"flex items-center gap-1.5",children:u.jsx("span",{className:"capitalize",children:_.payment_method.replace("_"," ")})}),u.jsxs("div",{className:"flex items-center gap-1.5 text-gray-500",children:[u.jsx(fc,{className:"w-4 h-4"}),u.jsx("span",{children:_.created_by_name||"Not tracked"})]})]}),_.comments&&u.jsx("div",{className:"text-sm text-gray-600 italic bg-gray-50 px-3 py-2 rounded border-l-2 border-emerald-500",children:_.comments})]})]}),u.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[u.jsx("span",{className:"px-2.5 py-1 bg-emerald-100 text-emerald-700 text-xs font-medium rounded-full whitespace-nowrap capitalize",children:_.frequency.replace("-"," ")}),I&&p&&u.jsx("button",{onClick:()=>s(_,A),disabled:R==="paid",className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${R==="paid"?"bg-green-600 text-white cursor-not-allowed opacity-90":"bg-orange-500 text-white hover:bg-orange-600 cursor-pointer"}`,title:R==="paid"?"Payment already marked as paid":"Mark as paid",children:R==="paid"?"Paid":"Unpaid"}),I&&v&&u.jsx("span",{className:`px-3 py-1.5 rounded-lg text-xs font-medium ${R==="paid"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:R==="paid"?"Paid":"Unpaid"}),p&&u.jsx("button",{onClick:()=>n(_),className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors","aria-label":"Modify payment",title:"Modify",children:u.jsx(m2,{className:"w-4 h-4"})}),m&&u.jsx("button",{onClick:()=>a(_.id),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors","aria-label":"Delete payment",title:"Delete",children:u.jsx(Ns,{className:"w-4 h-4"})})]})]})},`${_.id}-${A}`)})})]},k))}),g.length>0&&u.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:u.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Showing ",g.length," of ",e.length," scheduled payment",e.length!==1?"s":""]})})]})}function Yk({clients:e,events:t,loading:r,user:n,onSelectClient:a,onDeleteClient:s,onAddClient:i,onImportClients:o}){const[l,c]=Y.useState(""),f=e.filter(x=>x.name.toLowerCase().includes(l.toLowerCase())),d=n.role==="manager"||n.role==="associate_editor",h=n.role==="manager";return u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Clients"}),u.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[u.jsxs("div",{className:"relative flex-1 sm:min-w-[200px]",children:[u.jsx("input",{type:"text",placeholder:"Search clients...",value:l,onChange:x=>c(x.target.value),className:"w-full pl-4 pr-10 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),l&&u.jsx("button",{onClick:()=>c(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:u.jsx(Pt,{className:"w-4 h-4"})})]}),d&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:o,className:"flex-shrink-0 flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[u.jsx(s1,{className:"w-4 h-4"}),u.jsx("span",{className:"hidden sm:inline",children:"Import Clients"}),u.jsx("span",{className:"sm:hidden",children:"Import"})]}),u.jsxs("button",{onClick:i,className:"flex-shrink-0 flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-amber-500 rounded-lg hover:bg-amber-600 transition-colors",children:[u.jsx(bs,{className:"w-4 h-4"}),u.jsx("span",{className:"hidden sm:inline",children:"Add Client"}),u.jsx("span",{className:"sm:hidden",children:"Add"})]})]})]})]})}),u.jsx("div",{className:"divide-y divide-gray-200",children:r?u.jsxs("div",{className:"p-12 text-center",children:[u.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600"}),u.jsx("p",{className:"text-gray-500 text-sm mt-3",children:"Loading clients..."})]}):f.length===0?u.jsxs("div",{className:"p-12 text-center",children:[u.jsx(fc,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:l?"No clients found matching search":"No clients added yet"}),d&&u.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-amber-500 rounded-lg hover:bg-amber-600 transition-colors",children:[u.jsx(bs,{className:"w-4 h-4"}),"Add Your First Client"]})]}):u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(x=>u.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[u.jsxs("div",{className:"flex items-start justify-between mb-2",children:[u.jsx("h4",{className:"text-base font-semibold text-gray-900 hover:text-amber-600 transition-colors cursor-pointer",onClick:()=>a(x),children:x.name}),h&&u.jsx("button",{onClick:p=>{p.stopPropagation(),s(x.id)},className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors","aria-label":"Delete client",title:"Delete client",children:u.jsx(Ns,{className:"w-4 h-4"})})]}),u.jsx("div",{className:"flex items-center gap-2 cursor-pointer mt-1",onClick:()=>a(x),children:u.jsx("span",{className:`px-2.5 py-1 text-xs font-medium rounded-full ${x.type==="mutual_funds"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:x.type==="mutual_funds"?"Mutual Funds":"Holistic"})}),(()=>{const p=t.filter(m=>{if(m.clientName!==x.name)return!1;const v=new Date(m.date),[y,w]=m.time.split(":");return v.setHours(parseInt(y||"0"),parseInt(w||"0")),v>=new Date}).sort((m,v)=>{const y=new Date(m.date),[w,g]=m.time.split(":");y.setHours(parseInt(w||"0"),parseInt(g||"0"));const S=new Date(v.date),[k,T]=v.time.split(":");return S.setHours(parseInt(k||"0"),parseInt(T||"0")),y.getTime()-S.getTime()})[0];return p?u.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 flex items-center gap-2 text-xs text-amber-600 bg-amber-50 p-2 rounded",children:[u.jsx("div",{className:"font-medium",children:"Next:"}),u.jsxs("div",{children:[new Date(p.date).toLocaleDateString(void 0,{month:"short",day:"numeric"})," at ",p.time]})]}):null})()]},x.id))})})}),e.length>0&&u.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:u.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Showing ",e.length," client",e.length!==1?"s":""]})})]})}const yi=e=>e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`,_u=e=>e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Upload date unavailable",ku=e=>u.jsx(Gn,{className:"w-5 h-5 flex-shrink-0"});function Jk({history:e,loading:t,user:r,onUploadMOM:n}){const[a,s]=Y.useState(""),[i,o]=Y.useState(null),[l,c]=Y.useState("all"),[f,d]=Y.useState("all"),h=async(v,y)=>{var g;const w=(g=v.target.files)==null?void 0:g[0];if(w){if(w.size>10*1024*1024){alert("File size too large. Please select a file smaller than 10MB.");return}try{if(o(y),await n(y,w))alert("MOM uploaded successfully!");else throw new Error("Upload failed")}catch(S){console.error("Error uploading MOM:",S),alert("Failed to upload MOM. Please try again.")}finally{o(null),v.target.value=""}}},x=async(v,y)=>{try{const{data:w,error:g}=await pe.storage.from("mom-files").download(v);if(g){console.error("Error downloading file:",g),alert("Failed to download file. Please try again.");return}if(w){const S=URL.createObjectURL(w),k=document.createElement("a");k.href=S,k.download=y,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(S)}}catch(w){console.error("Error in handleDownloadMOMFile:",w),alert("An error occurred. Please try again.")}},p=async(v,y)=>{try{const{data:w,error:g}=await pe.storage.from("mom-files").createSignedUrl(v,3600);if(g){console.error("Error getting file URL:",g),alert("Failed to get file URL. Please try again.");return}w!=null&&w.signedUrl&&window.open(w.signedUrl,"_blank")}catch(w){console.error("Error in handleViewMOMFile:",w),alert("An error occurred. Please try again.")}},m=e.filter(v=>{var g,S,k,T,_;const y=a.toLowerCase();if(!(((g=v.client_name)==null?void 0:g.toLowerCase().includes(y))||((S=v.agenda)==null?void 0:S.toLowerCase().includes(y))||((k=v.location)==null?void 0:k.toLowerCase().includes(y))))return!1;if(l!=="all"){const A=new Date(v.start_date),b=new Date,R=new Date(b);R.setDate(b.getDate()-b.getDay()),R.setHours(0,0,0,0);const L=new Date(b.getFullYear(),b.getMonth(),1);if(l==="this_week"){if(A<R)return!1}else if(l==="this_month"&&A<L)return!1}if(f!=="all"){const A=v.is_online||((T=v.location)==null?void 0:T.toLowerCase())==="online"||v.meeting_type==="online",b=v.meeting_type==="on_call"||((_=v.location)==null?void 0:_.toLowerCase())==="on call",R=!A&&!b;if(f==="online"&&!A||f==="on_call"&&!b||f==="in_person"&&!R)return!1}return!0});return t?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600"})}):u.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex flex-col gap-4 mb-8",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Meeting History"}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Past meetings and Minutes of Meeting (MOM)"})]}),u.jsxs("div",{className:"relative w-full sm:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(c1,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",placeholder:"Search history...",value:a,onChange:v=>s(v.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-amber-500 focus:border-amber-500 sm:text-sm"})]})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-3 bg-white p-3 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mr-2",children:[u.jsx(Af,{className:"w-4 h-4"}),u.jsx("span",{className:"font-medium",children:"Filters:"})]}),u.jsxs("select",{value:f,onChange:v=>d(v.target.value),className:"text-sm border-gray-300 rounded-md shadow-sm focus:border-amber-500 focus:ring-amber-500",children:[u.jsx("option",{value:"all",children:"All Types"}),u.jsx("option",{value:"online",children:"Online"}),u.jsx("option",{value:"on_call",children:"On Call"}),u.jsx("option",{value:"in_person",children:"In Person"})]}),u.jsxs("select",{value:l,onChange:v=>c(v.target.value),className:"text-sm border-gray-300 rounded-md shadow-sm focus:border-amber-500 focus:ring-amber-500",children:[u.jsx("option",{value:"all",children:"All Dates"}),u.jsx("option",{value:"this_week",children:"This Week"}),u.jsx("option",{value:"this_month",children:"This Month"})]})]})]}),u.jsx("div",{className:"space-y-6",children:m.length===0?u.jsx("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-200",children:u.jsx("p",{className:"text-gray-500",children:"No meeting history found"})}):m.map(v=>u.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-1",children:v.client_name}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500",children:[u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(va,{className:"w-4 h-4"}),u.jsxs("span",{children:[new Date(v.start_date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})," at ",v.start_time]})]}),u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(l1,{className:"w-4 h-4"}),u.jsx("span",{children:v.location})]})]})]}),v.meeting_link&&u.jsxs("a",{href:v.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-amber-700 bg-amber-50 hover:bg-amber-100 rounded-lg transition-colors self-start",children:[u.jsx(Ff,{className:"w-4 h-4"}),"Meeting Link"]})]}),v.agenda&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Agenda"}),u.jsx("p",{className:"text-sm text-gray-600 leading-relaxed bg-gray-50 p-3 rounded-lg",children:v.agenda})]}),v.mom_files&&v.mom_files.length>0&&u.jsxs("div",{className:"border-t border-gray-100 pt-4",children:[u.jsxs("h4",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center gap-2",children:[u.jsx(Gn,{className:"w-4 h-4 text-amber-600"}),"Minutes of Meeting (",v.mom_files.length,")"]}),u.jsx("div",{className:"flex items-center gap-2 mb-3",children:u.jsxs("label",{className:`cursor-pointer inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-amber-700 bg-amber-50 hover:bg-amber-100 rounded-lg transition-colors ${i===v.id?"opacity-50 cursor-not-allowed":""}`,children:[u.jsx("input",{type:"file",className:"hidden",onChange:y=>h(y,v.id),disabled:i===v.id,accept:".pdf,.doc,.docx,.txt"}),u.jsx("div",{className:"w-4 h-4",children:i===v.id?u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-amber-700"}):u.jsx(bs,{className:"w-4 h-4"})}),i===v.id?"Uploading...":"Add MOM"]})}),u.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:v.mom_files.map((y,w)=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg hover:border-amber-300 transition-colors group",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"p-2 bg-amber-50 rounded-lg text-amber-600 group-hover:bg-amber-100 transition-colors",children:ku(y.name)}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",title:y.name,children:y.name}),u.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[u.jsx("span",{children:yi(y.size)}),y.uploadedAt&&u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx("span",{children:_u(y.uploadedAt)})]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-1 pl-2 border-l border-gray-100 ml-2",children:[u.jsx("button",{onClick:()=>p(y.path,y.name),className:"p-1.5 text-gray-400 hover:text-amber-600 hover:bg-amber-50 rounded-md transition-colors",title:"View file",children:u.jsx(Dl,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>x(y.path,y.name),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-md transition-colors",title:"Download file",children:u.jsx(Gi,{className:"w-4 h-4"})})]})]},w))})]}),(!v.mom_files||v.mom_files.length===0)&&u.jsx("p",{className:"text-sm text-gray-500 italic mt-4",children:"No MOM files uploaded yet."}),(!v.mom_files||v.mom_files.length===0)&&u.jsx("div",{className:"mt-2",children:u.jsxs("label",{className:`cursor-pointer inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-amber-700 bg-amber-50 hover:bg-amber-100 rounded-lg transition-colors ${i===v.id?"opacity-50 cursor-not-allowed":""}`,children:[u.jsx("input",{type:"file",className:"hidden",onChange:y=>h(y,v.id),disabled:i===v.id,accept:".pdf,.doc,.docx,.txt"}),u.jsx("div",{className:"w-4 h-4",children:i===v.id?u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-amber-700"}):u.jsx(bs,{className:"w-4 h-4"})}),i===v.id?"Uploading...":"Add MOM"]})})]})},v.id))})]})}function Qk({event:e,onClose:t,onReschedule:r,onDelete:n,user:a,onEventUpdated:s}){const[i,o]=Y.useState([]);if(!e)return null;const l=a.role==="manager"||a.role==="associate_editor",c=a.role==="manager",f=new Date,d=new Date(e.date),[h,x]=e.time.split(":").map(Number);d.setHours(h,x,0,0);const p=d<f,m=_=>{if(_.target.files){const A=Array.from(_.target.files);o([...i,...A])}},v=_=>{o(i.filter((A,b)=>b!==_))},y=async(_,A)=>{try{const{data:b,error:R}=await pe.storage.from("meeting-attachments").createSignedUrl(_,3600);if(R){console.error("Error getting file URL:",R),alert("Failed to load file. Please try again.");return}b!=null&&b.signedUrl&&window.open(b.signedUrl,"_blank")}catch(b){console.error("Error in handleViewAttachment:",b),alert("An error occurred. Please try again.")}},w=async(_,A)=>{try{const{data:b,error:R}=await pe.storage.from("meeting-attachments").download(_);if(R){console.error("Error downloading file:",R),alert("Failed to download file. Please try again.");return}if(b){const L=URL.createObjectURL(b),I=document.createElement("a");I.href=L,I.download=A,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(L)}}catch(b){console.error("Error in handleDownloadAttachment:",b),alert("An error occurred. Please try again.")}},g=async(_,A)=>{try{const{data:b,error:R}=await pe.storage.from("mom-files").createSignedUrl(_,3600);if(R){console.error("Error getting file URL:",R),alert("Failed to load file. Please try again.");return}b!=null&&b.signedUrl&&window.open(b.signedUrl,"_blank")}catch(b){console.error("Error in handleViewMOMFile:",b),alert("An error occurred. Please try again.")}},S=async(_,A)=>{try{const{data:b,error:R}=await pe.storage.from("mom-files").download(_);if(R){console.error("Error downloading file:",R),alert("Failed to download file. Please try again.");return}if(b){const L=URL.createObjectURL(b),I=document.createElement("a");I.href=L,I.download=A,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(L)}}catch(b){console.error("Error in handleDownloadMOMFile:",b),alert("An error occurred. Please try again.")}},k=async(_,A)=>{if(confirm(`Are you sure you want to delete "${A}"? This action cannot be undone.`))try{let b;const R=e.historyId;if(R){const{data:X,error:ee}=await pe.from("meeting_history").select("id, mom_files").eq("id",parseInt(R)).maybeSingle();if(ee)throw ee;b=X}else{const{data:X,error:ee}=await pe.from("meeting_history").select("id, mom_files").eq("original_event_id",parseInt(e.id)).maybeSingle();if(ee)throw ee;b=X}if(!b){alert("Meeting history not found.");return}const{error:L}=await pe.storage.from("mom-files").remove([_]);if(L){console.error("Error deleting file from storage:",L),alert("Failed to delete file from storage. Please try again.");return}const H=(b.mom_files||[]).filter(X=>X.path!==_),{error:Z}=await pe.from("meeting_history").update({mom_files:H}).eq("id",b.id);if(Z){console.error("Error updating history record:",Z),alert("Failed to update meeting history. Please try again.");return}alert("File deleted successfully!"),s(),t()}catch(b){console.error("Error in handleDeleteMOMFile:",b),alert("An error occurred. Please try again.")}},T=async()=>{if(!(!e||i.length===0))try{let _;const A=e.historyId;if(A){const{data:H,error:Z}=await pe.from("meeting_history").select("id, mom_files").eq("id",parseInt(A)).maybeSingle();if(Z)throw Z;_=H}else{const{data:H,error:Z}=await pe.from("meeting_history").select("id, mom_files").eq("original_event_id",parseInt(e.id)).maybeSingle();if(Z)throw Z;_=H}if(!_){alert("This meeting has not been moved to history yet.");return}const b=[];for(const H of i){const Z=H.name.split(".").pop(),ee=`${`${_.id}_${Date.now()}_${Math.random().toString(36).substring(7)}.${Z}`}`,{error:oe}=await pe.storage.from("mom-files").upload(ee,H,{cacheControl:"3600",upsert:!1});if(oe){console.error("Error uploading file:",oe),alert(`Failed to upload ${H.name}. Please try again.`);return}b.push({name:H.name,path:ee,size:H.size,uploadedAt:new Date().toISOString()})}const L=[..._.mom_files||[],...b],{error:I}=await pe.from("meeting_history").update({mom_files:L}).eq("id",_.id);if(I){console.error("Error updating history record:",I),alert("Failed to update meeting history. Please try again.");return}alert(`Successfully added ${i.length} file(s) to Minutes of Meeting!`),o([]),s(),t()}catch(_){console.error("Error in handleAddMOM:",_),alert("An error occurred. Please try again.")}};return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-6 bg-black bg-opacity-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Event Details"}),u.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:u.jsx(Pt,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"px-6 py-6 space-y-5",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-1",children:e.clientName}),u.jsx("p",{className:"text-sm text-gray-500",children:e.title})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Date"}),u.jsx("p",{className:"text-sm text-gray-900 mt-1",children:e.date.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Time"}),u.jsx("p",{className:"text-sm text-gray-900 mt-1",children:e.time})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Location"}),u.jsx("p",{className:"text-sm text-gray-900 mt-1",children:e.location})]}),e.isOnline&&e.meetingLink&&u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Meeting Link"}),u.jsxs("a",{href:e.meetingLink,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-amber-600 hover:text-amber-700 mt-1 group",children:[u.jsx(Ff,{className:"w-4 h-4"}),u.jsx("span",{className:"group-hover:underline",children:"Join online meeting"})]})]}),e.agenda&&u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Agenda"}),u.jsx("p",{className:"text-sm text-gray-900 mt-1 leading-relaxed",children:e.agenda})]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created by"}),u.jsx("p",{className:"text-sm text-gray-900 mt-1",children:e.created_by_name||"Not tracked"})]}),e.attachments&&e.attachments.length>0&&u.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Attachments (",e.attachments.length,")"]}),u.jsx("div",{className:"space-y-2",children:e.attachments.map((_,A)=>u.jsx("div",{className:"group bg-gray-50 border border-gray-200 rounded-lg p-3 hover:border-blue-300 hover:shadow-sm transition-all",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:ku(_.name)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:_.name}),u.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[u.jsx("span",{children:yi(_.size)}),u.jsx("span",{children:""}),u.jsx("span",{children:_u(_.uploadedAt)})]})]}),u.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[u.jsx("button",{onClick:()=>y(_.path,_.name),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"View file",children:u.jsx(Dl,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>w(_.path,_.name),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Download file",children:u.jsx(Gi,{className:"w-4 h-4"})})]})]})},A))})]}),p&&u.jsx("div",{className:"border-t border-gray-200 pt-4 space-y-4",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minutes of Meeting (MOM)"}),e.momFiles&&e.momFiles.length>0&&u.jsxs("div",{className:"space-y-3 mb-4",children:[u.jsxs("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[u.jsx(Gn,{className:"w-4 h-4"}),"Uploaded Files (",e.momFiles.length,")"]}),u.jsx("div",{className:"grid gap-3",children:e.momFiles.map((_,A)=>u.jsxs("div",{className:"group bg-white border-2 border-gray-200 rounded-xl p-4 hover:border-amber-300 hover:shadow-md transition-all duration-200",children:[u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"p-2.5 bg-amber-100 rounded-lg",children:ku(_.name)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h5",{className:"text-sm font-semibold text-gray-900 truncate mb-1",children:_.name}),u.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[u.jsx("span",{className:"flex items-center gap-1",children:u.jsx("span",{className:"font-medium",children:yi(_.size)})}),_.uploadedAt&&u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"text-gray-300",children:""}),u.jsx("span",{children:_u(_.uploadedAt)})]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-gray-100",children:[u.jsxs("button",{onClick:()=>g(_.path,_.name),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-amber-700 bg-amber-50 hover:bg-amber-100 rounded-lg transition-colors",title:"Open file",children:[u.jsx(Dl,{className:"w-4 h-4"}),"Open"]}),u.jsxs("button",{onClick:()=>S(_.path,_.name),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",title:"Download file",children:[u.jsx(Gi,{className:"w-4 h-4"}),"Download"]}),c&&u.jsx("button",{onClick:()=>k(_.path,_.name),className:"flex items-center justify-center px-3 py-2 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",title:"Delete file",children:u.jsx(Ns,{className:"w-4 h-4"})})]})]},A))})]}),l&&u.jsxs("div",{className:"space-y-3",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Add New Files"}),u.jsxs("label",{className:"flex flex-col items-center justify-center gap-2 px-6 py-8 text-sm font-medium text-gray-600 bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-dashed border-gray-300 rounded-xl hover:border-amber-400 hover:bg-amber-50/50 transition-all cursor-pointer group",children:[u.jsx("div",{className:"p-3 bg-white rounded-full shadow-sm group-hover:shadow-md transition-shadow",children:u.jsx(Pl,{className:"w-5 h-5 text-gray-400 group-hover:text-amber-600 transition-colors"})}),u.jsx("span",{className:"text-gray-700 group-hover:text-amber-700 transition-colors",children:"Click to upload or drag files here"}),u.jsx("span",{className:"text-xs text-gray-500",children:"PDF, DOC, DOCX, TXT, JPG, PNG (Max 10MB)"}),u.jsx("input",{type:"file",multiple:!0,onChange:m,className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png"})]}),i.length>0&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("p",{className:"text-xs font-medium text-gray-600",children:["Ready to upload (",i.length,")"]}),i.map((_,A)=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[u.jsx(Gn,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm text-gray-900 truncate font-medium",children:_.name}),u.jsx("p",{className:"text-xs text-gray-500",children:yi(_.size)})]})]}),u.jsx("button",{onClick:()=>v(A),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Remove file",children:u.jsx(Pt,{className:"w-4 h-4"})})]},A))]})]})]})})]})]}),u.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 flex items-center justify-end gap-3 border-t border-gray-200",children:p?l&&u.jsxs("button",{onClick:T,disabled:i.length===0,className:`flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${i.length===0?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-amber-600 hover:bg-amber-700"}`,children:[u.jsx(Gn,{className:"w-4 h-4"}),"Add MOM (",i.length,")"]}):u.jsxs(u.Fragment,{children:[l&&u.jsxs("button",{onClick:()=>r(e),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[u.jsx(va,{className:"w-4 h-4"}),"Reschedule"]}),c&&u.jsxs("button",{onClick:()=>n(e.id),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors",children:[u.jsx(Ns,{className:"w-4 h-4"}),"Delete Event"]})]})})]})})}function Oa(){return{logActivity:async(t,r,n,a,s)=>{if(t)try{const{error:i}=await pe.from("activity_log").insert({organisation_id:t.organisationId,user_id:t.id,username:t.username,action_type:r,table_name:n,record_id:a,new_data:s,created_at:new Date().toISOString()});i&&console.error("Error logging activity:",i)}catch(i){console.error("Error in logActivity:",i)}}}}function Zk({isOpen:e,onClose:t,onEventAdded:r,user:n,clients:a,onShowOAuth:s}){const[i,o]=Y.useState("online"),[l,c]=Y.useState(!1),[f,d]=Y.useState("30"),[h,x]=Y.useState([]),[p,m]=Y.useState(!1),[v,y]=Y.useState(""),[w,g]=Y.useState(""),[S,k]=Y.useState(""),[T,_]=Y.useState(""),[A,b]=Y.useState(!1),{logActivity:R}=Oa(),[L,I]=Y.useState(""),[H,Z]=Y.useState("");if(!e)return null;const X=q=>{if(q.target.files){const se=Array.from(q.target.files);x([...h,...se])}},ee=q=>{x(h.filter((se,j)=>j!==q))},oe=async()=>{b(!0);try{const q=v||"Meeting";let se="";w&&S&&(se=new Date(`${w}T${S}`).toISOString());const j={organisation_id:n.organisationId,title:q,start_time:se||void 0},z=await fetch("https://kudptumbipdlayxvvbhc.supabase.co/functions/v1/generate-meet-link",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1ZHB0dW1iaXBkbGF5eHZ2YmhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NTM5ODQsImV4cCI6MjA3NzEyOTk4NH0.d8ztlRXIiAdVZ0m1neC55c7rhB0qJoA9qy75rNak5RY","Content-Type":"application/json"},body:JSON.stringify(j)}),M=await z.json();if(z.ok)_(M.meetLink);else if(M.needsAuth)s();else throw console.error("Edge function error:",M),new Error(M.error||"Failed to generate meeting link")}catch(q){console.error("Error generating meeting link:",q),alert("Failed to generate meeting link. Please try again or enter one manually.")}finally{b(!1)}},te=async q=>{q.preventDefault(),m(!0);const se=new FormData(q.currentTarget),j=se.get("alertType"),z=se.get("repeatEvent")==="on",M={name:v,client_name:v,meeting_type:i,is_online:i==="online"||i==="on_call",start_date:w,start_time:S,location:i==="online"?"Online":i==="on_call"?"On Call":se.get("location"),agenda:se.get("agenda"),meeting_link:i==="online"?T:null,repeat_event:z,alert_type:j||"none",reminder_minutes:j==="remind"?parseInt(f):30,meeting_mode:i==="online"?"video":i==="on_call"?"audio":null,organisation_id:n.organisationId,created_by_id:n.id,created_by_name:n.fullName,client_email:L||null,hosts_emails:H||null};console.log("Attempting to insert meeting with data:",M);const{data:B,error:J}=await pe.from("Meet Schedule Data").insert([M]).select().maybeSingle();if(J){console.error("Error adding event:",J),console.error("Error details:",JSON.stringify(J,null,2)),alert(`Failed to add event: ${J.message||"Please try again."}`),m(!1);return}if(B){if(h.length>0){const ie=[];for(const ue of h){const ce=ue.name.split(".").pop(),re=Math.random().toString(36).substring(2,15),Se=`${n.organisationId}/${B.id}_${Date.now()}_${re}.${ce}`,{error:P}=await pe.storage.from("meeting-attachments").upload(Se,ue);if(P){console.error("Error uploading attachment:",P),alert(`Failed to upload ${ue.name}. Please try again.`);continue}ie.push({name:ue.name,path:Se,size:ue.size,uploadedAt:new Date().toISOString()})}if(ie.length>0){const{error:ue}=await pe.from("Meet Schedule Data").update({attachments:ie}).eq("id",B.id);ue&&console.error("Error updating event with attachments:",ue)}}r(),R(n,"create","Meet Schedule Data",B.id,{name:v,meetingType:i,startDate:w,startTime:S})}U()},U=()=>{t(),o("online"),c(!1),d("30"),x([]),y(""),g(""),k(""),_(""),m(!1)};return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-6 bg-black bg-opacity-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Schedule New Meeting"}),u.jsx("button",{onClick:U,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:u.jsx(Pt,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:te,className:"px-6 py-6 space-y-5",children:[u.jsxs("div",{className:"flex gap-4 mb-4",children:[u.jsxs("button",{type:"button",onClick:()=>o("online"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg border text-sm font-medium transition-colors ${i==="online"?"bg-amber-50 border-amber-500 text-amber-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[u.jsx(f2,{className:"w-4 h-4"}),"Online"]}),u.jsxs("button",{type:"button",onClick:()=>o("facetoface"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg border text-sm font-medium transition-colors ${i==="facetoface"?"bg-amber-50 border-amber-500 text-amber-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[u.jsx(fc,{className:"w-4 h-4"}),"Face to Face"]}),u.jsxs("button",{type:"button",onClick:()=>o("on_call"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg border text-sm font-medium transition-colors ${i==="on_call"?"bg-amber-50 border-amber-500 text-amber-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[u.jsx(g2,{className:"w-4 h-4"}),"On Call"]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Name"}),u.jsx("input",{type:"text",name:"name",id:"name",list:"clientsList",required:!0,value:v,onChange:q=>y(q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Select or enter client name"}),u.jsx("datalist",{id:"clientsList",children:a.map(q=>u.jsx("option",{value:q.name},q.id))})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"clientEmail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mail Client"}),u.jsx("input",{type:"email",name:"clientEmail",id:"clientEmail",value:L,onChange:q=>I(q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"client@example.com"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"hostsEmail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mail Hosts / Co-hosts"}),u.jsx("input",{type:"email",name:"hostsEmail",id:"hostsEmail",value:H,onChange:q=>Z(q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"host@example.com, cohost@example.com"}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Separate multiple emails with commas"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),u.jsx("input",{type:"date",name:"startDate",id:"startDate",required:!0,value:w,onChange:q=>g(q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"startTime",className:"block text-sm font-medium text-gray-700 mb-2",children:"Time"}),u.jsx("input",{type:"time",name:"startTime",id:"startTime",required:!0,value:S,onChange:q=>k(q.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]})]}),i==="online"&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Link"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ff,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"url",name:"meetingLink",value:T,onChange:q=>_(q.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"https://meet.google.com/..."})]}),u.jsxs("button",{type:"button",onClick:oe,disabled:A,className:"px-4 py-2 bg-blue-50 text-blue-600 rounded-lg text-sm font-medium hover:bg-blue-100 transition-colors flex items-center gap-2 disabled:opacity-50",children:[A?u.jsx(cu,{className:"w-4 h-4 animate-spin"}):u.jsx(xs,{className:"w-4 h-4"}),"Generate"]})]}),u.jsx("p",{className:"text-xs text-gray-500",children:"Click generate to create a Google Meet link. Requires Google account connection."})]})]}),i==="facetoface"&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),u.jsx("input",{type:"text",name:"location",id:"location",required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Enter meeting location"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"alertType",className:"block text-sm font-medium text-gray-700 mb-2",children:"Alert Type"}),u.jsxs("select",{name:"alertType",id:"alertType",onChange:q=>c(q.target.value==="remind"),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[u.jsx("option",{value:"none",children:"No Alert"}),u.jsx("option",{value:"notify",children:"Just Notify"}),u.jsx("option",{value:"remind",children:"Remind Before"})]})]}),l&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"reminderMinutes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reminder Time (minutes before)"}),u.jsx("input",{type:"number",id:"reminderMinutes",value:f,onChange:q=>d(q.target.value),min:"5",step:"5",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"agenda",className:"block text-sm font-medium text-gray-700 mb-2",children:"Agenda"}),u.jsx("textarea",{name:"agenda",id:"agenda",rows:3,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none",placeholder:"Meeting agenda..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attachments"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("label",{className:"flex flex-col items-center justify-center gap-2 px-6 py-4 text-sm font-medium text-gray-600 bg-gray-50 border-2 border-dashed border-gray-300 rounded-xl hover:border-amber-400 hover:bg-amber-50/50 transition-all cursor-pointer group",children:[u.jsx("div",{className:"p-2 bg-white rounded-full shadow-sm group-hover:shadow-md transition-shadow",children:u.jsx(Pl,{className:"w-4 h-4 text-gray-400 group-hover:text-amber-600 transition-colors"})}),u.jsx("span",{className:"text-gray-700 group-hover:text-amber-700 transition-colors",children:"Upload files"}),u.jsx("input",{type:"file",multiple:!0,onChange:X,className:"hidden"})]}),h.length>0&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("p",{className:"text-xs font-medium text-gray-600",children:["Selected files (",h.length,")"]}),h.map((q,se)=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[u.jsx(Gn,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm text-gray-900 truncate font-medium",children:q.name}),u.jsx("p",{className:"text-xs text-gray-500",children:yi(q.size)})]})]}),u.jsx("button",{type:"button",onClick:()=>ee(se),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",children:u.jsx(Pt,{className:"w-4 h-4"})})]},se))]})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[u.jsx("button",{type:"button",onClick:U,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:p,className:"px-4 py-2 text-sm font-medium text-white bg-amber-500 rounded-lg hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Scheduling...":"Schedule Meeting"})]})]})]})})}function eE({isOpen:e,onClose:t,event:r,onEventUpdated:n,user:a}){const[s,i]=Y.useState(""),[o,l]=Y.useState(""),[c,f]=Y.useState(!1),{logActivity:d}=Oa();if(!e||!r)return null;const h=async x=>{if(x.preventDefault(),!s||!o){alert("Please select both date and time.");return}f(!0);const{error:p}=await pe.from("Meet Schedule Data").update({start_date:s,start_time:o}).eq("id",r.id);if(p){console.error("Error rescheduling event:",p),alert("Failed to reschedule event. Please try again."),f(!1);return}n(),d(a,"update","Meet Schedule Data",r.id,{oldDate:r.date,oldTime:r.time,newDate:s,newTime:o}),t(),i(""),l(""),f(!1)};return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-6 bg-black bg-opacity-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-sm w-full",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Reschedule Event"}),u.jsx("button",{onClick:()=>{t(),i(""),l("")},className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:u.jsx(Pt,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"rescheduleDate",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Date"}),u.jsx("input",{type:"date",id:"rescheduleDate",value:s,onChange:x=>i(x.target.value),required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"rescheduleTime",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Time"}),u.jsx("input",{type:"time",id:"rescheduleTime",value:o,onChange:x=>l(x.target.value),required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[u.jsx("button",{type:"button",onClick:()=>{t(),i(""),l("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 text-sm font-medium text-white bg-amber-500 rounded-lg hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Updating...":"Update Schedule"})]})]})]})})}function tE({isOpen:e,onClose:t,payment:r,user:n,clients:a,onPaymentUpdated:s}){const[i,o]=Y.useState([""]),[l,c]=Y.useState([""]),[f,d]=Y.useState("one-time"),[h,x]=Y.useState(!1);if(Y.useEffect(()=>{r?(o(r.due_dates||[""]),c(r.amounts?r.amounts.map(String):[String(r.amount)]),d(r.frequency)):(o([""]),c([""]),d("one-time"))},[r,e]),!e)return null;const p=!!r,m=()=>{o([...i,""]),(f==="quarterly"||f==="half-yearly")&&c([...l,""])},v=k=>{i.length>1&&(o(i.filter((T,_)=>_!==k)),(f==="quarterly"||f==="half-yearly")&&c(l.filter((T,_)=>_!==k)))},y=(k,T)=>{const _=[...i];_[k]=T,o(_)},w=(k,T)=>{const _=[...l];_[k]=T,c(_)},g=k=>{const T=k.target.value;d(T),T==="quarterly"?(o(Array(4).fill("")),c(Array(4).fill(""))):T==="half-yearly"?(o(Array(2).fill("")),c(Array(2).fill(""))):(o([""]),c([""]))},S=async k=>{var Z;k.preventDefault(),x(!0);const T=k.currentTarget,_=T.elements.namedItem("clientName").value,A=T.elements.namedItem("frequency").value,b=T.elements.namedItem("paymentMethod").value,R=((Z=T.elements.namedItem("comments"))==null?void 0:Z.value)||null,L=i.filter(X=>X!=="");if(L.length===0){alert("Please add at least one due date."),x(!1);return}let I=[],H=0;if(A==="quarterly"||A==="half-yearly"){const X=l.filter(ee=>ee!=="").map(ee=>parseFloat(ee));if(X.length!==L.length){alert("Please enter an amount for each due date."),x(!1);return}I=X,H=X[0]}else{const X=T.elements.namedItem("amount");H=parseFloat(X.value),I=[H]}if(p&&r){const{error:X}=await pe.from("payments").update({client_name:_,amount:H,amounts:I,due_dates:L,frequency:A,payment_method:b,comments:R}).eq("id",r.id);if(X){console.error("Error updating payment:",X),alert("Failed to update payment. Please try again."),x(!1);return}}else{const{error:X}=await pe.from("payments").insert({client_name:_,amount:H,amounts:I,due_dates:L,frequency:A,payment_method:b,organisation_id:n.organisationId,created_by_id:n.id,created_by_name:n.fullName,comments:R});if(X){console.error("Error adding payment:",X),alert("Failed to add payment. Please try again."),x(!1);return}}s(),t(),x(!1),p||(o([""]),c([""]),d("one-time"))};return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-6 bg-black bg-opacity-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:p?"Modify Payment":"Schedule Payment"}),u.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:u.jsx(Pt,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:S,className:"px-6 py-6 space-y-5",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"clientName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client's Name"}),u.jsx("input",{type:"text",id:"clientName",name:"clientName",list:"clientsListPayment",defaultValue:r==null?void 0:r.client_name,required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Select or enter client name"}),u.jsx("datalist",{id:"clientsListPayment",children:a.map(k=>u.jsx("option",{value:k.name},k.id))})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"frequency",className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency"}),u.jsxs("select",{id:"frequency",name:"frequency",value:f,onChange:g,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[u.jsx("option",{value:"one-time",children:"One-time"}),u.jsx("option",{value:"quarterly",children:"Quarterly"}),u.jsx("option",{value:"half-yearly",children:"Half Yearly"}),u.jsx("option",{value:"annual",children:"Annual"})]})]}),(f==="one-time"||f==="annual")&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount (INR)"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ts,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"number",id:"amount",name:"amount",defaultValue:r==null?void 0:r.amount,required:!0,step:"0.01",min:"0",className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"0.00"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:f==="quarterly"||f==="half-yearly"?"Due Dates & Amounts":"Due Dates"}),u.jsxs("div",{className:"space-y-2",children:[i.map((k,T)=>u.jsxs("div",{className:"flex items-center gap-2",children:[(f==="quarterly"||f==="half-yearly")&&u.jsxs("div",{className:"relative flex-1",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(Ts,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"number",value:l[T]||"",onChange:_=>w(T,_.target.value),required:!0,step:"0.01",min:"0",placeholder:"Amount",className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),u.jsx("input",{type:"date",value:k,onChange:_=>y(T,_.target.value),required:!0,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"}),i.length>1&&f!=="quarterly"&&f!=="half-yearly"&&u.jsx("button",{type:"button",onClick:()=>v(T),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors","aria-label":"Remove due date",children:u.jsx(Pt,{className:"w-4 h-4"})})]},T)),f!=="quarterly"&&f!=="half-yearly"&&u.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",children:[u.jsx(bs,{className:"w-4 h-4"}),"Add Another Due Date"]})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"paymentMethod",className:"block text-sm font-medium text-gray-700 mb-2",children:"Paid Via"}),u.jsxs("select",{id:"paymentMethod",name:"paymentMethod",defaultValue:r==null?void 0:r.payment_method,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[u.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),u.jsx("option",{value:"cash",children:"Cash"}),u.jsx("option",{value:"upi",children:"UPI"})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"comments",className:"block text-sm font-medium text-gray-700 mb-2",children:"Comments"}),u.jsx("textarea",{id:"comments",name:"comments",defaultValue:(r==null?void 0:r.comments)||"",rows:3,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent resize-none",placeholder:"Add any comments..."})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 text-sm font-medium text-white bg-emerald-500 rounded-lg hover:bg-emerald-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Saving...":p?"Update Payment":"Schedule Payment"})]})]})]})})}function rE({isOpen:e,onClose:t,user:r,onClientAdded:n}){const[a,s]=Y.useState(!1),{logActivity:i}=Oa();if(!e)return null;const o=async l=>{l.preventDefault(),s(!0);const c=l.currentTarget,f=c.elements.namedItem("name").value,d=c.elements.namedItem("type").value,{error:h}=await pe.from("clients").insert({name:f,type:d,organisation_id:r.organisationId});if(h){console.error("Error adding client:",h),alert("Failed to add client. Please try again."),s(!1);return}n(),i(r,"create","clients","",{name:f,type:d}),t(),s(!1)};return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-6 bg-black bg-opacity-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-sm w-full",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Client"}),u.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:u.jsx(Pt,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Name"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(u1,{className:"h-4 w-4 text-gray-400"})}),u.jsx("input",{type:"text",id:"name",name:"name",required:!0,className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",placeholder:"Enter client name"})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 mb-2",children:"Client Type"}),u.jsxs("select",{id:"type",name:"type",required:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[u.jsx("option",{value:"holistic",children:"Holistic"}),u.jsx("option",{value:"mutual_funds",children:"Mutual Funds"})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:a,className:"px-4 py-2 text-sm font-medium text-white bg-amber-500 rounded-lg hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Adding...":"Add Client"})]})]})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var L1=1252,nE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Rf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Lf=function(e){nE.indexOf(e)!=-1&&(L1=Rf[0]=e)};function aE(){Lf(1252)}var Lr=function(e){Lf(e)};function M1(){Lr(1200),aE()}function Hh(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function sE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function B1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ni=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?sE(e.slice(2)):t==254&&r==255?B1(e.slice(2)):t==65279?e.slice(1):e},Uo=function(t){return String.fromCharCode(t)},zh=function(t){return String.fromCharCode(t)},On,Rn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vh(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Rn.charAt(s)+Rn.charAt(i)+Rn.charAt(o)+Rn.charAt(l);return t}function ur(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Rn.indexOf(e.charAt(c++)),i=Rn.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Rn.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Rn.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Ae=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Da=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Yn(e){return Ae?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Wh(e){return Ae?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Rr=function(t){return Ae?Da(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Pa(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Mf(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Mf(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Dn=Ae?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Da(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function iE(e){for(var t=[],r=0,n=e.length+250,a=Yn(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Yn(65535),n=65530)}return t.push(a.slice(0,r)),Dn(t)}var Vt=/\u0000/g,ai=/[\u0001-\u0006]/g;function ms(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Mr(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}function Bf(e,t){var r=""+e;return r.length>=t?r:Je(" ",t-r.length)+r}function Ml(e,t){var r=""+e;return r.length>=t?r:r+Je(" ",t-r.length)}function oE(e,t){var r=""+Math.round(e);return r.length>=t?r:Je("0",t-r.length)+r}function lE(e,t){var r=""+e;return r.length>=t?r:Je("0",t-r.length)+r}var Gh=Math.pow(2,32);function Wa(e,t){if(e>Gh||e<-Gh)return oE(e,t);var r=Math.round(e);return lE(r,t)}function Bl(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Kh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],a0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},qh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},uE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ul(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,f=0,d=Math.floor(a);c<t&&(d=Math.floor(a),o=d*i+s,f=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=s):(f=c,o=i)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function ma(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=pE(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var U1=new Date(1899,11,31,0,0,0),fE=U1.getTime(),dE=new Date(1900,2,1,0,0,0);function $1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=dE&&(r+=24*60*60*1e3),(r-(fE+(e.getTimezoneOffset()-U1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Uf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hE(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xE(e){var t=e<0?12:11,r=Uf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function mE(e){var t=Uf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function qi(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=xE(e):t===10?r=e.toFixed(10).substr(0,12):r=mE(e),Uf(hE(r.toUpperCase()))}function ba(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):qi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return br(14,$1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function pE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function gE(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return a0[r.m-1][1];case 5:return a0[r.m-1][0];default:return a0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Kh[r.q][0];default:return Kh[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Mr(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Mr(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Mr(l,c):"";return f}function Ln(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var H1=/%/g;function vE(e,t,r){var n=t.replace(H1,""),a=t.length-n.length;return dn(e,n,r*Math.pow(10,2*a))+Je("%",a)}function yE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return dn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function z1(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+z1(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var V1=/# (\?+)( ?)\/( ?)(\d+)/;function wE(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Je(" ",e[1].length+1+e[4].length):Bf(i,e[1].length)+e[2]+"/"+e[3]+Mr(o,e[4].length))}function _E(e,t,r){return r+(t===0?"":""+t)+Je(" ",e[1].length+2+e[4].length)}var W1=/^#*0*\.([0#]+)/,G1=/\).*[0#]/,K1=/\(###\) ###\\?-####/;function Ut(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Xh(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Yh(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function kE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function EE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(G1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gr("n",n,r):"("+gr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return yE(e,t,r);if(t.indexOf("%")!==-1)return vE(e,t,r);if(t.indexOf("E")!==-1)return z1(t,r);if(t.charCodeAt(0)===36)return"$"+gr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Wa(l,t.length);if(t.match(/^[#?]+$/))return a=Wa(r,0),a==="0"&&(a=""),a.length>t.length?a:Ut(t.substr(0,t.length-a.length))+a;if(s=t.match(V1))return wE(s,l,c);if(t.match(/^#+0+$/))return c+Wa(l,t.length-t.indexOf("0"));if(s=t.match(W1))return a=Xh(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ut(s[1])).replace(/\.$/,"."+Ut(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+Je("0",Ut(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Xh(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Ln(Wa(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gr(e,t,-r):Ln(""+(Math.floor(r)+kE(r,s[1].length)))+"."+Mr(Yh(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return gr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ms(gr(e,t.replace(/[\\-]/g,""),r)),i=0,ms(ms(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(t.match(K1))return a=gr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Ul(l,Math.pow(10,i)-1,!1),a=""+c,f=dn("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=Ml(o[2],i),f.length<s[4].length&&(f=Ut(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Ul(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bf(o[1],i)+s[2]+"/"+s[3]+Ml(o[2],i):Je(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Wa(r,0),t.length<=a.length?a:Ut(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Ut(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Yh(r,s[1].length),r<0?"-"+gr(e,t,-r):Ln(EE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Mr(0,3-p.length):"")+p})+"."+Mr(i,s[1].length);switch(t){case"###,##0.00":return gr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Ln(Wa(l,0));return x!=="0"?c+x:"";case"###,###.00":return gr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return gr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function SE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return dn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function TE(e,t,r){var n=t.replace(H1,""),a=t.length-n.length;return dn(e,n,r*Math.pow(10,2*a))+Je("%",a)}function q1(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+q1(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Gr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(G1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Gr("n",n,r):"("+Gr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return SE(e,t,r);if(t.indexOf("%")!==-1)return TE(e,t,r);if(t.indexOf("E")!==-1)return q1(t,r);if(t.charCodeAt(0)===36)return"$"+Gr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Mr(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Ut(t.substr(0,t.length-a.length))+a;if(s=t.match(V1))return _E(s,l,c);if(t.match(/^#+0+$/))return c+Mr(l,t.length-t.indexOf("0"));if(s=t.match(W1))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Ut(s[1])).replace(/\.$/,"."+Ut(s[1])),a=a.replace(/\.(\d*)$/,function(p,m){return"."+m+Je("0",Ut(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Ln(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Gr(e,t,-r):Ln(""+r)+"."+Je("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Gr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ms(Gr(e,t.replace(/[\\-]/g,""),r)),i=0,ms(ms(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(t.match(K1))return a=Gr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Ul(l,Math.pow(10,i)-1,!1),a=""+c,f=dn("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=Ml(o[2],i),f.length<s[4].length&&(f=Ut(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Ul(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bf(o[1],i)+s[2]+"/"+s[3]+Ml(o[2],i):Je(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Ut(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Ut(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Gr(e,t,-r):Ln(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Mr(0,3-p.length):"")+p})+"."+Mr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Ln(""+l);return x!=="0"?c+x:"";default:if(t.match(/\.[0#?]*$/))return Gr(e,t.slice(0,t.lastIndexOf(".")),r)+Ut(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function dn(e,t,r){return(r|0)===r?Gr(e,t,r):gr(e,t,r)}function bE(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var X1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Rs(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Bl(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(X1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function NE(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Bl(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var x=e.charAt(++i),p=x==="("||x===")"?x:"t";a[a.length]={t:p,v:x},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=ma(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ma(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=ma(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",i+=5,h="h"):(m.t="t",++i),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(X1)){if(c==null&&(c=ma(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Rs(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var v=0,y=0,w;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",v<1&&(v=1);break;case"s":(w=a[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[i].v.match(/[Hh]/)&&(v=1),v<2&&a[i].v.match(/[Mm]/)&&(v=2),v<3&&a[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",S;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=gE(a[i].t.charCodeAt(0),a[i].v,c,y),a[i].t="t";break;case"n":case"?":for(S=i+1;a[S]!=null&&((o=a[S].t)==="?"||o==="D"||(o===" "||o==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[i].v+=a[S].v,a[S]={v:"",t:";"},++S;g+=a[i].v,i=S-1;break;case"G":a[i].t="t",a[i].v=ba(t,r);break}var k="",T,_;if(g.length>0){g.charCodeAt(0)==40?(T=t<0&&g.charCodeAt(0)===45?-t:t,_=dn("n",g,T)):(T=t<0&&n>1?-t:t,_=dn("n",g,T),T<0&&a[0]&&a[0].t=="t"&&(_=_.substr(1),a[0].v="-"+a[0].v)),S=_.length-1;var A=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){A=i;break}var b=a.length;if(A===a.length&&_.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(S>=a[i].v.length-1?(S-=a[i].v.length,a[i].v=_.substr(S+1,a[i].v.length)):S<0?a[i].v="":(a[i].v=_.substr(0,S+1),S=-1),a[i].t="t",b=i);S>=0&&b<a.length&&(a[b].v=_.substr(0,S+1)+a[b].v)}else if(A!==a.length&&_.indexOf("E")===-1){for(S=_.indexOf(".")-1,i=A;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===A?a[i].v.indexOf(".")-1:a[i].v.length-1,k=a[i].v.substr(f+1);f>=0;--f)S>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(k=_.charAt(S--)+k);a[i].v=k,a[i].t="t",b=i}for(S>=0&&b<a.length&&(a[b].v=_.substr(0,S+1)+a[b].v),S=_.indexOf(".")+1,i=A;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==A)){for(f=a[i].v.indexOf(".")>-1&&i===A?a[i].v.indexOf(".")+1:0,k=a[i].v.substr(0,f);f<a[i].v.length;++f)S<_.length&&(k+=_.charAt(S++));a[i].v=k,a[i].t="t",b=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(T=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=dn(a[i].t,a[i].v,T),a[i].t="t");var R="";for(i=0;i!==a.length;++i)a[i]!=null&&(R+=a[i].v);return R}var Jh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Qh(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function CE(e,t){var r=bE(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Jh),o=r[1].match(Jh);return Qh(t,i)?[n,r[0]]:Qh(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function br(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ke)[e],n==null&&(n=r.table&&r.table[qh[e]]||ke[qh[e]]),n==null&&(n=uE[e]||"General");break}if(Bl(n,0))return ba(t,r);t instanceof Date&&(t=$1(t,r.date1904));var a=CE(n,t);if(Bl(a[1]))return ba(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return NE(a[1],t,r,a[0])}function ya(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ke[r]==null){t<0&&(t=r);continue}if(ke[r]==e){t=r;break}}t<0&&(t=391)}return ke[t]=e,t}function Y1(){ke=cE()}var AE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},J1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function FE(e){var t=typeof e=="number"?ke[e]:e;return t=t.replace(J1,"(\\d+)"),new RegExp("^"+t+"$")}function jE(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(J1)||[]).forEach(function(d,h){var x=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=x;break;case"d":s=x;break;case"h":i=x;break;case"s":l=x;break;case"m":i>=0?o=x:a=x;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?f:c+"T"+f}var OE=function(){var e={};e.version="1.2.0";function t(){for(var _=0,A=new Array(256),b=0;b!=256;++b)_=b,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,A[b]=_;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(_){var A=0,b=0,R=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)L[R]=_[R];for(R=0;R!=256;++R)for(b=_[R],A=256+R;A<4096;A+=256)b=L[A]=b>>>8^_[b&255];var I=[];for(R=1;R!=16;++R)I[R-1]=typeof Int32Array<"u"?L.subarray(R*256,R*256+256):L.slice(R*256,R*256+256);return I}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],f=a[5],d=a[6],h=a[7],x=a[8],p=a[9],m=a[10],v=a[11],y=a[12],w=a[13],g=a[14];function S(_,A){for(var b=A^-1,R=0,L=_.length;R<L;)b=b>>>8^r[(b^_.charCodeAt(R++))&255];return~b}function k(_,A){for(var b=A^-1,R=_.length-15,L=0;L<R;)b=g[_[L++]^b&255]^w[_[L++]^b>>8&255]^y[_[L++]^b>>16&255]^v[_[L++]^b>>>24]^m[_[L++]]^p[_[L++]]^x[_[L++]]^h[_[L++]]^d[_[L++]]^f[_[L++]]^c[_[L++]]^l[_[L++]]^o[_[L++]]^i[_[L++]]^s[_[L++]]^r[_[L++]];for(R+=15;L<R;)b=b>>>8^r[(b^_[L++])&255];return~b}function T(_,A){for(var b=A^-1,R=0,L=_.length,I=0,H=0;R<L;)I=_.charCodeAt(R++),I<128?b=b>>>8^r[(b^I)&255]:I<2048?(b=b>>>8^r[(b^(192|I>>6&31))&255],b=b>>>8^r[(b^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,H=_.charCodeAt(R++)&1023,b=b>>>8^r[(b^(240|I>>8&7))&255],b=b>>>8^r[(b^(128|I>>2&63))&255],b=b>>>8^r[(b^(128|H>>6&15|(I&3)<<4))&255],b=b>>>8^r[(b^(128|H&63))&255]):(b=b>>>8^r[(b^(224|I>>12&15))&255],b=b>>>8^r[(b^(128|I>>6&63))&255],b=b>>>8^r[(b^(128|I&63))&255]);return~b}return e.table=r,e.bstr=S,e.buf=k,e.str=T,e}(),Fe=function(){var t={};t.version="1.2.1";function r(E,F){for(var N=E.split("/"),C=F.split("/"),O=0,D=0,W=Math.min(N.length,C.length);O<W;++O){if(D=N[O].length-C[O].length)return D;if(N[O]!=C[O])return N[O]<C[O]?-1:1}return N.length-C.length}function n(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:n(E.slice(0,-1));var F=E.lastIndexOf("/");return F===-1?E:E.slice(0,F+1)}function a(E){if(E.charAt(E.length-1)=="/")return a(E.slice(0,-1));var F=E.lastIndexOf("/");return F===-1?E:E.slice(F+1)}function s(E,F){typeof F=="string"&&(F=new Date(F));var N=F.getHours();N=N<<6|F.getMinutes(),N=N<<5|F.getSeconds()>>>1,E.write_shift(2,N);var C=F.getFullYear()-1980;C=C<<4|F.getMonth()+1,C=C<<5|F.getDate(),E.write_shift(2,C)}function i(E){var F=E.read_shift(2)&65535,N=E.read_shift(2)&65535,C=new Date,O=N&31;N>>>=5;var D=N&15;N>>>=4,C.setMilliseconds(0),C.setFullYear(N+1980),C.setMonth(D-1),C.setDate(O);var W=F&31;F>>>=5;var Q=F&63;return F>>>=6,C.setHours(F),C.setMinutes(Q),C.setSeconds(W<<1),C}function o(E){yt(E,0);for(var F={},N=0;E.l<=E.length-4;){var C=E.read_shift(2),O=E.read_shift(2),D=E.l+O,W={};switch(C){case 21589:N=E.read_shift(1),N&1&&(W.mtime=E.read_shift(4)),O>5&&(N&2&&(W.atime=E.read_shift(4)),N&4&&(W.ctime=E.read_shift(4))),W.mtime&&(W.mt=new Date(W.mtime*1e3));break}E.l=D,F[C]=W}return F}var l;function c(){return l||(l={})}function f(E,F){if(E[0]==80&&E[1]==75)return dd(E,F);if((E[0]|32)==109&&(E[1]|32)==105)return bv(E,F);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var N=3,C=512,O=0,D=0,W=0,Q=0,V=0,G=[],K=E.slice(0,512);yt(K,0);var ne=d(K);switch(N=ne[0],N){case 3:C=512;break;case 4:C=4096;break;case 0:if(ne[1]==0)return dd(E,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}C!==512&&(K=E.slice(0,C),yt(K,28));var fe=E.slice(0,C);h(K,N);var xe=K.read_shift(4,"i");if(N===3&&xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xe);K.l+=4,W=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),Q=K.read_shift(4,"i"),O=K.read_shift(4,"i"),V=K.read_shift(4,"i"),D=K.read_shift(4,"i");for(var le=-1,he=0;he<109&&(le=K.read_shift(4,"i"),!(le<0));++he)G[he]=le;var ye=x(E,C);v(V,D,ye,C,G);var We=w(ye,W,G,C);We[W].name="!Directory",O>0&&Q!==H&&(We[Q].name="!MiniFAT"),We[G[0]].name="!FAT",We.fat_addrs=G,We.ssz=C;var Ge={},St=[],Us=[],$s=[];g(W,We,ye,St,O,Ge,Us,Q),p(Us,$s,St),St.shift();var Hs={FileIndex:Us,FullPaths:$s};return F&&F.raw&&(Hs.raw={header:fe,sectors:ye}),Hs}function d(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(Z,"Header Signature: "),E.l+=16;var F=E.read_shift(2,"u");return[E.read_shift(2,"u"),F]}function h(E,F){var N=9;switch(E.l+=2,N=E.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function x(E,F){for(var N=Math.ceil(E.length/F)-1,C=[],O=1;O<N;++O)C[O-1]=E.slice(O*F,(O+1)*F);return C[N-1]=E.slice(N*F),C}function p(E,F,N){for(var C=0,O=0,D=0,W=0,Q=0,V=N.length,G=[],K=[];C<V;++C)G[C]=K[C]=C,F[C]=N[C];for(;Q<K.length;++Q)C=K[Q],O=E[C].L,D=E[C].R,W=E[C].C,G[C]===C&&(O!==-1&&G[O]!==O&&(G[C]=G[O]),D!==-1&&G[D]!==D&&(G[C]=G[D])),W!==-1&&(G[W]=C),O!==-1&&C!=G[C]&&(G[O]=G[C],K.lastIndexOf(O)<Q&&K.push(O)),D!==-1&&C!=G[C]&&(G[D]=G[C],K.lastIndexOf(D)<Q&&K.push(D));for(C=1;C<V;++C)G[C]===C&&(D!==-1&&G[D]!==D?G[C]=G[D]:O!==-1&&G[O]!==O&&(G[C]=G[O]));for(C=1;C<V;++C)if(E[C].type!==0){if(Q=C,Q!=G[Q])do Q=G[Q],F[C]=F[Q]+"/"+F[C];while(Q!==0&&G[Q]!==-1&&Q!=G[Q]);G[C]=-1}for(F[0]+="/",C=1;C<V;++C)E[C].type!==2&&(F[C]+="/")}function m(E,F,N){for(var C=E.start,O=E.size,D=[],W=C;N&&O>0&&W>=0;)D.push(F.slice(W*I,W*I+I)),O-=I,W=fa(N,W*4);return D.length===0?ct(0):Dn(D).slice(0,E.size)}function v(E,F,N,C,O){var D=H;if(E===H){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var W=N[E],Q=(C>>>2)-1;if(!W)return;for(var V=0;V<Q&&(D=fa(W,V*4))!==H;++V)O.push(D);v(fa(W,C-4),F-1,N,C,O)}}function y(E,F,N,C,O){var D=[],W=[];O||(O=[]);var Q=C-1,V=0,G=0;for(V=F;V>=0;){O[V]=!0,D[D.length]=V,W.push(E[V]);var K=N[Math.floor(V*4/C)];if(G=V*4&Q,C<4+G)throw new Error("FAT boundary crossed: "+V+" 4 "+C);if(!E[K])break;V=fa(E[K],G)}return{nodes:D,data:lx([W])}}function w(E,F,N,C){var O=E.length,D=[],W=[],Q=[],V=[],G=C-1,K=0,ne=0,fe=0,xe=0;for(K=0;K<O;++K)if(Q=[],fe=K+F,fe>=O&&(fe-=O),!W[fe]){V=[];var le=[];for(ne=fe;ne>=0;){le[ne]=!0,W[ne]=!0,Q[Q.length]=ne,V.push(E[ne]);var he=N[Math.floor(ne*4/C)];if(xe=ne*4&G,C<4+xe)throw new Error("FAT boundary crossed: "+ne+" 4 "+C);if(!E[he]||(ne=fa(E[he],xe),le[ne]))break}D[fe]={nodes:Q,data:lx([V])}}return D}function g(E,F,N,C,O,D,W,Q){for(var V=0,G=C.length?2:0,K=F[E].data,ne=0,fe=0,xe;ne<K.length;ne+=128){var le=K.slice(ne,ne+128);yt(le,64),fe=le.read_shift(2),xe=Wf(le,0,fe-G),C.push(xe);var he={name:xe,type:le.read_shift(1),color:le.read_shift(1),L:le.read_shift(4,"i"),R:le.read_shift(4,"i"),C:le.read_shift(4,"i"),clsid:le.read_shift(16),state:le.read_shift(4,"i"),start:0,size:0},ye=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);ye!==0&&(he.ct=S(le,le.l-8));var We=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);We!==0&&(he.mt=S(le,le.l-8)),he.start=le.read_shift(4,"i"),he.size=le.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=H,he.name=""),he.type===5?(V=he.start,O>0&&V!==H&&(F[V].name="!StreamData")):he.size>=4096?(he.storage="fat",F[he.start]===void 0&&(F[he.start]=y(N,he.start,F.fat_addrs,F.ssz)),F[he.start].name=he.name,he.content=F[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:V!==H&&he.start!==H&&F[V]&&(he.content=m(he,F[V].data,(F[Q]||{}).data))),he.content&&yt(he.content,0),D[xe]=he,W.push(he)}}function S(E,F){return new Date((sr(E,F+4)/1e7*Math.pow(2,32)+sr(E,F)/1e7-11644473600)*1e3)}function k(E,F){return c(),f(l.readFileSync(E),F)}function T(E,F){var N=F&&F.type;switch(N||Ae&&Buffer.isBuffer(E)&&(N="buffer"),N||"base64"){case"file":return k(E,F);case"base64":return f(Rr(ur(E)),F);case"binary":return f(Rr(E),F)}return f(E,F)}function _(E,F){var N=F||{},C=N.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=C+"/",E.FileIndex[0]={name:C,type:5}),N.CLSID&&(E.FileIndex[0].clsid=N.CLSID),A(E)}function A(E){var F="Sh33tJ5";if(!Fe.find(E,"/"+F)){var N=ct(4);N[0]=55,N[1]=N[3]=50,N[2]=54,E.FileIndex.push({name:F,type:2,content:N,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+F),b(E)}}function b(E,F){_(E);for(var N=!1,C=!1,O=E.FullPaths.length-1;O>=0;--O){var D=E.FileIndex[O];switch(D.type){case 0:C?N=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(D.R*D.L*D.C)&&(N=!0),D.R>-1&&D.L>-1&&D.R==D.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!F)){var W=new Date(1987,1,19),Q=0,V=Object.create?Object.create(null):{},G=[];for(O=0;O<E.FullPaths.length;++O)V[E.FullPaths[O]]=!0,E.FileIndex[O].type!==0&&G.push([E.FullPaths[O],E.FileIndex[O]]);for(O=0;O<G.length;++O){var K=n(G[O][0]);C=V[K],C||(G.push([K,{name:a(K).replace("/",""),type:1,clsid:ee,ct:W,mt:W,content:null}]),V[K]=!0)}for(G.sort(function(xe,le){return r(xe[0],le[0])}),E.FullPaths=[],E.FileIndex=[],O=0;O<G.length;++O)E.FullPaths[O]=G[O][0],E.FileIndex[O]=G[O][1];for(O=0;O<G.length;++O){var ne=E.FileIndex[O],fe=E.FullPaths[O];if(ne.name=a(fe).replace("/",""),ne.L=ne.R=ne.C=-(ne.color=1),ne.size=ne.content?ne.content.length:0,ne.start=0,ne.clsid=ne.clsid||ee,O===0)ne.C=G.length>1?1:-1,ne.size=0,ne.type=5;else if(fe.slice(-1)=="/"){for(Q=O+1;Q<G.length&&n(E.FullPaths[Q])!=fe;++Q);for(ne.C=Q>=G.length?-1:Q,Q=O+1;Q<G.length&&n(E.FullPaths[Q])!=n(fe);++Q);ne.R=Q>=G.length?-1:Q,ne.type=1}else n(E.FullPaths[O+1]||"")==n(fe)&&(ne.R=O+1),ne.type=2}}}function R(E,F){var N=F||{};if(N.fileType=="mad")return Nv(E,N);switch(b(E),N.fileType){case"zip":return wv(E,N)}var C=function(xe){for(var le=0,he=0,ye=0;ye<xe.FileIndex.length;++ye){var We=xe.FileIndex[ye];if(We.content){var Ge=We.content.length;Ge>0&&(Ge<4096?le+=Ge+63>>6:he+=Ge+511>>9)}}for(var St=xe.FullPaths.length+3>>2,Us=le+7>>3,$s=le+127>>7,Hs=Us+he+St+$s,aa=Hs+127>>7,kc=aa<=109?0:Math.ceil((aa-109)/127);Hs+aa+kc+127>>7>aa;)kc=++aa<=109?0:Math.ceil((aa-109)/127);var rn=[1,kc,aa,$s,St,he,le,0];return xe.FileIndex[0].size=le<<6,rn[7]=(xe.FileIndex[0].start=rn[0]+rn[1]+rn[2]+rn[3]+rn[4]+rn[5])+(rn[6]+7>>3),rn}(E),O=ct(C[7]<<9),D=0,W=0;{for(D=0;D<8;++D)O.write_shift(1,X[D]);for(D=0;D<8;++D)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),D=0;D<3;++D)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,C[2]),O.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:H),O.write_shift(4,C[3]),O.write_shift(-4,C[1]?C[0]-1:H),O.write_shift(4,C[1]),D=0;D<109;++D)O.write_shift(-4,D<C[2]?C[1]+D:-1)}if(C[1])for(W=0;W<C[1];++W){for(;D<236+W*127;++D)O.write_shift(-4,D<C[2]?C[1]+D:-1);O.write_shift(-4,W===C[1]-1?H:W+1)}var Q=function(xe){for(W+=xe;D<W-1;++D)O.write_shift(-4,D+1);xe&&(++D,O.write_shift(-4,H))};for(W=D=0,W+=C[1];D<W;++D)O.write_shift(-4,oe.DIFSECT);for(W+=C[2];D<W;++D)O.write_shift(-4,oe.FATSECT);Q(C[3]),Q(C[4]);for(var V=0,G=0,K=E.FileIndex[0];V<E.FileIndex.length;++V)K=E.FileIndex[V],K.content&&(G=K.content.length,!(G<4096)&&(K.start=W,Q(G+511>>9)));for(Q(C[6]+7>>3);O.l&511;)O.write_shift(-4,oe.ENDOFCHAIN);for(W=D=0,V=0;V<E.FileIndex.length;++V)K=E.FileIndex[V],K.content&&(G=K.content.length,!(!G||G>=4096)&&(K.start=W,Q(G+63>>6)));for(;O.l&511;)O.write_shift(-4,oe.ENDOFCHAIN);for(D=0;D<C[4]<<2;++D){var ne=E.FullPaths[D];if(!ne||ne.length===0){for(V=0;V<17;++V)O.write_shift(4,0);for(V=0;V<3;++V)O.write_shift(4,-1);for(V=0;V<12;++V)O.write_shift(4,0);continue}K=E.FileIndex[D],D===0&&(K.start=K.size?K.start-1:H);var fe=D===0&&N.root||K.name;if(G=2*(fe.length+1),O.write_shift(64,fe,"utf16le"),O.write_shift(2,G),O.write_shift(1,K.type),O.write_shift(1,K.color),O.write_shift(-4,K.L),O.write_shift(-4,K.R),O.write_shift(-4,K.C),K.clsid)O.write_shift(16,K.clsid,"hex");else for(V=0;V<4;++V)O.write_shift(4,0);O.write_shift(4,K.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,K.start),O.write_shift(4,K.size),O.write_shift(4,0)}for(D=1;D<E.FileIndex.length;++D)if(K=E.FileIndex[D],K.size>=4096)if(O.l=K.start+1<<9,Ae&&Buffer.isBuffer(K.content))K.content.copy(O,O.l,0,K.size),O.l+=K.size+511&-512;else{for(V=0;V<K.size;++V)O.write_shift(1,K.content[V]);for(;V&511;++V)O.write_shift(1,0)}for(D=1;D<E.FileIndex.length;++D)if(K=E.FileIndex[D],K.size>0&&K.size<4096)if(Ae&&Buffer.isBuffer(K.content))K.content.copy(O,O.l,0,K.size),O.l+=K.size+63&-64;else{for(V=0;V<K.size;++V)O.write_shift(1,K.content[V]);for(;V&63;++V)O.write_shift(1,0)}if(Ae)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function L(E,F){var N=E.FullPaths.map(function(V){return V.toUpperCase()}),C=N.map(function(V){var G=V.split("/");return G[G.length-(V.slice(-1)=="/"?2:1)]}),O=!1;F.charCodeAt(0)===47?(O=!0,F=N[0].slice(0,-1)+F):O=F.indexOf("/")!==-1;var D=F.toUpperCase(),W=O===!0?N.indexOf(D):C.indexOf(D);if(W!==-1)return E.FileIndex[W];var Q=!D.match(ai);for(D=D.replace(Vt,""),Q&&(D=D.replace(ai,"!")),W=0;W<N.length;++W)if((Q?N[W].replace(ai,"!"):N[W]).replace(Vt,"")==D||(Q?C[W].replace(ai,"!"):C[W]).replace(Vt,"")==D)return E.FileIndex[W];return null}var I=64,H=-2,Z="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:Z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(E,F,N){c();var C=R(E,N);l.writeFileSync(F,C)}function U(E){for(var F=new Array(E.length),N=0;N<E.length;++N)F[N]=String.fromCharCode(E[N]);return F.join("")}function q(E,F){var N=R(E,F);switch(F&&F.type||"buffer"){case"file":return c(),l.writeFileSync(F.filename,N),N;case"binary":return typeof N=="string"?N:U(N);case"base64":return Vh(typeof N=="string"?N:U(N));case"buffer":if(Ae)return Buffer.isBuffer(N)?N:Da(N);case"array":return typeof N=="string"?Rr(N):N}return N}var se;function j(E){try{var F=E.InflateRaw,N=new F;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)se=E;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function z(E,F){if(!se)return ud(E,F);var N=se.InflateRaw,C=new N,O=C._processChunk(E.slice(E.l),C._finishFlushFlag);return E.l+=C.bytesRead,O}function M(E){return se?se.deflateRawSync(E):Te(E)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(E){var F=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(F>>16|F>>8|F)&255}for(var ce=typeof Uint8Array<"u",re=ce?new Uint8Array(256):[],Se=0;Se<256;++Se)re[Se]=ue(Se);function P(E,F){var N=re[E&255];return F<=8?N>>>8-F:(N=N<<8|re[E>>8&255],F<=16?N>>>16-F:(N=N<<8|re[E>>16&255],N>>>24-F))}function ze(E,F){var N=F&7,C=F>>>3;return(E[C]|(N<=6?0:E[C+1]<<8))>>>N&3}function Ce(E,F){var N=F&7,C=F>>>3;return(E[C]|(N<=5?0:E[C+1]<<8))>>>N&7}function Pe(E,F){var N=F&7,C=F>>>3;return(E[C]|(N<=4?0:E[C+1]<<8))>>>N&15}function Ee(E,F){var N=F&7,C=F>>>3;return(E[C]|(N<=3?0:E[C+1]<<8))>>>N&31}function de(E,F){var N=F&7,C=F>>>3;return(E[C]|(N<=1?0:E[C+1]<<8))>>>N&127}function Ve(E,F,N){var C=F&7,O=F>>>3,D=(1<<N)-1,W=E[O]>>>C;return N<8-C||(W|=E[O+1]<<8-C,N<16-C)||(W|=E[O+2]<<16-C,N<24-C)||(W|=E[O+3]<<24-C),W&D}function qt(E,F,N){var C=F&7,O=F>>>3;return C<=5?E[O]|=(N&7)<<C:(E[O]|=N<<C&255,E[O+1]=(N&7)>>8-C),F+3}function hr(E,F,N){var C=F&7,O=F>>>3;return N=(N&1)<<C,E[O]|=N,F+1}function xr(E,F,N){var C=F&7,O=F>>>3;return N<<=C,E[O]|=N&255,N>>>=8,E[O+1]=N,F+8}function rr(E,F,N){var C=F&7,O=F>>>3;return N<<=C,E[O]|=N&255,N>>>=8,E[O+1]=N&255,E[O+2]=N>>>8,F+16}function _n(E,F){var N=E.length,C=2*N>F?2*N:F+5,O=0;if(N>=F)return E;if(Ae){var D=Wh(C);if(E.copy)E.copy(D);else for(;O<E.length;++O)D[O]=E[O];return D}else if(ce){var W=new Uint8Array(C);if(W.set)W.set(E);else for(;O<N;++O)W[O]=E[O];return W}return E.length=C,E}function nr(E){for(var F=new Array(E),N=0;N<E;++N)F[N]=0;return F}function tn(E,F,N){var C=1,O=0,D=0,W=0,Q=0,V=E.length,G=ce?new Uint16Array(32):nr(32);for(D=0;D<32;++D)G[D]=0;for(D=V;D<N;++D)E[D]=0;V=E.length;var K=ce?new Uint16Array(V):nr(V);for(D=0;D<V;++D)G[O=E[D]]++,C<O&&(C=O),K[D]=0;for(G[0]=0,D=1;D<=C;++D)G[D+16]=Q=Q+G[D-1]<<1;for(D=0;D<V;++D)Q=E[D],Q!=0&&(K[D]=G[Q+16]++);var ne=0;for(D=0;D<V;++D)if(ne=E[D],ne!=0)for(Q=P(K[D],C)>>C-ne,W=(1<<C+4-ne)-1;W>=0;--W)F[Q|W<<ne]=ne&15|D<<4;return C}var kn=ce?new Uint16Array(512):nr(512),Bs=ce?new Uint16Array(32):nr(32);if(!ce){for(var Lt=0;Lt<512;++Lt)kn[Lt]=0;for(Lt=0;Lt<32;++Lt)Bs[Lt]=0}(function(){for(var E=[],F=0;F<32;F++)E.push(5);tn(E,Bs,32);var N=[];for(F=0;F<=143;F++)N.push(8);for(;F<=255;F++)N.push(9);for(;F<=279;F++)N.push(7);for(;F<=287;F++)N.push(8);tn(N,kn,288)})();var zr=function(){for(var F=ce?new Uint8Array(32768):[],N=0,C=0;N<ie.length-1;++N)for(;C<ie[N+1];++C)F[C]=N;for(;C<32768;++C)F[C]=29;var O=ce?new Uint8Array(259):[];for(N=0,C=0;N<J.length-1;++N)for(;C<J[N+1];++C)O[C]=N;function D(Q,V){for(var G=0;G<Q.length;){var K=Math.min(65535,Q.length-G),ne=G+K==Q.length;for(V.write_shift(1,+ne),V.write_shift(2,K),V.write_shift(2,~K&65535);K-- >0;)V[V.l++]=Q[G++]}return V.l}function W(Q,V){for(var G=0,K=0,ne=ce?new Uint16Array(32768):[];K<Q.length;){var fe=Math.min(65535,Q.length-K);if(fe<10){for(G=qt(V,G,+(K+fe==Q.length)),G&7&&(G+=8-(G&7)),V.l=G/8|0,V.write_shift(2,fe),V.write_shift(2,~fe&65535);fe-- >0;)V[V.l++]=Q[K++];G=V.l*8;continue}G=qt(V,G,+(K+fe==Q.length)+2);for(var xe=0;fe-- >0;){var le=Q[K];xe=(xe<<5^le)&32767;var he=-1,ye=0;if((he=ne[xe])&&(he|=K&-32768,he>K&&(he-=32768),he<K))for(;Q[he+ye]==Q[K+ye]&&ye<250;)++ye;if(ye>2){le=O[ye],le<=22?G=xr(V,G,re[le+1]>>1)-1:(xr(V,G,3),G+=5,xr(V,G,re[le-23]>>5),G+=3);var We=le<8?0:le-4>>2;We>0&&(rr(V,G,ye-J[le]),G+=We),le=F[K-he],G=xr(V,G,re[le]>>3),G-=3;var Ge=le<4?0:le-2>>1;Ge>0&&(rr(V,G,K-he-ie[le]),G+=Ge);for(var St=0;St<ye;++St)ne[xe]=K&32767,xe=(xe<<5^Q[K])&32767,++K;fe-=ye-1}else le<=143?le=le+48:G=hr(V,G,1),G=xr(V,G,re[le]),ne[xe]=K&32767,++K}G=xr(V,G,0)-1}return V.l=(G+7)/8|0,V.l}return function(V,G){return V.length<8?D(V,G):W(V,G)}}();function Te(E){var F=ct(50+Math.floor(E.length*1.1)),N=zr(E,F);return F.slice(0,N)}var Ze=ce?new Uint16Array(32768):nr(32768),mr=ce?new Uint16Array(32768):nr(32768),it=ce?new Uint16Array(128):nr(128),na=1,cd=1;function gv(E,F){var N=Ee(E,F)+257;F+=5;var C=Ee(E,F)+1;F+=5;var O=Pe(E,F)+4;F+=4;for(var D=0,W=ce?new Uint8Array(19):nr(19),Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,G=ce?new Uint8Array(8):nr(8),K=ce?new Uint8Array(8):nr(8),ne=W.length,fe=0;fe<O;++fe)W[B[fe]]=D=Ce(E,F),V<D&&(V=D),G[D]++,F+=3;var xe=0;for(G[0]=0,fe=1;fe<=V;++fe)K[fe]=xe=xe+G[fe-1]<<1;for(fe=0;fe<ne;++fe)(xe=W[fe])!=0&&(Q[fe]=K[xe]++);var le=0;for(fe=0;fe<ne;++fe)if(le=W[fe],le!=0){xe=re[Q[fe]]>>8-le;for(var he=(1<<7-le)-1;he>=0;--he)it[xe|he<<le]=le&7|fe<<3}var ye=[];for(V=1;ye.length<N+C;)switch(xe=it[de(E,F)],F+=xe&7,xe>>>=3){case 16:for(D=3+ze(E,F),F+=2,xe=ye[ye.length-1];D-- >0;)ye.push(xe);break;case 17:for(D=3+Ce(E,F),F+=3;D-- >0;)ye.push(0);break;case 18:for(D=11+de(E,F),F+=7;D-- >0;)ye.push(0);break;default:ye.push(xe),V<xe&&(V=xe);break}var We=ye.slice(0,N),Ge=ye.slice(N);for(fe=N;fe<286;++fe)We[fe]=0;for(fe=C;fe<30;++fe)Ge[fe]=0;return na=tn(We,Ze,286),cd=tn(Ge,mr,30),F}function vv(E,F){if(E[0]==3&&!(E[1]&3))return[Yn(F),2];for(var N=0,C=0,O=Wh(F||1<<18),D=0,W=O.length>>>0,Q=0,V=0;!(C&1);){if(C=Ce(E,N),N+=3,C>>>1)C>>1==1?(Q=9,V=5):(N=gv(E,N),Q=na,V=cd);else{N&7&&(N+=8-(N&7));var G=E[N>>>3]|E[(N>>>3)+1]<<8;if(N+=32,G>0)for(!F&&W<D+G&&(O=_n(O,D+G),W=O.length);G-- >0;)O[D++]=E[N>>>3],N+=8;continue}for(;;){!F&&W<D+32767&&(O=_n(O,D+32767),W=O.length);var K=Ve(E,N,Q),ne=C>>>1==1?kn[K]:Ze[K];if(N+=ne&15,ne>>>=4,!(ne>>>8&255))O[D++]=ne;else{if(ne==256)break;ne-=257;var fe=ne<8?0:ne-4>>2;fe>5&&(fe=0);var xe=D+J[ne];fe>0&&(xe+=Ve(E,N,fe),N+=fe),K=Ve(E,N,V),ne=C>>>1==1?Bs[K]:mr[K],N+=ne&15,ne>>>=4;var le=ne<4?0:ne-2>>1,he=ie[ne];for(le>0&&(he+=Ve(E,N,le),N+=le),!F&&W<xe&&(O=_n(O,xe+100),W=O.length);D<xe;)O[D]=O[D-he],++D}}}return F?[O,N+7>>>3]:[O.slice(0,D),N+7>>>3]}function ud(E,F){var N=E.slice(E.l||0),C=vv(N,F);return E.l+=C[1],C[0]}function fd(E,F){if(E)typeof console<"u"&&console.error(F);else throw new Error(F)}function dd(E,F){var N=E;yt(N,0);var C=[],O=[],D={FileIndex:C,FullPaths:O};_(D,{root:F.root});for(var W=N.length-4;(N[W]!=80||N[W+1]!=75||N[W+2]!=5||N[W+3]!=6)&&W>=0;)--W;N.l=W+4,N.l+=4;var Q=N.read_shift(2);N.l+=6;var V=N.read_shift(4);for(N.l=V,W=0;W<Q;++W){N.l+=20;var G=N.read_shift(4),K=N.read_shift(4),ne=N.read_shift(2),fe=N.read_shift(2),xe=N.read_shift(2);N.l+=8;var le=N.read_shift(4),he=o(N.slice(N.l+ne,N.l+ne+fe));N.l+=ne+fe+xe;var ye=N.l;N.l=le+4,yv(N,G,K,D,he),N.l=ye}return D}function yv(E,F,N,C,O){E.l+=2;var D=E.read_shift(2),W=E.read_shift(2),Q=i(E);if(D&8257)throw new Error("Unsupported ZIP encryption");for(var V=E.read_shift(4),G=E.read_shift(4),K=E.read_shift(4),ne=E.read_shift(2),fe=E.read_shift(2),xe="",le=0;le<ne;++le)xe+=String.fromCharCode(E[E.l++]);if(fe){var he=o(E.slice(E.l,E.l+fe));(he[21589]||{}).mt&&(Q=he[21589].mt),((O||{})[21589]||{}).mt&&(Q=O[21589].mt)}E.l+=fe;var ye=E.slice(E.l,E.l+G);switch(W){case 8:ye=z(E,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+W)}var We=!1;D&8&&(V=E.read_shift(4),V==134695760&&(V=E.read_shift(4),We=!0),G=E.read_shift(4),K=E.read_shift(4)),G!=F&&fd(We,"Bad compressed size: "+F+" != "+G),K!=N&&fd(We,"Bad uncompressed size: "+N+" != "+K),_c(C,xe,ye,{unsafe:!0,mt:Q})}function wv(E,F){var N=F||{},C=[],O=[],D=ct(1),W=N.compression?8:0,Q=0,V=0,G=0,K=0,ne=0,fe=E.FullPaths[0],xe=fe,le=E.FileIndex[0],he=[],ye=0;for(V=1;V<E.FullPaths.length;++V)if(xe=E.FullPaths[V].slice(fe.length),le=E.FileIndex[V],!(!le.size||!le.content||xe=="Sh33tJ5")){var We=K,Ge=ct(xe.length);for(G=0;G<xe.length;++G)Ge.write_shift(1,xe.charCodeAt(G)&127);Ge=Ge.slice(0,Ge.l),he[ne]=OE.buf(le.content,0);var St=le.content;W==8&&(St=M(St)),D=ct(30),D.write_shift(4,67324752),D.write_shift(2,20),D.write_shift(2,Q),D.write_shift(2,W),le.mt?s(D,le.mt):D.write_shift(4,0),D.write_shift(-4,he[ne]),D.write_shift(4,St.length),D.write_shift(4,le.content.length),D.write_shift(2,Ge.length),D.write_shift(2,0),K+=D.length,C.push(D),K+=Ge.length,C.push(Ge),K+=St.length,C.push(St),D=ct(46),D.write_shift(4,33639248),D.write_shift(2,0),D.write_shift(2,20),D.write_shift(2,Q),D.write_shift(2,W),D.write_shift(4,0),D.write_shift(-4,he[ne]),D.write_shift(4,St.length),D.write_shift(4,le.content.length),D.write_shift(2,Ge.length),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(4,0),D.write_shift(4,We),ye+=D.l,O.push(D),ye+=Ge.length,O.push(Ge),++ne}return D=ct(22),D.write_shift(4,101010256),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,ne),D.write_shift(2,ne),D.write_shift(4,ye),D.write_shift(4,K),D.write_shift(2,0),Dn([Dn(C),Dn(O),D])}var go={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _v(E,F){if(E.ctype)return E.ctype;var N=E.name||"",C=N.match(/\.([^\.]+)$/);return C&&go[C[1]]||F&&(C=(N=F).match(/[\.\\]([^\.\\])+$/),C&&go[C[1]])?go[C[1]]:"application/octet-stream"}function kv(E){for(var F=Vh(E),N=[],C=0;C<F.length;C+=76)N.push(F.slice(C,C+76));return N.join(`\r
`)+`\r
`}function Ev(E){var F=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(G){var K=G.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],C=F.split(`\r
`),O=0;O<C.length;++O){var D=C[O];if(D.length==0){N.push("");continue}for(var W=0;W<D.length;){var Q=76,V=D.slice(W,W+Q);V.charAt(Q-1)=="="?Q--:V.charAt(Q-2)=="="?Q-=2:V.charAt(Q-3)=="="&&(Q-=3),V=D.slice(W,W+Q),W+=Q,W<D.length&&(V+="="),N.push(V)}}return N.join(`\r
`)}function Sv(E){for(var F=[],N=0;N<E.length;++N){for(var C=E[N];N<=E.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+E[++N];F.push(C)}for(var O=0;O<F.length;++O)F[O]=F[O].replace(/[=][0-9A-Fa-f]{2}/g,function(D){return String.fromCharCode(parseInt(D.slice(1),16))});return Rr(F.join(`\r
`))}function Tv(E,F,N){for(var C="",O="",D="",W,Q=0;Q<10;++Q){var V=F[Q];if(!V||V.match(/^\s*$/))break;var G=V.match(/^(.*?):\s*([^\s].*)$/);if(G)switch(G[1].toLowerCase()){case"content-location":C=G[2].trim();break;case"content-type":D=G[2].trim();break;case"content-transfer-encoding":O=G[2].trim();break}}switch(++Q,O.toLowerCase()){case"base64":W=Rr(ur(F.slice(Q).join("")));break;case"quoted-printable":W=Sv(F.slice(Q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var K=_c(E,C.slice(N.length),W,{unsafe:!0});D&&(K.ctype=D)}function bv(E,F){if(U(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=F&&F.root||"",C=(Ae&&Buffer.isBuffer(E)?E.toString("binary"):U(E)).split(`\r
`),O=0,D="";for(O=0;O<C.length;++O)if(D=C[O],!!/^Content-Location:/i.test(D)&&(D=D.slice(D.indexOf("file")),N||(N=D.slice(0,D.lastIndexOf("/")+1)),D.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),D.slice(0,N.length)!=N););var W=(C[1]||"").match(/boundary="(.*?)"/);if(!W)throw new Error("MAD cannot find boundary");var Q="--"+(W[1]||""),V=[],G=[],K={FileIndex:V,FullPaths:G};_(K);var ne,fe=0;for(O=0;O<C.length;++O){var xe=C[O];xe!==Q&&xe!==Q+"--"||(fe++&&Tv(K,C.slice(ne,O),N),ne=O)}return K}function Nv(E,F){var N=F||{},C=N.boundary||"SheetJS";C="------="+C;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],D=E.FullPaths[0],W=D,Q=E.FileIndex[0],V=1;V<E.FullPaths.length;++V)if(W=E.FullPaths[V].slice(D.length),Q=E.FileIndex[V],!(!Q.size||!Q.content||W=="Sh33tJ5")){W=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ye){return"_x"+ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ye){return"_u"+ye.charCodeAt(0).toString(16)+"_"});for(var G=Q.content,K=Ae&&Buffer.isBuffer(G)?G.toString("binary"):U(G),ne=0,fe=Math.min(1024,K.length),xe=0,le=0;le<=fe;++le)(xe=K.charCodeAt(le))>=32&&xe<128&&++ne;var he=ne>=fe*4/5;O.push(C),O.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+W),O.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),O.push("Content-Type: "+_v(Q,W)),O.push(""),O.push(he?Ev(K):kv(K))}return O.push(C+`--\r
`),O.join(`\r
`)}function Cv(E){var F={};return _(F,E),F}function _c(E,F,N,C){var O=C&&C.unsafe;O||_(E);var D=!O&&Fe.find(E,F);if(!D){var W=E.FullPaths[0];F.slice(0,W.length)==W?W=F:(W.slice(-1)!="/"&&(W+="/"),W=(W+F).replace("//","/")),D={name:a(F),type:2},E.FileIndex.push(D),E.FullPaths.push(W),O||Fe.utils.cfb_gc(E)}return D.content=N,D.size=N?N.length:0,C&&(C.CLSID&&(D.clsid=C.CLSID),C.mt&&(D.mt=C.mt),C.ct&&(D.ct=C.ct)),D}function Av(E,F){_(E);var N=Fe.find(E,F);if(N){for(var C=0;C<E.FileIndex.length;++C)if(E.FileIndex[C]==N)return E.FileIndex.splice(C,1),E.FullPaths.splice(C,1),!0}return!1}function Fv(E,F,N){_(E);var C=Fe.find(E,F);if(C){for(var O=0;O<E.FileIndex.length;++O)if(E.FileIndex[O]==C)return E.FileIndex[O].name=a(N),E.FullPaths[O]=N,!0}return!1}function jv(E){b(E,!0)}return t.find=L,t.read=T,t.parse=f,t.write=q,t.writeFile=te,t.utils={cfb_new:Cv,cfb_add:_c,cfb_del:Av,cfb_mov:Fv,cfb_gc:jv,ReadShift:wi,CheckField:yg,prep_blob:yt,bconcat:Dn,use_zlib:j,_deflateRaw:Te,_inflateRaw:ud,consts:oe},t}();function DE(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Qr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function $f(e){for(var t=[],r=Qr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var $l=new Date(1899,11,30,0,0,0);function Wt(e,t){var r=e.getTime(),n=$l.getTime()+(e.getTimezoneOffset()-$l.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Q1=new Date,PE=$l.getTime()+(Q1.getTimezoneOffset()-$l.getTimezoneOffset())*6e4,Zh=Q1.getTimezoneOffset();function gc(e){var t=new Date;return t.setTime(e*24*60*60*1e3+PE),t.getTimezoneOffset()!==Zh&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Zh)*6e4),t}function IE(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var ex=new Date("2017-02-19T19:06:09.000Z"),Z1=isNaN(ex.getFullYear())?new Date("2/19/17"):ex,RE=Z1.getFullYear()==2017;function gt(e,t){var r=new Date(e);if(RE)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Z1.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Na(e,t){if(Ae&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ii(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ii(B1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ii(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ii(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function _t(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=_t(e[r]));return t}function Je(e,t){for(var r="";r.length<t;)r+=e;return r}function $r(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var LE=["january","february","march","april","may","june","july","august","september","october","november","december"];function As(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&LE.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var ME=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function eg(e){return e?e.content&&e.type?Na(e.content,!0):e.data?ni(e.data):e.asNodeBuffer&&Ae?ni(e.asNodeBuffer().toString("binary")):e.asBinary?ni(e.asBinary()):e._data&&e._data.getContent?ni(Na(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function tg(e){if(!e)return null;if(e.data)return Hh(e.data);if(e.asNodeBuffer&&Ae)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Hh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function BE(e){return e&&e.name.slice(-4)===".bin"?tg(e):eg(e)}function vr(e,t){for(var r=e.FullPaths||Qr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Hf(e,t){var r=vr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function nt(e,t,r){if(!r)return BE(Hf(e,t));if(!t)return null;try{return nt(e,t)}catch{return null}}function ir(e,t,r){if(!r)return eg(Hf(e,t));if(!t)return null;try{return ir(e,t)}catch{return null}}function UE(e,t,r){return tg(Hf(e,t))}function tx(e){for(var t=e.FullPaths||Qr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function $E(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ae?n=Da(r):n=iE(r),Fe.utils.cfb_add(e,t,n)}Fe.utils.cfb_add(e,t,r)}else e.file(t,r)}function rg(e,t){switch(t.type){case"base64":return Fe.read(e,{type:"base64"});case"binary":return Fe.read(e,{type:"binary"});case"buffer":case"array":return Fe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function si(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var ng=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,HE=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zE=/<[^>]*>/g,Rt=ng.match(rx)?rx:zE,VE=/<\w*:/,WE=/<(\/?)\w+:/;function ge(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(HE),o=0,l="",c=0,f="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var x=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[x]&&f.slice(o-3,o)=="ext")continue;n[x]=l,n[x.toLowerCase()]=l}}return n}function Zr(e){return e.replace(WE,"<$1")}var ag={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},GE=$f(ag),De=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return ag[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),KE=/[&<>'"]/g,qE=/[\u0000-\u001f]/g;function zf(e){var t=e+"";return t.replace(KE,function(r){return GE[r]}).replace(/\n/g,"<br/>").replace(qE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var nx=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function $e(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function s0(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function ax(e){var t=Yn(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function sx(e){return Da(e,"binary").toString("utf8")}var $o="foo bar baz",Me=Ae&&(sx($o)==s0($o)&&sx||ax($o)==s0($o)&&ax)||s0,ii=Ae?function(e){return Da(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Xi=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),sg=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),XE=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),YE=/<\/?(?:vt:)?variant>/g,JE=/<(?:vt:)([^>]*)>([\s\S]*)</;function ix(e,t){var r=ge(e),n=e.match(XE(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(YE,"").match(JE);i&&a.push({v:Me(i[2]),t:i[1]})}),a}var QE=/(^\s|\s$|\n)/;function ZE(e){return Qr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function e4(e,t,r){return"<"+e+(r!=null?ZE(r):"")+(t!=null?(t.match(QE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Vf(e){if(Ae&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Me(Pa(Mf(e)));throw new Error("Bad input format: expected Buffer or string")}var Yi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,t4={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},r4=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function n4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function a4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var ox=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},lx=Ae?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Da(t)})):ox(e)}:ox,cx=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(un(e,a)));return n.join("").replace(Vt,"")},Wf=Ae?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Vt,""):cx(e,t,r)}:cx,ux=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},ig=Ae?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ux(e,t,r)}:ux,fx=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(qa(e,a)));return n.join("")},uo=Ae?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):fx(t,r,n)}:fx,og=function(e,t){var r=sr(e,t);return r>0?uo(e,t+4,t+4+r-1):""},lg=og,cg=function(e,t){var r=sr(e,t);return r>0?uo(e,t+4,t+4+r-1):""},ug=cg,fg=function(e,t){var r=2*sr(e,t);return r>0?uo(e,t+4,t+4+r-1):""},dg=fg,hg=function(t,r){var n=sr(t,r);return n>0?Wf(t,r+4,r+4+n):""},xg=hg,mg=function(e,t){var r=sr(e,t);return r>0?uo(e,t+4,t+4+r):""},pg=mg,gg=function(e,t){return n4(e,t)},Hl=gg,vg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ae&&(lg=function(t,r){if(!Buffer.isBuffer(t))return og(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ug=function(t,r){if(!Buffer.isBuffer(t))return cg(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},dg=function(t,r){if(!Buffer.isBuffer(t))return fg(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},xg=function(t,r){if(!Buffer.isBuffer(t))return hg(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},pg=function(t,r){if(!Buffer.isBuffer(t))return mg(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Hl=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):gg(t,r)},vg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var qa=function(e,t){return e[t]},un=function(e,t){return e[t+1]*256+e[t]},s4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},sr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},fa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},i4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function wi(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Ae&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(un(this,c)),c+=2;e*=2;break;case"utf8":r=uo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Wf(this,this.l,this.l+e);break;case"wstr":return wi.call(this,e,"dbcs");case"lpstr-ansi":r=lg(this,this.l),e=4+sr(this,this.l);break;case"lpstr-cp":r=ug(this,this.l),e=4+sr(this,this.l);break;case"lpwstr":r=dg(this,this.l),e=4+2*sr(this,this.l);break;case"lpp4":e=4+sr(this,this.l),r=xg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+sr(this,this.l),r=pg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=qa(this,this.l+e++))!==0;)s.push(Uo(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=un(this,this.l+e))!==0;)s.push(Uo(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=qa(this,c),this.l=c+1,o=wi.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Uo(un(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=qa(this,c),this.l=c+1,o=wi.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Uo(qa(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=qa(this,this.l),this.l++,n;case 2:return n=(t==="i"?s4:un)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?fa:i4)(this,this.l),this.l+=4,n):(a=sr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Hl(this,this.l):a=Hl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=ig(this,this.l,e);break}}return this.l+=e,r}var o4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},l4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},c4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function u4(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)c4(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,o4(this,t,this.l);break;case 8:if(n=8,r==="f"){a4(this,t,this.l);break}case 16:break;case-4:n=4,l4(this,t,this.l);break}return this.l+=n,this}function yg(e,t){var r=ig(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function yt(e,t){e.l=t,e.read_shift=wi,e.chk=yg,e.write_shift=u4}function It(e,t){e.l+=t}function ct(e){var t=Yn(e);return yt(t,0),t}function wn(e,t,r){if(e){var n,a,s;yt(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=ql[o]||ql[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=l,t(f,c,o))return}}}function Eu(){var e=[],t=Ae?256:2048,r=function(c){var f=ct(c);return yt(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),Dn(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function _i(e,t,r){var n=_t(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function dx(e,t,r){var n=_t(e);return n.s=_i(n.s,t.s,r),n.e=_i(n.e,t.s,r),n}function ki(e,t){if(e.cRel&&e.c<0)for(e=_t(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=_t(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ve(e);return!e.cRel&&e.cRel!=null&&(r=h4(r)),!e.rRel&&e.rRel!=null&&(r=f4(r)),r}function i0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+dt(e.s.c)+":"+(e.e.cRel?"":"$")+dt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kt(e.s.r)+":"+(e.e.rRel?"":"$")+kt(e.e.r):ki(e.s,t.biff)+":"+ki(e.e,t.biff)}function Gf(e){return parseInt(d4(e),10)-1}function kt(e){return""+(e+1)}function f4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function d4(e){return e.replace(/\$(\d+)$/,"$1")}function Kf(e){for(var t=x4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function dt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function h4(e){return e.replace(/^([A-Z])/,"$$$1")}function x4(e){return e.replace(/^\$([A-Z])/,"$1")}function m4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ht(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function ve(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ls(e){var t=e.indexOf(":");return t==-1?{s:Ht(e),e:Ht(e)}:{s:Ht(e.slice(0,t)),e:Ht(e.slice(t+1))}}function je(e,t){return typeof t>"u"||typeof t=="number"?je(e.s,e.e):(typeof e!="string"&&(e=ve(e)),typeof t!="string"&&(t=ve(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function hx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=br(e.z,r?Wt(t):t)}catch{}try{return e.w=br((e.XF||{}).numFmtId||(r?14:0),r?Wt(t):t)}catch{return""+t}}function vn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?La[e.v]||e.v:t==null?hx(e,e.v):hx(e,t))}function ra(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function wg(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Ht(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Qe(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var x={v:t[d][h]},p=i+d,m=o+h;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))x=t[d][h];else if(Array.isArray(x.v)&&(x.f=t[d][h][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||ke[14],n.cellDates?(x.t="d",x.w=br(x.z,Wt(x.v))):(x.t="n",x.v=Wt(x.v),x.w=br(x.z,x.v))):x.t="s";if(a)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(x.z=s[p][m].z),s[p][m]=x;else{var v=ve({c:m,r:p});s[v]&&s[v].z&&(x.z=s[v].z),s[v]=x}}}return c.s.c<1e7&&(s["!ref"]=je(c)),s}function Ms(e,t){return wg(null,e,t)}function p4(e){return e.read_shift(4,"i")}function Ot(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function g4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function qf(e,t){var r=e.l,n=e.read_shift(1),a=Ot(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(g4(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var v4=qf;function Nr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ia(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var y4=Ot;function Xf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var w4=Ot,Su=Xf;function Yf(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Hl([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):fa(t,0)>>2;return r?a/100:a}function _g(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ra=_g;function Ft(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _4(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=wa[a];c&&(t.rgb=Qi(c));break;case 2:t.rgb=Qi([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function k4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function kg(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function E4(e){return kg(e,1)}function S4(e){return kg(e,2)}var Jf=2,Xt=3,Ho=11,xx=12,zl=19,zo=64,T4=65,b4=71,N4=4108,C4=4126,xt=80,Eg=81,A4=[xt,Eg],F4={1:{n:"CodePage",t:Jf},2:{n:"Category",t:xt},3:{n:"PresentationFormat",t:xt},4:{n:"ByteCount",t:Xt},5:{n:"LineCount",t:Xt},6:{n:"ParagraphCount",t:Xt},7:{n:"SlideCount",t:Xt},8:{n:"NoteCount",t:Xt},9:{n:"HiddenCount",t:Xt},10:{n:"MultimediaClipCount",t:Xt},11:{n:"ScaleCrop",t:Ho},12:{n:"HeadingPairs",t:N4},13:{n:"TitlesOfParts",t:C4},14:{n:"Manager",t:xt},15:{n:"Company",t:xt},16:{n:"LinksUpToDate",t:Ho},17:{n:"CharacterCount",t:Xt},19:{n:"SharedDoc",t:Ho},22:{n:"HyperlinksChanged",t:Ho},23:{n:"AppVersion",t:Xt,p:"version"},24:{n:"DigSig",t:T4},26:{n:"ContentType",t:xt},27:{n:"ContentStatus",t:xt},28:{n:"Language",t:xt},29:{n:"Version",t:xt},255:{},2147483648:{n:"Locale",t:zl},2147483651:{n:"Behavior",t:zl},1919054434:{}},j4={1:{n:"CodePage",t:Jf},2:{n:"Title",t:xt},3:{n:"Subject",t:xt},4:{n:"Author",t:xt},5:{n:"Keywords",t:xt},6:{n:"Comments",t:xt},7:{n:"Template",t:xt},8:{n:"LastAuthor",t:xt},9:{n:"RevNumber",t:xt},10:{n:"EditTime",t:zo},11:{n:"LastPrinted",t:zo},12:{n:"CreatedDate",t:zo},13:{n:"ModifiedDate",t:zo},14:{n:"PageCount",t:Xt},15:{n:"WordCount",t:Xt},16:{n:"CharCount",t:Xt},17:{n:"Thumbnail",t:b4},18:{n:"Application",t:xt},19:{n:"DocSecurity",t:Xt},255:{},2147483648:{n:"Locale",t:zl},2147483651:{n:"Behavior",t:zl},1919054434:{}},mx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},O4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function D4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var P4=D4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),wa=_t(P4),La={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Sg={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},px={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function I4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function R4(e){var t=I4();if(!e||!e.match)return t;var r={};if((e.match(Rt)||[]).forEach(function(n){var a=ge(n);switch(a[0].replace(VE,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[px[a.ContentType]]!==void 0&&t[px[a.ContentType]].push(a.PartName);break}}),t.xmlns!==t4.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var os={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tu(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ei(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Rt)||[]).forEach(function(a){var s=ge(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:si(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}var L4="application/vnd.oasis.opendocument.spreadsheet";function M4(e,t){for(var r=Vf(e),n,a;n=Yi.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ge(n[0],!1),a.path=="/"&&a.type!==L4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Si=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],B4=function(){for(var e=new Array(Si.length),t=0;t<Si.length;++t){var r=Si[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Tg(e){var t={};e=Me(e);for(var r=0;r<Si.length;++r){var n=Si[r],a=e.match(B4[r]);a!=null&&a.length>0&&(t[n[1]]=De(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=gt(t[n[1]]))}return t}var U4=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function bg(e,t,r,n){var a=[];if(typeof e=="string")a=ix(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?ix(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function $4(e,t,r){var n={};return t||(t={}),e=Me(e),U4.forEach(function(a){var s=(e.match(Xi(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=De(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&bg(n.HeadingPairs,n.TitlesOfParts,t,r),t}var H4=/<[^>]+>[^<]*/g;function z4(e,t){var r={},n="",a=e.match(H4);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=ge(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=De(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=De(f);break;case"bool":r[n]=$e(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=gt(f);break;case"cy":case"error":r[n]=De(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var V4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},o0;function W4(e,t,r){o0||(o0=$f(V4)),t=o0[t]||t,e[t]=r}function Qf(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Ng(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Cg(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Ag(e,t,r){return t===31?Cg(e):Ng(e,t,r)}function bu(e,t,r){return Ag(e,t,r===!1?0:4)}function G4(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ag(e,t,0)}function K4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Vt,""),e.l-a&2&&(e.l+=2)}return r}function q4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Vt,"");return r}function X4(e){var t=e.l,r=Vl(e,Eg);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Vl(e,Xt);return[r,n]}function Y4(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(X4(e));return r}function gx(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Vt,"").replace(ai,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Fg(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function J4(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Vl(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==xx&&n!==t&&A4.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===xx?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Ng(e,n,4).replace(Vt,"");case 31:return Cg(e);case 64:return Qf(e);case 65:return Fg(e);case 71:return J4(e);case 80:return bu(e,n,!s.raw).replace(Vt,"");case 81:return G4(e,n).replace(Vt,"");case 4108:return Y4(e);case 4126:case 4127:return n==4127?K4(e):q4(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function vx(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(w,g){return w[1]-g[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var x=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,x=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],x=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],x=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(x=!1,e.l=s[i][1]),x)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[s[i][0]];if(h[p.n]=Vl(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Lr(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(s[i][0]===1){if(o=h.CodePage=Vl(e,Jf),Lr(o),l!==-1){var m=e.l;e.l=s[l][1],c=gx(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=gx(e,o)}else{var v=c[s[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=Fg(e);break;case 30:e.l+=4,y=bu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=bu(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=et(e,4);break;case 64:e.l+=4,y=gt(Qf(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=y}}return e.l=r+n,h}function yx(e,t,r){var n=e.content;if(!n)return{};yt(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Fe.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=vx(n,t),h={SystemIdentifier:c};for(var x in d)h[x]=d[x];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var p;try{p=vx(n,null)}catch{}for(x in p)h[x]=p[x];return h.FMTID=[s,i],h}function Tn(e,t){return e.read_shift(t),null}function Q4(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function et(e,t){return e.read_shift(t)===1}function at(e){return e.read_shift(2,"u")}function jg(e,t){return Q4(e,t,at)}function Z4(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function fo(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function eS(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=f,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ca(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ho(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ca(e,n,r)}function Ma(e,t,r){if(r.biff>5)return ho(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function tS(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function rS(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Vt,"");return n&&(e.l+=24),a}function nS(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Vt,"");return r+i}function aS(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return rS(e);case"0303000000000000c000000000000046":return nS(e);default:throw new Error("Unsupported Moniker "+r)}}function Vo(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Vt,""):"";return r}function sS(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",f,d;a&16&&(s=Vo(e,r-e.l)),a&128&&(i=Vo(e,r-e.l)),(a&257)===257&&(o=Vo(e,r-e.l)),(a&257)===1&&(l=aS(e,r-e.l)),a&8&&(c=Vo(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=Qf(e)),e.l=r;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var x={Target:h};return f&&(x.guid=f),d&&(x.time=d),s&&(x.Tooltip=s),x}function Og(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Dg(e,t){var r=Og(e);return r[3]=0,r}function en(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function iS(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function oS(e,t,r){return t===0?"":Ma(e,t,r)}function lS(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Pg(e){var t=e.read_shift(2),r=Yf(e);return[t,r]}function cS(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=fo(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function vc(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Ig(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var uS=Ig;function Rg(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function fS(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function dS(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Nt(e){e.l+=2,e.l+=e.read_shift(2)}var hS={0:Nt,4:Nt,5:Nt,6:Nt,7:dS,8:Nt,9:Nt,10:Nt,11:Nt,12:Nt,13:fS,14:Nt,15:Nt,16:Nt,17:Nt,18:Nt,19:Nt,20:Nt,21:Rg};function xS(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(hS[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Wo(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function mS(e,t){return t===0||e.read_shift(2),1200}function pS(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ma(e,0,r);return e.read_shift(t+n-e.l),a}function gS(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function vS(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=fo(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function yS(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(eS(e));return s.Count=n,s.Unique=a,s}function wS(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function _S(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function kS(e){var t=iS(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function ES(e){return e.read_shift(2),e.read_shift(4)}function wx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function SS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function TS(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function bS(){}function NS(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=fo(e,0,r),n}function CS(e){var t=en(e);return t.isst=e.read_shift(4),t}function AS(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=en(e);r.biff==2&&e.l++;var s=ho(e,n-e.l,r);return a.val=s,a}function FS(e,t,r){var n=e.read_shift(2),a=Ma(e,0,r);return[n,a]}var jS=Ma;function _x(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function OS(e){var t=e.read_shift(2),r=e.read_shift(2),n=Pg(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function DS(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Pg(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function PS(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function IS(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=O4[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function RS(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=IS(e,t,n.fStyle,r),n}function LS(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function kx(e,t,r){var n=en(e);(r.biff==2||t==9)&&++e.l;var a=Z4(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function MS(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=en(e),a=Ft(e);return n.val=a,n}var Ex=oS;function BS(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Ca(e,s),o=[];n>e.l;)o.push(ho(e));return[s,a,i,o]}function Sx(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=cS(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var US=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Tx(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Ca(e,i,r);a&32&&(c=US[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:_N(e,f,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function Lg(e,t,r){if(r.biff<8)return $S(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(lS(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function $S(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=fo(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function HS(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Ca(e,n,r),i=Ca(e,a,r);return[s,i]}function zS(e,t,r){var n=Ig(e);e.l++;var a=e.read_shift(1);return t-=8,[kN(e,t,r),a,n]}function bx(e,t,r){var n=uS(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,yN(e,t,r)]}function VS(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function WS(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Ma(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function GS(e,t,r){return WS(e,t,r)}function KS(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(vc(e));return r}function qS(e,t,r){if(r&&r.biff<8)return YS(e,t,r);var n=Rg(e),a=xS(e,t-22,n[1]);return{cmo:n,ft:a}}var XS={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function YS(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((XS[n]||It)(e,t,r)),{cmo:[a,n,s],ft:i}}function JS(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=tS(e,6,r);var o=e.read_shift(2);e.read_shift(2),at(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],d=Ca(e,e.lens[c+1]-e.lens[c]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function QS(e,t){var r=vc(e);e.l+=16;var n=sS(e,t-24);return[r,n]}function ZS(e,t){e.read_shift(2);var r=vc(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Vt,""),[r,n]}function eT(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=mx[r]||r,r=e.read_shift(2),t[1]=mx[r]||r,t}function tT(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Dg(e));return r}function rT(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Dg(e));return r}function nT(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Mg(e,t,r){if(!r.cellStyles)return It(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function aT(e,t){var r={};return t<32||(e.l+=16,r.header=Ft(e),r.footer=Ft(e),e.l+=2),r}function sT(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var iT=en,oT=jg,lT=ho;function cT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function uT(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=en(e);++e.l;var a=Ma(e,t-7,r);return n.t="str",n.val=a,n}function fT(e){var t=en(e);++e.l;var r=Ft(e);return t.t="n",t.val=r,t}function dT(e){var t=en(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function hT(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function xT(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function mT(e,t,r){var n=e.l+t,a=en(e),s=e.read_shift(2),i=Ca(e,s,r);return e.l=n,a.t="str",a.val=i,a}var pT=[2,3,48,49,131,139,140,245],Nx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=$f({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Yn(1);switch(l.type){case"base64":f=Rr(ur(o));break;case"binary":f=Rr(o);break;case"buffer":case"array":f=o;break}yt(f,0);var d=f.read_shift(1),h=!!(d&136),x=!1,p=!1;switch(d){case 2:break;case 3:break;case 48:x=!0,h=!0;break;case 49:x=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,v=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(v=f.read_shift(2));var y=f.read_shift(2),w=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),p&&(f.l+=36);for(var g=[],S={},k=Math.min(f.length,d==2?521:v-10-(x?264:0)),T=p?32:11;f.l<k&&f[f.l]!=13;)switch(S={},S.name=On.utils.decode(w,f.slice(f.l,f.l+T)).replace(/[\u0000\r\n].*$/g,""),f.l+=T,S.type=String.fromCharCode(f.read_shift(1)),d!=2&&!p&&(S.offset=f.read_shift(4)),S.len=f.read_shift(1),d==2&&(S.offset=f.read_shift(2)),S.dec=f.read_shift(1),S.name.length&&g.push(S),d!=2&&(f.l+=p?13:14),S.type){case"B":(!x||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(f[f.l]!==13&&(f.l=v-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=v;var _=0,A=0;for(c[0]=[],A=0;A!=g.length;++A)c[0][A]=g[A].name;for(;m-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,c[++_]=[],A=0,A=0;A!=g.length;++A){var b=f.slice(f.l,f.l+g[A].len);f.l+=g[A].len,yt(b,0);var R=On.utils.decode(w,b);switch(g[A].type){case"C":R.trim().length&&(c[_][A]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[_][A]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[_][A]=R;break;case"F":c[_][A]=parseFloat(R.trim());break;case"+":case"I":c[_][A]=p?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[_][A]=!0;break;case"N":case"F":c[_][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[_][A]="##MEMO##"+(p?parseInt(R.trim(),10):b.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[_][A]=+R||0);break;case"@":c[_][A]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":c[_][A]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":c[_][A]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[_][A]=-b.read_shift(-8,"f");break;case"B":if(x&&g[A].len==8){c[_][A]=b.read_shift(8,"f");break}case"G":case"P":b.l+=g[A].len;break;case"0":if(g[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[A].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=g,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=Ms(r(o,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function a(o,l){try{return ra(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Lr(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Eu(),d=Du(o,{header:1,raw:!0,cellDates:!0}),h=d[0],x=d.slice(1),p=o["!cols"]||[],m=0,v=0,y=0,w=1;for(m=0;m<h.length;++m){if(((p[m]||{}).DBF||{}).name){h[m]=p[m].DBF.name,++y;continue}if(h[m]!=null){if(++y,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(v=0;v<1024;++v)if(h.indexOf(h[m]+"_"+v)==-1){h[m]+="_"+v;break}}}}var g=Qe(o["!ref"]),S=[],k=[],T=[];for(m=0;m<=g.e.c-g.s.c;++m){var _="",A="",b=0,R=[];for(v=0;v<x.length;++v)x[v][m]!=null&&R.push(x[v][m]);if(R.length==0||h[m]==null){S[m]="?";continue}for(v=0;v<R.length;++v){switch(typeof R[v]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=R[v]instanceof Date?"D":"C";break;default:A="C"}b=Math.max(b,String(R[v]).length),_=_&&_!=A?"C":A}b>250&&(b=250),A=((p[m]||{}).DBF||{}).type,A=="C"&&p[m].DBF.len>b&&(b=p[m].DBF.len),_=="B"&&A=="N"&&(_="N",T[m]=p[m].DBF.dec,b=p[m].DBF.len),k[m]=_=="C"||A=="N"?b:s[_]||0,w+=k[m],S[m]=_}var L=f.next(32);for(L.write_shift(4,318902576),L.write_shift(4,x.length),L.write_shift(2,296+32*y),L.write_shift(2,w),m=0;m<4;++m)L.write_shift(4,0);for(L.write_shift(4,0|(+t[L1]||3)<<8),m=0,v=0;m<h.length;++m)if(h[m]!=null){var I=f.next(32),H=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,H,"sbcs"),I.write_shift(1,S[m]=="?"?"C":S[m],"sbcs"),I.write_shift(4,v),I.write_shift(1,k[m]||s[S[m]]||0),I.write_shift(1,T[m]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),v+=k[m]||s[S[m]]||0}var Z=f.next(264);for(Z.write_shift(4,13),m=0;m<65;++m)Z.write_shift(4,0);for(m=0;m<x.length;++m){var X=f.next(w);for(X.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(S[v]){case"L":X.write_shift(1,x[m][v]==null?63:x[m][v]?84:70);break;case"B":X.write_shift(8,x[m][v]||0,"f");break;case"N":var ee="0";for(typeof x[m][v]=="number"&&(ee=x[m][v].toFixed(T[v]||0)),y=0;y<k[v]-ee.length;++y)X.write_shift(1,32);X.write_shift(1,ee,"sbcs");break;case"D":x[m][v]?(X.write_shift(4,("0000"+x[m][v].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(x[m][v].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+x[m][v].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(x[m][v]!=null?x[m][v]:"").slice(0,k[v]);for(X.write_shift(1,oe,"sbcs"),y=0;y<k[v]-oe.length;++y)X.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),gT=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Qr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,x){var p=e[x];return typeof p=="number"?zh(p):p},n=function(h,x,p){var m=x.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?h:zh(m)};e["|"]=254;function a(h,x){switch(x.type){case"base64":return s(ur(h),x);case"binary":return s(h,x);case"buffer":return s(Ae&&Buffer.isBuffer(h)?h.toString("binary"):Pa(h),x);case"array":return s(Na(h),x)}throw new Error("Unrecognized type "+x.type)}function s(h,x){var p=h.split(/[\n\r]+/),m=-1,v=-1,y=0,w=0,g=[],S=[],k=null,T={},_=[],A=[],b=[],R=0,L;for(+x.codepage>=0&&Lr(+x.codepage);y!==p.length;++y){R=0;var I=p[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),H=I.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),Z=H[0],X;if(I.length>0)switch(Z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&S.push(I.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,oe=!1,te=!1,U=!1,q=-1,se=-1;for(w=1;w<H.length;++w)switch(H[w].charAt(0)){case"A":break;case"X":v=parseInt(H[w].slice(1))-1,oe=!0;break;case"Y":for(m=parseInt(H[w].slice(1))-1,oe||(v=0),L=g.length;L<=m;++L)g[L]=[];break;case"K":X=H[w].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN($r(X))?isNaN(As(X).getDate())||(X=gt(X)):(X=$r(X),k!==null&&Rs(k)&&(X=gc(X))),ee=!0;break;case"E":U=!0;var j=ps(H[w].slice(1),{r:m,c:v});g[m][v]=[g[m][v],j];break;case"S":te=!0,g[m][v]=[g[m][v],"S5S"];break;case"G":break;case"R":q=parseInt(H[w].slice(1))-1;break;case"C":se=parseInt(H[w].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+I)}if(ee&&(g[m][v]&&g[m][v].length==2?g[m][v][0]=X:g[m][v]=X,k=null),te){if(U)throw new Error("SYLK shared formula cannot have own formula");var z=q>-1&&g[q][se];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");g[m][v][1]=qg(z[1],{r:m-q,c:v-se})}break;case"F":var M=0;for(w=1;w<H.length;++w)switch(H[w].charAt(0)){case"X":v=parseInt(H[w].slice(1))-1,++M;break;case"Y":for(m=parseInt(H[w].slice(1))-1,L=g.length;L<=m;++L)g[L]=[];break;case"M":R=parseInt(H[w].slice(1))/20;break;case"F":break;case"G":break;case"P":k=S[parseInt(H[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=H[w].slice(1).split(" "),L=parseInt(b[0],10);L<=parseInt(b[1],10);++L)R=parseInt(b[2],10),A[L-1]=R===0?{hidden:!0}:{wch:R},Fs(A[L-1]);break;case"C":v=parseInt(H[w].slice(1))-1,A[v]||(A[v]={});break;case"R":m=parseInt(H[w].slice(1))-1,_[m]||(_[m]={}),R>0?(_[m].hpt=R,_[m].hpx=Zi(R)):R===0&&(_[m].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+I)}M<1&&(k=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+I)}}return _.length>0&&(T["!rows"]=_),A.length>0&&(T["!cols"]=A),x&&x.sheetRows&&(g=g.slice(0,x.sheetRows)),[g,T]}function i(h,x){var p=a(h,x),m=p[0],v=p[1],y=Ms(m,x);return Qr(v).forEach(function(w){y[w]=v[w]}),y}function o(h,x){return ra(i(h,x),x)}function l(h,x,p,m){var v="C;Y"+(p+1)+";X"+(m+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+n3(h.f,{r:p,c:m}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(h,x){x.forEach(function(p,m){var v="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?v+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Gl(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Kl(p.wpx)),typeof p.wch=="number"&&(v+=Math.round(p.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function f(h,x){x.forEach(function(p,m){var v="F;";p.hidden?v+="M0;":p.hpt?v+="M"+20*p.hpt+";":p.hpx&&(v+="M"+20*Wg(p.hpx)+";"),v.length>2&&h.push(v+"R"+(m+1))})}function d(h,x){var p=["ID;PWXL;N;E"],m=[],v=Qe(h["!ref"]),y,w=Array.isArray(h),g=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&c(p,h["!cols"]),h["!rows"]&&f(p,h["!rows"]),p.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var S=v.s.r;S<=v.e.r;++S)for(var k=v.s.c;k<=v.e.c;++k){var T=ve({r:S,c:k});y=w?(h[S]||[])[k]:h[T],!(!y||y.v==null&&(!y.f||y.F))&&m.push(l(y,h,S,k))}return p.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),vT=function(){function e(s,i){switch(i.type){case"base64":return t(ur(s),i);case"binary":return t(s,i);case"buffer":return t(Ae&&Buffer.isBuffer(s)?s.toString("binary"):Pa(s),i);case"array":return t(Na(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[f].trim().split(","),x=h[0],p=h[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+x){case-1:if(m==="BOT"){d[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][c]=!0:m==="FALSE"?d[l][c]=!1:isNaN($r(p))?isNaN(As(p).getDate())?d[l][c]=p:d[l][c]=gt(p):d[l][c]=$r(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return Ms(e(s,i),i)}function n(s,i){return ra(r(s,i),i)}var a=function(){var s=function(l,c,f,d,h){l.push(c),l.push(f+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,f,d){l.push(c+","+f),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],f=Qe(l["!ref"]),d,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var x=f.s.r;x<=f.e.r;++x){i(c,-1,0,"BOT");for(var p=f.s.c;p<=f.e.c;++p){var m=ve({r:x,c:p});if(d=h?(l[x]||[])[p]:l[m],!d){i(c,1,0,"");continue}switch(d.t){case"n":var v=d.w;!v&&d.v!=null&&(v=d.v),v==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,v,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=br(d.z||ke[14],Wt(gt(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var y=`\r
`,w=c.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),yT=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var x=d.split(`
`),p=-1,m=-1,v=0,y=[];v!==x.length;++v){var w=x[v].trim().split(":");if(w[0]==="cell"){var g=Ht(w[1]);if(y.length<=g.r)for(p=y.length;p<=g.r;++p)y[p]||(y[p]=[]);switch(p=g.r,m=g.c,w[2]){case"t":y[p][m]=e(w[3]);break;case"v":y[p][m]=+w[3];break;case"vtf":var S=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[p][m]=!!+w[4];break;default:y[p][m]=+w[4];break}w[2]=="vtf"&&(y[p][m]=[y[p][m],S])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(d,h){return Ms(r(d,h),h)}function a(d,h){return ra(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],x=[],p,m="",v=Ls(d["!ref"]),y=Array.isArray(d),w=v.s.r;w<=v.e.r;++w)for(var g=v.s.c;g<=v.e.c;++g)if(m=ve({r:w,c:g}),p=y?(d[w]||[])[g]:d[m],!(!p||p.v==null||p.t==="z")){switch(x=["cell",m,"t"],p.t){case"s":case"str":x.push(t(p.v));break;case"n":p.f?(x[2]="vtf",x[3]="n",x[4]=p.v,x[5]=t(p.f)):(x[2]="v",x[3]=p.v);break;case"b":x[2]="vt"+(p.f?"f":"c"),x[3]="nl",x[4]=p.v?"1":"0",x[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var S=Wt(gt(p.v));x[2]="vtc",x[3]="nd",x[4]=""+S,x[5]=p.w||br(p.z||ke[14],S);break;case"e":continue}h.push(x.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[s,i,o,i,c(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Ji=function(){function e(f,d,h,x,p){p.raw?d[h][x]=f:f===""||(f==="TRUE"?d[h][x]=!0:f==="FALSE"?d[h][x]=!1:isNaN($r(f))?isNaN(As(f).getDate())?d[h][x]=f:d[h][x]=gt(f):d[h][x]=$r(f))}function t(f,d){var h=d||{},x=[];if(!f||f.length===0)return x;for(var p=f.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var v=10,y=0,w=0;w<=m;++w)y=p[w].indexOf(" "),y==-1?y=p[w].length:y++,v=Math.max(v,y);for(w=0;w<=m;++w){x[w]=[];var g=0;for(e(p[w].slice(0,v).trim(),x,w,g,h),g=1;g<=(p[w].length-v)/10+1;++g)e(p[w].slice(v+(g-1)*10,v+g*10).trim(),x,w,g,h)}return h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,x=0,p=0;x<f.length;++x)(p=f.charCodeAt(x))==34?h=!h:!h&&p in r&&(d[p]=(d[p]||0)+1);p=[];for(x in d)Object.prototype.hasOwnProperty.call(d,x)&&p.push([d[x],x]);if(!p.length){d=n;for(x in d)Object.prototype.hasOwnProperty.call(d,x)&&p.push([d[x],x])}return p.sort(function(m,v){return m[0]-v[0]||n[m[1]]-n[v[1]]}),r[p.pop()[1]]||44}function s(f,d){var h=d||{},x="",p=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(x=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(x=f.charAt(4),f=f.slice(6)):x=a(f.slice(0,1024)):h&&h.FS?x=h.FS:x=a(f.slice(0,1024));var v=0,y=0,w=0,g=0,S=0,k=x.charCodeAt(0),T=!1,_=0,A=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var b=h.dateNF!=null?FE(h.dateNF):null;function R(){var L=f.slice(g,S),I={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)I.t="z";else if(h.raw)I.t="s",I.v=L;else if(L.trim().length===0)I.t="s",I.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(I.t="s",I.v=L.slice(2,-1).replace(/""/g,'"')):s3(L)?(I.t="n",I.f=L.slice(1)):(I.t="s",I.v=L);else if(L=="TRUE")I.t="b",I.v=!0;else if(L=="FALSE")I.t="b",I.v=!1;else if(!isNaN(w=$r(L)))I.t="n",h.cellText!==!1&&(I.w=L),I.v=w;else if(!isNaN(As(L).getDate())||b&&L.match(b)){I.z=h.dateNF||ke[14];var H=0;b&&L.match(b)&&(L=jE(L,h.dateNF,L.match(b)||[]),H=1),h.cellDates?(I.t="d",I.v=gt(L,H)):(I.t="n",I.v=Wt(gt(L,H))),h.cellText!==!1&&(I.w=br(I.z,I.v instanceof Date?Wt(I.v):I.v)),h.cellNF||delete I.z}else I.t="s",I.v=L;if(I.t=="z"||(h.dense?(p[v]||(p[v]=[]),p[v][y]=I):p[ve({c:y,r:v})]=I),g=S+1,A=f.charCodeAt(g),m.e.c<y&&(m.e.c=y),m.e.r<v&&(m.e.r=v),_==k)++y;else if(y=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;S<f.length;++S)switch(_=f.charCodeAt(S)){case 34:A===34&&(T=!T);break;case k:case 10:case 13:if(!T&&R())break e;break}return S-g>0&&R(),p["!ref"]=je(m),p}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):Ms(t(f,d),d)}function o(f,d){var h="",x=d.type=="string"?[0,0,0,0]:id(f,d);switch(d.type){case"base64":h=ur(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof On<"u"?h=On.utils.decode(d.codepage,f):h=Ae&&Buffer.isBuffer(f)?f.toString("binary"):Pa(f);break;case"array":h=Na(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return x[0]==239&&x[1]==187&&x[2]==191?h=Me(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=Me(h):d.type=="binary"&&typeof On<"u"&&d.codepage&&(h=On.utils.decode(d.codepage,On.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?yT.to_sheet(d.type=="string"?h:Me(h),d):i(h,d)}function l(f,d){return ra(o(f,d),d)}function c(f){for(var d=[],h=Qe(f["!ref"]),x,p=Array.isArray(f),m=h.s.r;m<=h.e.r;++m){for(var v=[],y=h.s.c;y<=h.e.c;++y){var w=ve({r:m,c:y});if(x=p?(f[m]||[])[y]:f[w],!x||x.v==null){v.push("          ");continue}for(var g=(x.w||(vn(x),x.w)||"").slice(0,10);g.length<10;)g+=" ";v.push(g+(y===0?" ":""))}d.push(v.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function wT(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=gT.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ji.to_workbook(e,t)}}var Ti=function(){function e(j,z,M){if(j){yt(j,j.l||0);for(var B=M.Enum||q;j.l<j.length;){var J=j.read_shift(2),ie=B[J]||B[65535],ue=j.read_shift(2),ce=j.l+ue,re=ie.f&&ie.f(j,ue,M);if(j.l=ce,z(re,ie,J))return}}}function t(j,z){switch(z.type){case"base64":return r(Rr(ur(j)),z);case"binary":return r(Rr(j),z);case"buffer":case"array":return r(j,z)}throw"Unsupported type "+z.type}function r(j,z){if(!j)return j;var M=z||{},B=M.dense?[]:{},J="Sheet1",ie="",ue=0,ce={},re=[],Se=[],P={s:{r:0,c:0},e:{r:0,c:0}},ze=M.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)M.Enum=q,e(j,function(de,Ve,qt){switch(qt){case 0:M.vers=de,de>=4096&&(M.qpro=!0);break;case 6:P=de;break;case 204:de&&(ie=de);break;case 222:ie=de;break;case 15:case 51:M.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:qt==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=M.dateNF||ke[14],M.cellDates&&(de[1].t="d",de[1].v=gc(de[1].v))),M.qpro&&de[3]>ue&&(B["!ref"]=je(P),ce[J]=B,re.push(J),B=M.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},ue=de[3],J=ie||"Sheet"+(ue+1),ie="");var hr=M.dense?(B[de[0].r]||[])[de[0].c]:B[ve(de[0])];if(hr){hr.t=de[1].t,hr.v=de[1].v,de[1].z!=null&&(hr.z=de[1].z),de[1].f!=null&&(hr.f=de[1].f);break}M.dense?(B[de[0].r]||(B[de[0].r]=[]),B[de[0].r][de[0].c]=de[1]):B[ve(de[0])]=de[1];break}},M);else if(j[2]==26||j[2]==14)M.Enum=se,j[2]==14&&(M.qpro=!0,j.l=0),e(j,function(de,Ve,qt){switch(qt){case 204:J=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>ue&&(B["!ref"]=je(P),ce[J]=B,re.push(J),B=M.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},ue=de[3],J="Sheet"+(ue+1)),ze>0&&de[0].r>=ze)break;M.dense?(B[de[0].r]||(B[de[0].r]=[]),B[de[0].r][de[0].c]=de[1]):B[ve(de[0])]=de[1],P.e.c<de[0].c&&(P.e.c=de[0].c),P.e.r<de[0].r&&(P.e.r=de[0].r);break;case 27:de[14e3]&&(Se[de[14e3][0]]=de[14e3][1]);break;case 1537:Se[de[0]]=de[1],de[0]==ue&&(J=de[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(B["!ref"]=je(P),ce[ie||J]=B,re.push(ie||J),!Se.length)return{SheetNames:re,Sheets:ce};for(var Ce={},Pe=[],Ee=0;Ee<Se.length;++Ee)ce[re[Ee]]?(Pe.push(Se[Ee]||re[Ee]),Ce[Se[Ee]]=ce[Se[Ee]]||ce[re[Ee]]):(Pe.push(Se[Ee]),Ce[Se[Ee]]={"!ref":"A1"});return{SheetNames:Pe,Sheets:Ce}}function n(j,z){var M=z||{};if(+M.codepage>=0&&Lr(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Eu(),J=Qe(j["!ref"]),ie=Array.isArray(j),ue=[];Fr(B,0,s(1030)),Fr(B,6,l(J));for(var ce=Math.min(J.e.r,8191),re=J.s.r;re<=ce;++re)for(var Se=kt(re),P=J.s.c;P<=J.e.c;++P){re===J.s.r&&(ue[P]=dt(P));var ze=ue[P]+Se,Ce=ie?(j[re]||[])[P]:j[ze];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?Fr(B,13,x(re,P,Ce.v)):Fr(B,14,m(re,P,Ce.v));else{var Pe=vn(Ce);Fr(B,15,d(re,P,Pe.slice(0,239)))}}return Fr(B,1),B.end()}function a(j,z){var M=z||{};if(+M.codepage>=0&&Lr(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Eu();Fr(B,0,i(j));for(var J=0,ie=0;J<j.SheetNames.length;++J)(j.Sheets[j.SheetNames[J]]||{})["!ref"]&&Fr(B,27,U(j.SheetNames[J],ie++));var ue=0;for(J=0;J<j.SheetNames.length;++J){var ce=j.Sheets[j.SheetNames[J]];if(!(!ce||!ce["!ref"])){for(var re=Qe(ce["!ref"]),Se=Array.isArray(ce),P=[],ze=Math.min(re.e.r,8191),Ce=re.s.r;Ce<=ze;++Ce)for(var Pe=kt(Ce),Ee=re.s.c;Ee<=re.e.c;++Ee){Ce===re.s.r&&(P[Ee]=dt(Ee));var de=P[Ee]+Pe,Ve=Se?(ce[Ce]||[])[Ee]:ce[de];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")Fr(B,23,R(Ce,Ee,ue,Ve.v));else{var qt=vn(Ve);Fr(B,22,_(Ce,Ee,ue,qt.slice(0,239)))}}++ue}}return Fr(B,1),B.end()}function s(j){var z=ct(2);return z.write_shift(2,j),z}function i(j){var z=ct(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var M=0,B=0,J=0,ie=0;ie<j.SheetNames.length;++ie){var ue=j.SheetNames[ie],ce=j.Sheets[ue];if(!(!ce||!ce["!ref"])){++J;var re=Ls(ce["!ref"]);M<re.e.r&&(M=re.e.r),B<re.e.c&&(B=re.e.c)}}return M>8191&&(M=8191),z.write_shift(2,M),z.write_shift(1,J),z.write_shift(1,B),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(j,z,M){var B={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&M.qpro?(B.s.c=j.read_shift(1),j.l++,B.s.r=j.read_shift(2),B.e.c=j.read_shift(1),j.l++,B.e.r=j.read_shift(2),B):(B.s.c=j.read_shift(2),B.s.r=j.read_shift(2),z==12&&M.qpro&&(j.l+=2),B.e.c=j.read_shift(2),B.e.r=j.read_shift(2),z==12&&M.qpro&&(j.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(j){var z=ct(8);return z.write_shift(2,j.s.c),z.write_shift(2,j.s.r),z.write_shift(2,j.e.c),z.write_shift(2,j.e.r),z}function c(j,z,M){var B=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(B[0].c=j.read_shift(1),B[3]=j.read_shift(1),B[0].r=j.read_shift(2),j.l+=2):(B[2]=j.read_shift(1),B[0].c=j.read_shift(2),B[0].r=j.read_shift(2)),B}function f(j,z,M){var B=j.l+z,J=c(j,z,M);if(J[1].t="s",M.vers==20768){j.l++;var ie=j.read_shift(1);return J[1].v=j.read_shift(ie,"utf8"),J}return M.qpro&&j.l++,J[1].v=j.read_shift(B-j.l,"cstr"),J}function d(j,z,M){var B=ct(7+M.length);B.write_shift(1,255),B.write_shift(2,z),B.write_shift(2,j),B.write_shift(1,39);for(var J=0;J<B.length;++J){var ie=M.charCodeAt(J);B.write_shift(1,ie>=128?95:ie)}return B.write_shift(1,0),B}function h(j,z,M){var B=c(j,z,M);return B[1].v=j.read_shift(2,"i"),B}function x(j,z,M){var B=ct(7);return B.write_shift(1,255),B.write_shift(2,z),B.write_shift(2,j),B.write_shift(2,M,"i"),B}function p(j,z,M){var B=c(j,z,M);return B[1].v=j.read_shift(8,"f"),B}function m(j,z,M){var B=ct(13);return B.write_shift(1,255),B.write_shift(2,z),B.write_shift(2,j),B.write_shift(8,M,"f"),B}function v(j,z,M){var B=j.l+z,J=c(j,z,M);if(J[1].v=j.read_shift(8,"f"),M.qpro)j.l=B;else{var ie=j.read_shift(2);S(j.slice(j.l,j.l+ie),J),j.l+=ie}return J}function y(j,z,M){var B=z&32768;return z&=-32769,z=(B?j:0)+(z>=8192?z-16384:z),(B?"":"$")+(M?dt(z):kt(z))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(j,z){yt(j,0);for(var M=[],B=0,J="",ie="",ue="",ce="";j.l<j.length;){var re=j[j.l++];switch(re){case 0:M.push(j.read_shift(8,"f"));break;case 1:ie=y(z[0].c,j.read_shift(2),!0),J=y(z[0].r,j.read_shift(2),!1),M.push(ie+J);break;case 2:{var Se=y(z[0].c,j.read_shift(2),!0),P=y(z[0].r,j.read_shift(2),!1);ie=y(z[0].c,j.read_shift(2),!0),J=y(z[0].r,j.read_shift(2),!1),M.push(Se+P+":"+ie+J)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(j.read_shift(2));break;case 6:{for(var ze="";re=j[j.l++];)ze+=String.fromCharCode(re);M.push('"'+ze.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ce=M.pop(),ue=M.pop(),M.push(["AND","OR"][re-20]+"("+ue+","+ce+")");break;default:if(re<32&&g[re])ce=M.pop(),ue=M.pop(),M.push(ue+g[re]+ce);else if(w[re]){if(B=w[re][1],B==69&&(B=j[j.l++]),B>M.length){console.error("WK1 bad formula parse 0x"+re.toString(16)+":|"+M.join("|")+"|");return}var Ce=M.slice(-B);M.length-=B,M.push(w[re][0]+"("+Ce.join(",")+")")}else return re<=7?console.error("WK1 invalid opcode "+re.toString(16)):re<=24?console.error("WK1 unsupported op "+re.toString(16)):re<=30?console.error("WK1 invalid opcode "+re.toString(16)):re<=115?console.error("WK1 unsupported function opcode "+re.toString(16)):console.error("WK1 unrecognized opcode "+re.toString(16))}}M.length==1?z[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function k(j){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=j.read_shift(2),z[3]=j[j.l++],z[0].c=j[j.l++],z}function T(j,z){var M=k(j);return M[1].t="s",M[1].v=j.read_shift(z-4,"cstr"),M}function _(j,z,M,B){var J=ct(6+B.length);J.write_shift(2,j),J.write_shift(1,M),J.write_shift(1,z),J.write_shift(1,39);for(var ie=0;ie<B.length;++ie){var ue=B.charCodeAt(ie);J.write_shift(1,ue>=128?95:ue)}return J.write_shift(1,0),J}function A(j,z){var M=k(j);M[1].v=j.read_shift(2);var B=M[1].v>>1;if(M[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return M[1].v=B,M}function b(j,z){var M=k(j),B=j.read_shift(4),J=j.read_shift(4),ie=j.read_shift(2);if(ie==65535)return B===0&&J===3221225472?(M[1].t="e",M[1].v=15):B===0&&J===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var ue=ie&32768;return ie=(ie&32767)-16446,M[1].v=(1-ue*2)*(J*Math.pow(2,ie+32)+B*Math.pow(2,ie)),M}function R(j,z,M,B){var J=ct(14);if(J.write_shift(2,j),J.write_shift(1,M),J.write_shift(1,z),B==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var ie=0,ue=0,ce=0,re=0;return B<0&&(ie=1,B=-B),ue=Math.log2(B)|0,B/=Math.pow(2,ue-31),re=B>>>0,re&2147483648||(B/=2,++ue,re=B>>>0),B-=re,re|=2147483648,re>>>=0,B*=Math.pow(2,32),ce=B>>>0,J.write_shift(4,ce),J.write_shift(4,re),ue+=16383+(ie?32768:0),J.write_shift(2,ue),J}function L(j,z){var M=b(j);return j.l+=z-14,M}function I(j,z){var M=k(j),B=j.read_shift(4);return M[1].v=B>>6,M}function H(j,z){var M=k(j),B=j.read_shift(8,"f");return M[1].v=B,M}function Z(j,z){var M=H(j);return j.l+=z-10,M}function X(j,z){return j[j.l+z-1]==0?j.read_shift(z,"cstr"):""}function ee(j,z){var M=j[j.l++];M>z-1&&(M=z-1);for(var B="";B.length<M;)B+=String.fromCharCode(j[j.l++]);return B}function oe(j,z,M){if(!(!M.qpro||z<21)){var B=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var J=j.read_shift(z-21,"cstr");return[B,J]}}function te(j,z){for(var M={},B=j.l+z;j.l<B;){var J=j.read_shift(2);if(J==14e3){for(M[J]=[0,""],M[J][0]=j.read_shift(2);j[j.l];)M[J][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return M}function U(j,z){var M=ct(5+j.length);M.write_shift(2,14e3),M.write_shift(2,z);for(var B=0;B<j.length;++B){var J=j.charCodeAt(B);M[M.l++]=J>127?95:J}return M[M.l++]=0,M}var q={0:{n:"BOF",f:at},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:Z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function _T(e){var t={},r=e.match(Rt),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=ge(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Rf[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var kT=function(){var e=Xi("t"),t=Xi("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:De(i[1])},l=s.match(t);return l&&(o.s=_T(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),ET=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),ST=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,TT=/<(?:\w+:)?r>/,bT=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Zf(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=De(Me(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Me(e),r&&(n.h=zf(n.t))):e.match(TT)&&(n.r=Me(e),n.t=De(Me((e.replace(bT,"").match(ST)||[]).join("").replace(Rt,""))),r&&(n.h=ET(kT(n.r)))),n):{t:""}}var NT=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,CT=/<(?:\w+:)?(?:si|sstItem)>/g,AT=/<\/(?:\w+:)?(?:si|sstItem)>/;function FT(e,t){var r=[],n="";if(!e)return r;var a=e.match(NT);if(a){n=a[2].replace(CT,"").split(AT);for(var s=0;s!=n.length;++s){var i=Zf(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=ge(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function jT(e){return[e.read_shift(4),e.read_shift(4)]}function OT(e,t){var r=[],n=!1;return wn(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Bg(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function hn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function DT(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=hn(e,4),t.U=hn(e,4),t.W=hn(e,4),t}function PT(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function IT(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(PT(e));return t}function RT(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function LT(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=hn(e,4),t.U=hn(e,4),t.W=hn(e,4),t}function MT(e){var t=LT(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Ug(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function $g(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function BT(e){var t=hn(e);switch(t.Minor){case 2:return[t.Minor,UT(e)];case 3:return[t.Minor,$T()];case 4:return[t.Minor,HT(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function UT(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Ug(e,r),a=$g(e,e.length-e.l);return{t:"Std",h:n,v:a}}function $T(){throw new Error("File is password-protected: ECMA-376 Extensible")}function HT(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Rt,function(s){var i=ge(s);switch(Zr(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function zT(e,t){var r={},n=r.EncryptionVersionInfo=hn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Ug(e,a),t-=a,r.EncryptionVerifier=$g(e,t),r}function VT(e){var t={},r=t.EncryptionVersionInfo=hn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function WT(e){var t=0,r,n=Bg(e),a=n.length+1,s,i,o,l,c;for(r=Yn(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var Hg=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=Bg(i),l=s(o),c=o.length,f=Yn(16),d=0;d!=16;++d)f[d]=0;var h,x,p;for((c&1)===1&&(h=l>>8,f[c]=a(e[0],h),--c,h=l&255,x=o[o.length-1],f[c]=a(x,h));c>0;)--c,h=l>>8,f[c]=a(o[c],h),--c,h=l&255,f[c]=a(o[c],h);for(c=15,p=15-o.length;p>0;)h=l>>8,f[c]=a(e[p],h),--c,--p,h=l&255,f[c]=a(o[c],h),--c,--p;return f}}(),GT=function(e,t,r,n,a){a||(a=t),n||(n=Hg(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},KT=function(e){var t=0,r=Hg(e);return function(n){var a=GT("",n,t,r);return t=a[1],a[0]}};function qT(e,t,r,n){var a={key:at(e),verificationBytes:at(e)};return r.password&&(a.verifier=WT(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=KT(r.password)),a}function XT(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=VT(e):n.Data=zT(e,t),n}function YT(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?XT(e,t-2,n):qT(e,r.biff>=8?t:t-2,r,n),n}var JT=function(){function e(a,s){switch(s.type){case"base64":return t(ur(a),s);case"binary":return t(a,s);case"buffer":return t(Ae&&Buffer.isBuffer(a)?a.toString("binary"):Pa(a),s);case"array":return t(Na(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,x=0,p,m=-1;p=h.exec(f);){switch(p[0]){case"\\cell":var v=f.slice(x,h.lastIndex-p[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var y={v,t:"s"};Array.isArray(o)?o[d][m]=y:o[ve({r:d,c:m})]=y}break}x=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=je(c),o}function r(a,s){return ra(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Qe(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=ve({r:c,c:f});o=l?(a[c]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(vn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function QT(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Qi(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function ZT(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function eb(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Wl(e,t){if(t===0)return e;var r=ZT(QT(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Qi(eb(r))}var zg=6,tb=15,rb=1,$t=zg;function Gl(e){return Math.floor((e+Math.round(128/$t)/256)*$t)}function Kl(e){return Math.floor((e-5)/$t*100+.5)/100}function Nu(e){return Math.round((e*$t+5)/$t*256)/256}function l0(e){return Nu(Kl(Gl(e)))}function ed(e){var t=Math.abs(e-l0(e)),r=$t;if(t>.005)for($t=rb;$t<tb;++$t)Math.abs(e-l0(e))<=t&&(t=Math.abs(e-l0(e)),r=$t);$t=r}function Fs(e){e.width?(e.wpx=Gl(e.width),e.wch=Kl(e.wpx),e.MDW=$t):e.wpx?(e.wch=Kl(e.wpx),e.width=Nu(e.wch),e.MDW=$t):typeof e.wch=="number"&&(e.width=Nu(e.wch),e.wpx=Gl(e.width),e.MDW=$t),e.customWidth&&delete e.customWidth}var nb=96,Vg=nb;function Wg(e){return e*96/Vg}function Zi(e){return e*Vg/96}var ab={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function sb(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Rt)||[]).forEach(function(i){var o=ge(i);switch(Zr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=$e(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=$e(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function ib(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Rt)||[]).forEach(function(i){var o=ge(i);switch(Zr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function ob(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Rt)||[]).forEach(function(i){var o=ge(i);switch(Zr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Me(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?$e(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?$e(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?$e(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?$e(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?$e(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?$e(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?$e(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Rf[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=$e(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=wa[a.color.index];a.color.index==81&&(l=wa[1]),l||(l=wa[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Wl(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function lb(e,t,r){t.NumberFmt=[];for(var n=Qr(ke),a=0;a<n.length;++a)t.NumberFmt[n[a]]=ke[n[a]];var s=e[0].match(Rt);if(s)for(a=0;a<s.length;++a){var i=ge(s[a]);switch(Zr(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=De(Me(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ya(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Go=["numFmtId","fillId","fontId","borderId","xfId"],Ko=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function cb(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Rt)||[]).forEach(function(s){var i=ge(s),o=0;switch(Zr(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Go.length;++o)n[Go[o]]&&(n[Go[o]]=parseInt(n[Go[o]],10));for(o=0;o<Ko.length;++o)n[Ko[o]]&&(n[Ko[o]]=$e(n[Ko[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=$e(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var ub=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&lb(d,f,c),(d=o.match(a))&&ob(d,f,l,c),(d=o.match(n))&&ib(d,f,l,c),(d=o.match(s))&&sb(d,f,l,c),(d=o.match(r))&&cb(d,f,c),f}}();function fb(e,t){var r=e.read_shift(2),n=Ot(e);return[r,n]}function db(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=k4(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=_4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ot(e),n}var hb=It;function xb(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var mb=It;function pb(e,t,r){var n={};n.NumberFmt=[];for(var a in ke)n.NumberFmt[a]=ke[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return wn(e,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],ya(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Wl(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var gb=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function vb(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Rt)||[]).forEach(function(a){var s=ge(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[gb.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function yb(){}function wb(){}var _b=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kb=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Eb=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Sb(e,t,r){t.themeElements={};var n;[["clrScheme",_b,vb],["fontScheme",kb,yb],["fmtScheme",Eb,wb]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Tb=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Gg(e,t){(!e||e.length===0)&&(e=bb());var r,n={};if(!(r=e.match(Tb)))throw new Error("themeElements not found in theme");return Sb(r[0],n,t),n.raw=e,n}function bb(e,t){var r=[ng];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Nb(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=rg(s,{type:"array"})}catch{return}var o=ir(i,"theme/theme/theme1.xml",!0);if(o)return Gg(o,r)}}function Cb(e){return e.read_shift(4)}function Ab(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Fb(e,4);break;case 2:t.xclrValue=Og(e);break;case 3:t.xclrValue=Cb(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Fb(e,t){return It(e,t)}function jb(e,t){return It(e,t)}function Ob(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Ab(e);break;case 6:n[1]=jb(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Db(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(Ob(e,r-e.l));return{ixfe:n,ext:s}}function Pb(e,t){t.forEach(function(r){switch(r[0]){}})}function Ib(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ot(e)}}function Rb(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Lb(e){return e.l+=4,e.read_shift(4)!=0}function Mb(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return wn(e,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Bb(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Rt,function(o){var l=ge(o);switch(Zr(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Ub(e){var t=[];if(!e)return t;var r=1;return(e.match(Rt)||[]).forEach(function(n){var a=ge(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function $b(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ve(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Hb(e,t,r){var n=[];return wn(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function zb(e,t,r,n){if(!e)return e;var a=n||{},s=!1;wn(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function Vb(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Cx(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Ht(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=Qe(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=je(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function Wb(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ge(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Ht(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Zf(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function Gb(e,t){var r=[],n=!1,a={},s=0;return e.replace(Rt,function(o,l){var c=ge(o);switch(Zr(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Kb(e,t){var r=[],n=!1;return e.replace(Rt,function(s){var i=ge(s);switch(Zr(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function qb(e){var t={};t.iauthor=e.read_shift(4);var r=Ra(e);return t.rfx=r.s,t.ref=ve(r.s),e.l+=16,t}var Xb=Ot;function Yb(e,t){var r=[],n=[],a={},s=!1;return wn(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Jb="application/vnd.ms-office.vbaProject";function Qb(e){var t=Fe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Fe.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Fe.write(t)}function Zb(){return{"!type":"dialog"}}function e3(){return{"!type":"dialog"}}function t3(){return{"!type":"macro"}}function r3(){return{"!type":"macro"}}var ps=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,a+(o?"":"$")+dt(f)+(l?"":"$")+kt(c)}return function(a,s){return t=s,a.replace(e,r)}}(),Kg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,n3=function(){return function(t,r){return t.replace(Kg,function(n,a,s,i,o,l){var c=Kf(i)-(s?0:r.c),f=Gf(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+d+"C"+h})}}();function qg(e,t){return e.replace(Kg,function(r,n,a,s,i,o){return n+(a=="$"?a+s:dt(Kf(s)+t.c))+(i=="$"?i+o:kt(Gf(o)+t.r))})}function a3(e,t,r){var n=Ls(t),a=n.s,s=Ht(r),i={r:s.r-a.r,c:s.c-a.c};return qg(e,i)}function s3(e){return e.length!=1}function Ax(e){return e.replace(/_xlfn\./g,"")}function rt(e){e.l+=1}function Jn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Xg(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Yg(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Jn(e),o=Jn(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Yg(e){var t=Jn(e),r=Jn(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function i3(e,t,r){if(r.biff<8)return Yg(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=Jn(e),i=Jn(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function Jg(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return o3(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Jn(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function o3(e){var t=Jn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function l3(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function c3(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return u3(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function u3(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function f3(e,t,r){var n=(e[e.l++]&96)>>5,a=Xg(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function d3(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=Xg(e,s,r);return[n,a,i]}function h3(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function x3(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function m3(e,t,r){var n=(e[e.l++]&96)>>5,a=i3(e,t-1,r);return[n,a]}function p3(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Fx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function g3(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function v3(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function y3(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function w3(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function _3(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Qg(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function k3(e){return e.read_shift(2),Qg(e)}function E3(e){return e.read_shift(2),Qg(e)}function S3(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Jg(e,0,r);return[n,a]}function T3(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=c3(e,0,r);return[n,a]}function b3(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Jg(e,0,r);return[n,a,s]}function N3(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[CN[a],tv[a],n]}function C3(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:A3(e);return[a,(s[0]===0?tv:NN)[s[1]]]}function A3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function F3(e,t,r){e.l+=r&&r.biff==2?3:4}function j3(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function O3(e){return e.l++,La[e.read_shift(1)]}function D3(e){return e.l++,e.read_shift(2)}function P3(e){return e.l++,e.read_shift(1)!==0}function I3(e){return e.l++,Ft(e)}function R3(e,t,r){return e.l++,fo(e,t-1,r)}function L3(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=et(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=La[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ft(e);break;case 2:r[1]=Ma(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function M3(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Ra:vc)(e));return a}function B3(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=L3(e,r.biff);return i}function U3(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function $3(e,t,r){if(r.biff==5)return H3(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function H3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function z3(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function V3(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function W3(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function G3(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var K3=It,q3=It,X3=It;function xo(e,t,r){return e.l+=2,[l3(e)]}function td(e){return e.l+=6,[]}var Y3=xo,J3=td,Q3=td,Z3=xo;function Zg(e){return e.l+=2,[at(e),e.read_shift(2)&1]}var eN=xo,tN=Zg,rN=td,nN=xo,aN=xo,sN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function iN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=sN[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function oN(e){return e.l+=2,[e.read_shift(4)]}function lN(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function cN(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function uN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function fN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dN(e){return e.l+=4,[0,0]}var jx={1:{n:"PtgExp",f:j3},2:{n:"PtgTbl",f:X3},3:{n:"PtgAdd",f:rt},4:{n:"PtgSub",f:rt},5:{n:"PtgMul",f:rt},6:{n:"PtgDiv",f:rt},7:{n:"PtgPower",f:rt},8:{n:"PtgConcat",f:rt},9:{n:"PtgLt",f:rt},10:{n:"PtgLe",f:rt},11:{n:"PtgEq",f:rt},12:{n:"PtgGe",f:rt},13:{n:"PtgGt",f:rt},14:{n:"PtgNe",f:rt},15:{n:"PtgIsect",f:rt},16:{n:"PtgUnion",f:rt},17:{n:"PtgRange",f:rt},18:{n:"PtgUplus",f:rt},19:{n:"PtgUminus",f:rt},20:{n:"PtgPercent",f:rt},21:{n:"PtgParen",f:rt},22:{n:"PtgMissArg",f:rt},23:{n:"PtgStr",f:R3},26:{n:"PtgSheet",f:lN},27:{n:"PtgEndSheet",f:cN},28:{n:"PtgErr",f:O3},29:{n:"PtgBool",f:P3},30:{n:"PtgInt",f:D3},31:{n:"PtgNum",f:I3},32:{n:"PtgArray",f:p3},33:{n:"PtgFunc",f:N3},34:{n:"PtgFuncVar",f:C3},35:{n:"PtgName",f:U3},36:{n:"PtgRef",f:S3},37:{n:"PtgArea",f:f3},38:{n:"PtgMemArea",f:z3},39:{n:"PtgMemErr",f:K3},40:{n:"PtgMemNoMem",f:q3},41:{n:"PtgMemFunc",f:V3},42:{n:"PtgRefErr",f:W3},43:{n:"PtgAreaErr",f:h3},44:{n:"PtgRefN",f:T3},45:{n:"PtgAreaN",f:m3},46:{n:"PtgMemAreaN",f:uN},47:{n:"PtgMemNoMemN",f:fN},57:{n:"PtgNameX",f:$3},58:{n:"PtgRef3d",f:b3},59:{n:"PtgArea3d",f:d3},60:{n:"PtgRefErr3d",f:G3},61:{n:"PtgAreaErr3d",f:x3},255:{}},hN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xN={1:{n:"PtgElfLel",f:Zg},2:{n:"PtgElfRw",f:nN},3:{n:"PtgElfCol",f:Y3},6:{n:"PtgElfRwV",f:aN},7:{n:"PtgElfColV",f:Z3},10:{n:"PtgElfRadical",f:eN},11:{n:"PtgElfRadicalS",f:rN},13:{n:"PtgElfColS",f:J3},15:{n:"PtgElfColSV",f:Q3},16:{n:"PtgElfRadicalLel",f:tN},25:{n:"PtgList",f:iN},29:{n:"PtgSxName",f:oN},255:{}},mN={0:{n:"PtgAttrNoop",f:dN},1:{n:"PtgAttrSemi",f:_3},2:{n:"PtgAttrIf",f:y3},4:{n:"PtgAttrChoose",f:g3},8:{n:"PtgAttrGoto",f:v3},16:{n:"PtgAttrSum",f:F3},32:{n:"PtgAttrBaxcel",f:Fx},33:{n:"PtgAttrBaxcel",f:Fx},64:{n:"PtgAttrSpace",f:k3},65:{n:"PtgAttrSpaceSemi",f:E3},128:{n:"PtgAttrIfError",f:w3},255:{}};function mo(e,t,r,n){if(n.biff<8)return It(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=B3(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=M3(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(It(e,t)),s}function po(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=jx[s]||jx[hN[s]],(s===24||s===25)&&(a=(s===24?xN:mN)[e[e.l+1]]),!a||!a.f?It(e,t):i.push([a.n,a.f(e,t,r)]);return i}function pN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var gN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ev(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ox(e,t,r){var n=ev(e,t,r);return n=="#REF"?n:vN(n,r)}function Ct(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,f,d=0,h=0,x,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",y=0,w=e[0].length;y<w;++y){var g=e[0][y];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=Je(" ",e[0][m][1][1]);break;case 1:v=Je("\r",e[0][m][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+v,m=-1}o.push(c+gN[g[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=_i(g[1][1],i,a),o.push(ki(f,s));break;case"PtgRefN":f=r?_i(g[1][1],r,a):g[1][1],o.push(ki(f,s));break;case"PtgRef3d":d=g[1][1],f=_i(g[1][2],i,a),p=Ox(n,d,a),o.push(p+"!"+ki(f,s));break;case"PtgFunc":case"PtgFuncVar":var S=g[1][0],k=g[1][1];S||(S=0),S&=127;var T=S==0?[]:o.slice(-S);o.length-=S,k==="User"&&(k=T.shift()),o.push(k+"("+T.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":x=dx(g[1][1],r?{s:r}:i,a),o.push(i0(x,a));break;case"PtgArea":x=dx(g[1][1],i,a),o.push(i0(x,a));break;case"PtgArea3d":d=g[1][1],x=g[1][2],p=Ox(n,d,a),o.push(p+"!"+i0(x,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var _=(n.names||[])[h-1]||(n[0]||[])[h],A=_?_.Name:"SH33TJSNAME"+String(h);A&&A.slice(0,6)=="_xlfn."&&!a.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var b=g[1][1];h=g[1][2];var R;if(a.biff<=5)b<0&&(b=-b),n[b]&&(R=n[b][h]);else{var L="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][h]&&n[b][h].itab>0&&(L=n.SheetNames[n[b][h].itab-1]+"!"):L=n.SheetNames[h-1]+"!"),n[b]&&n[b][h])L+=n[b][h].Name;else if(n[0]&&n[0][h])L+=n[0][h].Name;else{var I=(ev(n,b,a)||"").split(";;");I[h-1]?L=I[h-1]:L+="SH33TJSERRX"}o.push(L);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var H="(",Z=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:H=Je(" ",e[0][m][1][1])+H;break;case 3:H=Je("\r",e[0][m][1][1])+H;break;case 4:Z=Je(" ",e[0][m][1][1])+Z;break;case 5:Z=Je("\r",e[0][m][1][1])+Z;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(H+o.pop()+Z);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:g[1][1],r:g[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[ve(f)]){var ee=n.sharedf[ve(f)];o.push(Ct(ee,i,X,n,a))}else{var oe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Ct(c[1],i,X,n,a)),oe=!0;break}oe||o.push(g[1])}break;case"PtgArray":o.push("{"+pN(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&te.indexOf(e[0][y][0])==-1){g=e[0][m];var U=!0;switch(g[1][0]){case 4:U=!1;case 0:v=Je(" ",g[1][1]);break;case 5:U=!1;case 1:v=Je("\r",g[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((U?v:"")+o.pop()+(U?"":v)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function yN(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],It(e,t-2)];var o=po(e,i,r);return t!==i+a&&(s=mo(e,t-i-a,o,r)),e.l=n,[o,s]}function wN(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],It(e,t-2)];var o=po(e,i,r);return t!==i+a&&(s=mo(e,t-i-a,o,r)),e.l=n,[o,s]}function _N(e,t,r,n){var a=e.l+t,s=po(e,n,r),i;return a!==e.l&&(i=mo(e,a-e.l,s,r)),[s,i]}function kN(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=po(e,s,r);return s==65535?[[],It(e,t-2)]:(t!==s+2&&(a=mo(e,n-s-2,i,r)),[i,a])}function EN(e){var t;if(un(e,e.l+6)!==65535)return[Ft(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function c0(e,t,r){var n=e.l+t,a=en(e);r.biff==2&&++e.l;var s=EN(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=wN(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function yc(e,t,r){var n=e.read_shift(4),a=po(e,n,r),s=e.read_shift(4),i=s>0?mo(e,s,a,r):null;return[a,i]}var SN=yc,wc=yc,TN=yc,bN=yc,NN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},tv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},CN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Dx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function u0(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var bi={},gs={};function Ni(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function rv(e,t,r,n,a,s){try{n.cellNF&&(e.z=ke[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=gt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ke[t]==null&&ya(AE[t]||"General",t),e.t==="e")e.w=e.w||La[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qi(e.v);else if(e.t==="d"){var i=Wt(e.v);(i|0)===i?e.w=i.toString(10):e.w=qi(i)}else{if(e.v===void 0)return"";e.w=ba(e.v,gs)}else e.t==="d"?e.w=br(t,Wt(e.v),gs):e.w=br(t,e.v,gs)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Wl(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Wl(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function AN(e,t){var r=Qe(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=je(r))}var FN=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jN=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ON=/<(?:\w:)?hyperlink [^>]*>/mg,DN=/"(\w*:\w*)"/,PN=/<(?:\w:)?col\b[^>]*[\/]?>/g,IN=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,RN=/<(?:\w:)?pageMargins[^>]*\/>/g,nv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,LN=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,MN=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function BN(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",d=e.match(jN);d?(c=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):c=f=e;var h=c.match(nv);h?rd(h[0],o,a,r):(h=c.match(LN))&&UN(h[0],h[1]||"",o,a,r);var x=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var p=c.slice(x,x+50).match(DN);p&&AN(o,p[1])}var m=c.match(MN);m&&m[1]&&GN(m[1],a);var v=[];if(t.cellStyles){var y=c.match(PN);y&&zN(v,y)}d&&KN(d[1],o,t,l,s,i);var w=f.match(IN);w&&(o["!autofilter"]=VN(w[0]));var g=[],S=f.match(FN);if(S)for(x=0;x!=S.length;++x)g[x]=Qe(S[x].slice(S[x].indexOf('"')+1));var k=f.match(ON);k&&$N(o,k,n);var T=f.match(RN);if(T&&(o["!margins"]=HN(ge(T[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=je(l)),t.sheetRows>0&&o["!ref"]){var _=Qe(o["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>l.e.r&&(_.e.r=l.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>l.e.c&&(_.e.c=l.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=je(_))}return v.length>0&&(o["!cols"]=v),g.length>0&&(o["!merges"]=g),o}function rd(e,t,r,n){var a=ge(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=De(Me(a.codeName)))}function UN(e,t,r,n,a){rd(e.slice(0,e.indexOf(">")),r,n,a)}function $N(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=ge(Me(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+De(s.location))):(s.Target="#"+De(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Qe(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=ve({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function HN(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function zN(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=ge(t[n],!0);a.hidden&&(a.hidden=$e(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,ed(a.width)),Fs(a);s<=i;)e[s++]=_t(a)}}function VN(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var WN=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function GN(e,t){t.Views||(t.Views=[{}]),(e.match(WN)||[]).forEach(function(r,n){var a=ge(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),$e(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var KN=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Xi("v"),i=Xi("f");return function(l,c,f,d,h,x){for(var p=0,m="",v=[],y=[],w=0,g=0,S=0,k="",T,_,A=0,b=0,R,L,I=0,H=0,Z=Array.isArray(x.CellXf),X,ee=[],oe=[],te=Array.isArray(c),U=[],q={},se=!1,j=!!f.sheetStubs,z=l.split(t),M=0,B=z.length;M!=B;++M){m=z[M].trim();var J=m.length;if(J!==0){var ie=0;e:for(p=0;p<J;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(f&&f.cellStyles){if(_=ge(m.slice(ie,p),!0),A=_.r!=null?parseInt(_.r,10):A+1,b=-1,f.sheetRows&&f.sheetRows<A)continue;q={},se=!1,_.ht&&(se=!0,q.hpt=parseFloat(_.ht),q.hpx=Zi(q.hpt)),_.hidden=="1"&&(se=!0,q.hidden=!0),_.outlineLevel!=null&&(se=!0,q.level=+_.outlineLevel),se&&(U[A-1]=q)}break;case"<":ie=p;break}if(ie>=p)break;if(_=ge(m.slice(ie,p),!0),A=_.r!=null?parseInt(_.r,10):A+1,b=-1,!(f.sheetRows&&f.sheetRows<A)){d.s.r>A-1&&(d.s.r=A-1),d.e.r<A-1&&(d.e.r=A-1),f&&f.cellStyles&&(q={},se=!1,_.ht&&(se=!0,q.hpt=parseFloat(_.ht),q.hpx=Zi(q.hpt)),_.hidden=="1"&&(se=!0,q.hidden=!0),_.outlineLevel!=null&&(se=!0,q.level=+_.outlineLevel),se&&(U[A-1]=q)),v=m.slice(p).split(e);for(var ue=0;ue!=v.length&&v[ue].trim().charAt(0)=="<";++ue);for(v=v.slice(ue),p=0;p!=v.length;++p)if(m=v[p].trim(),m.length!==0){if(y=m.match(r),w=p,g=0,S=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(w=0,k=y[1],g=0;g!=k.length&&!((S=k.charCodeAt(g)-64)<1||S>26);++g)w=26*w+S;--w,b=w}else++b;for(g=0;g!=m.length&&m.charCodeAt(g)!==62;++g);if(++g,_=ge(m.slice(0,g),!0),_.r||(_.r=ve({r:A-1,c:b})),k=m.slice(g),T={t:""},(y=k.match(s))!=null&&y[1]!==""&&(T.v=De(y[1])),f.cellFormula){if((y=k.match(i))!=null&&y[1]!==""){if(T.f=De(Me(y[1])).replace(/\r\n/g,`
`),f.xlfn||(T.f=Ax(T.f)),y[0].indexOf('t="array"')>-1)T.F=(k.match(a)||[])[1],T.F.indexOf(":")>-1&&ee.push([Qe(T.F),T.F]);else if(y[0].indexOf('t="shared"')>-1){L=ge(y[0]);var ce=De(Me(y[1]));f.xlfn||(ce=Ax(ce)),oe[parseInt(L.si,10)]=[L,ce,_.r]}}else(y=k.match(/<f[^>]*\/>/))&&(L=ge(y[0]),oe[L.si]&&(T.f=a3(oe[L.si][1],oe[L.si][2],_.r)));var re=Ht(_.r);for(g=0;g<ee.length;++g)re.r>=ee[g][0].s.r&&re.r<=ee[g][0].e.r&&re.c>=ee[g][0].s.c&&re.c<=ee[g][0].e.c&&(T.F=ee[g][1])}if(_.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(j)T.t="z";else continue;else T.t=_.t||"n";switch(d.s.c>b&&(d.s.c=b),d.e.c<b&&(d.e.c=b),T.t){case"n":if(T.v==""||T.v==null){if(!j)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!j)continue;T.t="z"}else R=bi[parseInt(T.v,10)],T.v=R.t,T.r=R.r,f.cellHTML&&(T.h=R.h);break;case"str":T.t="s",T.v=T.v!=null?Me(T.v):"",f.cellHTML&&(T.h=zf(T.v));break;case"inlineStr":y=k.match(n),T.t="s",y!=null&&(R=Zf(y[1]))?(T.v=R.t,f.cellHTML&&(T.h=R.h)):T.v="";break;case"b":T.v=$e(T.v);break;case"d":f.cellDates?T.v=gt(T.v,1):(T.v=Wt(gt(T.v,1)),T.t="n");break;case"e":(!f||f.cellText!==!1)&&(T.w=T.v),T.v=Sg[T.v];break}if(I=H=0,X=null,Z&&_.s!==void 0&&(X=x.CellXf[_.s],X!=null&&(X.numFmtId!=null&&(I=X.numFmtId),f.cellStyles&&X.fillId!=null&&(H=X.fillId))),rv(T,I,H,f,h,x),f.cellDates&&Z&&T.t=="n"&&Rs(ke[I])&&(T.t="d",T.v=gc(T.v)),_.cm&&f.xlmeta){var Se=(f.xlmeta.Cell||[])[+_.cm-1];Se&&Se.type=="XLDAPR"&&(T.D=!0)}if(te){var P=Ht(_.r);c[P.r]||(c[P.r]=[]),c[P.r][P.c]=T}else c[_.r]=T}}}}U.length>0&&(c["!rows"]=U)}}();function qN(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var XN=Ra;function YN(){}function JN(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=y4(e),r}function QN(e){var t=Nr(e);return[t]}function ZN(e){var t=Ia(e);return[t]}function eC(e){var t=Nr(e),r=e.read_shift(1);return[t,r,"b"]}function tC(e){var t=Ia(e),r=e.read_shift(1);return[t,r,"b"]}function rC(e){var t=Nr(e),r=e.read_shift(1);return[t,r,"e"]}function nC(e){var t=Ia(e),r=e.read_shift(1);return[t,r,"e"]}function aC(e){var t=Nr(e),r=e.read_shift(4);return[t,r,"s"]}function sC(e){var t=Ia(e),r=e.read_shift(4);return[t,r,"s"]}function iC(e){var t=Nr(e),r=Ft(e);return[t,r,"n"]}function av(e){var t=Ia(e),r=Ft(e);return[t,r,"n"]}function oC(e){var t=Nr(e),r=Yf(e);return[t,r,"n"]}function lC(e){var t=Ia(e),r=Yf(e);return[t,r,"n"]}function cC(e){var t=Nr(e),r=qf(e);return[t,r,"is"]}function uC(e){var t=Nr(e),r=Ot(e);return[t,r,"str"]}function fC(e){var t=Ia(e),r=Ot(e);return[t,r,"str"]}function dC(e,t,r){var n=e.l+t,a=Nr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=wc(e,n-e.l,r);i[3]=Ct(o,null,a,r.supbooks,r)}else e.l=n;return i}function hC(e,t,r){var n=e.l+t,a=Nr(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=wc(e,n-e.l,r);i[3]=Ct(o,null,a,r.supbooks,r)}else e.l=n;return i}function xC(e,t,r){var n=e.l+t,a=Nr(e);a.r=r["!row"];var s=Ft(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=wc(e,n-e.l,r);i[3]=Ct(o,null,a,r.supbooks,r)}else e.l=n;return i}function mC(e,t,r){var n=e.l+t,a=Nr(e);a.r=r["!row"];var s=Ot(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=wc(e,n-e.l,r);i[3]=Ct(o,null,a,r.supbooks,r)}else e.l=n;return i}var pC=Ra;function gC(e,t){var r=e.l+t,n=Ra(e),a=Xf(e),s=Ot(e),i=Ot(e),o=Ot(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function vC(){}function yC(e,t,r){var n=e.l+t,a=_g(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=SN(e,n-e.l,r);i[1]=o}else e.l=n;return i}function wC(e,t,r){var n=e.l+t,a=Ra(e),s=[a];if(r.cellFormula){var i=bN(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var _C=["left","right","top","bottom","header","footer"];function kC(e){var t={};return _C.forEach(function(r){t[r]=Ft(e)}),t}function EC(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function SC(){}function TC(){}function bC(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,x,p,m,v,y,w,g,S,k,T=[];o.biff=12,o["!row"]=0;var _=0,A=!1,b=[],R={},L=o.supbooks||a.supbooks||[[]];if(L.sharedf=R,L.arrayf=b,L.SheetNames=a.SheetNames||a.Sheets.map(function(te){return te.name}),!o.supbooks&&(o.supbooks=L,a.Names))for(var I=0;I<a.Names.length;++I)L[0][I+1]=a.Names[I];var H=[],Z=[],X=!1;ql[16]={n:"BrtShortReal",f:av};var ee;if(wn(e,function(U,q,se){if(!h)switch(se){case 148:c=U;break;case 0:x=U,o.sheetRows&&o.sheetRows<=x.r&&(h=!0),S=kt(v=x.r),o["!row"]=x.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=Zi(U.hpt)),Z[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:U[2]},U[2]){case"n":p.v=U[1];break;case"s":g=bi[U[1]],p.v=g.t,p.r=g.r;break;case"b":p.v=!!U[1];break;case"e":p.v=U[1],o.cellText!==!1&&(p.w=La[p.v]);break;case"str":p.t="s",p.v=U[1];break;case"is":p.t="s",p.v=U[1].t;break}if((m=i.CellXf[U[0].iStyleRef])&&rv(p,m.numFmtId,null,o,s,i),y=U[0].c==-1?y+1:U[0].c,o.dense?(l[v]||(l[v]=[]),l[v][y]=p):l[dt(y)+S]=p,o.cellFormula){for(A=!1,_=0;_<b.length;++_){var j=b[_];x.r>=j[0].s.r&&x.r<=j[0].e.r&&y>=j[0].s.c&&y<=j[0].e.c&&(p.F=je(j[0]),A=!0)}!A&&U.length>3&&(p.f=U[3])}if(f.s.r>x.r&&(f.s.r=x.r),f.s.c>y&&(f.s.c=y),f.e.r<x.r&&(f.e.r=x.r),f.e.c<y&&(f.e.c=y),o.cellDates&&m&&p.t=="n"&&Rs(ke[m.numFmtId])){var z=ma(p.v);z&&(p.t="d",p.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}ee&&(ee.type=="XLDAPR"&&(p.D=!0),ee=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;p={t:"z",v:void 0},y=U[0].c==-1?y+1:U[0].c,o.dense?(l[v]||(l[v]=[]),l[v][y]=p):l[dt(y)+S]=p,f.s.r>x.r&&(f.s.r=x.r),f.s.c>y&&(f.s.c=y),f.e.r<x.r&&(f.e.r=x.r),f.e.c<y&&(f.e.c=y),ee&&(ee.type=="XLDAPR"&&(p.D=!0),ee=void 0);break;case 176:T.push(U);break;case 49:ee=((o.xlmeta||{}).Cell||[])[U-1];break;case 494:var M=n["!id"][U.relId];for(M?(U.Target=M.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=M):U.relId==""&&(U.Target="#"+U.loc),v=U.rfx.s.r;v<=U.rfx.e.r;++v)for(y=U.rfx.s.c;y<=U.rfx.e.c;++y)o.dense?(l[v]||(l[v]=[]),l[v][y]||(l[v][y]={t:"z",v:void 0}),l[v][y].l=U):(w=ve({c:y,r:v}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=U);break;case 426:if(!o.cellFormula)break;b.push(U),k=o.dense?l[v][y]:l[dt(y)+S],k.f=Ct(U[1],f,{r:x.r,c:y},L,o),k.F=je(U[0]);break;case 427:if(!o.cellFormula)break;R[ve(U[0].s)]=U[1],k=o.dense?l[v][y]:l[dt(y)+S],k.f=Ct(U[1],f,{r:x.r,c:y},L,o);break;case 60:if(!o.cellStyles)break;for(;U.e>=U.s;)H[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},X||(X=!0,ed(U.w/256)),Fs(H[U.e+1]);break;case 161:l["!autofilter"]={ref:je(U)};break;case 476:l["!margins"]=U;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),U.name&&(a.Sheets[r].CodeName=U.name),(U.above||U.left)&&(l["!outline"]={above:U.above,left:U.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),U.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!q.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=je(c||f)),o.sheetRows&&l["!ref"]){var oe=Qe(l["!ref"]);o.sheetRows<=+oe.e.r&&(oe.e.r=o.sheetRows-1,oe.e.r>f.e.r&&(oe.e.r=f.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>f.e.c&&(oe.e.c=f.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=je(oe))}return T.length>0&&(l["!merges"]=T),H.length>0&&(l["!cols"]=H),Z.length>0&&(l["!rows"]=Z),l}function NC(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=De((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function CC(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=NC(d);f.s.r=f.s.c=0,f.e.c=o,c=dt(o),h[0].forEach(function(x,p){i[c+kt(p)]={t:"n",v:x,z:h[1]},l=p}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=je(f)),i}function AC(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(nv);return o&&rd(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function FC(e,t){e.l+=10;var r=Ot(e);return{name:r}}function jC(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return wn(e,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var sv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],OC=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],DC=[],PC=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Px(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=$e(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Ix(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=$e(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function iv(e){Ix(e.WBProps,sv),Ix(e.CalcPr,PC),Px(e.WBView,OC),Px(e.Sheets,DC),gs.date1904=$e(e.WBProps.date1904)}var IC="][*?/\\".split("");function RC(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return IC.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var LC=/<\w+:workbook/;function MC(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Rt,function(l,c){var f=ge(l);switch(Zr(f[0])){case"<?xml":break;case"<workbook":l.match(LC)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":sv.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=$e(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=Me(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=De(Me(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Me(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),$e(f.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=De(Me(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),r4.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return iv(r),r}function BC(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Su(e),r.name=Ot(e),r}function UC(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Ot(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function $C(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function HC(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=w4(e),i=TN(e,0,r),o=Xf(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function zC(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],ql[16]={n:"BrtFRTArchID$",f:$C},wn(e,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Ct(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),iv(r),r.Names=s,r.supbooks=i,r}function VC(e,t,r){return t.slice(-4)===".bin"?zC(e,r):MC(e,r)}function WC(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?bC(e,n,r,a,s,i,o):BN(e,n,r,a,s,i,o)}function GC(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?jC(e,n,r,a,s):AC(e,n,r,a,s)}function KC(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?t3():r3()}function qC(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?Zb():e3()}function XC(e,t,r,n){return t.slice(-4)===".bin"?pb(e,r,n):ub(e,r,n)}function YC(e,t,r){return Gg(e,r)}function JC(e,t,r){return t.slice(-4)===".bin"?OT(e,r):FT(e,r)}function QC(e,t,r){return t.slice(-4)===".bin"?Yb(e,r):Wb(e,r)}function ZC(e,t,r){return t.slice(-4)===".bin"?Hb(e):Ub(e)}function eA(e,t,r,n){return r.slice(-4)===".bin"?zb(e,t,r,n):void 0}function tA(e,t,r){return t.slice(-4)===".bin"?Mb(e,t,r):Bb(e,t,r)}var ov=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,lv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ar(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(ov),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(lv),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function rA(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(ov),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(lv),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var Ci;function nA(e,t){var r=Ci[e]||De(e);return r==="General"?ba(t):br(r,t)}function aA(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=$e(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=gt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[De(t)]=a}function sA(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||La[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qi(e.v):e.w=ba(e.v):e.w=nA(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Ci[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Rs(n)){var a=ma(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function iA(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=ab[n.Pattern]||n.Pattern)}e[t.ID]=t}function oA(e,t,r,n,a,s,i,o,l,c){var f="General",d=n.StyleID,h={};c=c||{};var x=[],p=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&x.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=$e(e);break;case"String":n.t="s",n.r=nx(De(e)),n.v=e.indexOf("<")>-1?De(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(gt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=De(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Sg[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=nx(t||e));break}if(sA(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=De(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ps(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ps("RC:RC",a):n.ArrayRange&&(n.F=ps(n.ArrayRange,a),l.push([Qe(n.F),n.F]))}else for(p=0;p<l.length;++p)a.r>=l[p][0].s.r&&a.r<=l[p][0].e.r&&a.c>=l[p][0].s.c&&a.c<=l[p][0].e.c&&(n.F=l[p][1]);c.cellStyles&&(x.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function lA(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function f0(e,t){var r=t||{};Y1();var n=ni(Vf(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Me(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=_t(r);return i.type="string",Ji.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ve){a.indexOf("<"+Ve)>=0&&(s=!0)}),s)return gA(n,r);Ci={"General Number":"General","General Date":ke[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ke[15],"Short Date":ke[14],"Long Time":ke[19],"Medium Time":ke[18],"Short Time":ke[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ke[2],Standard:ke[4],Percent:ke[10],Scientific:ke[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},d=[],h=r.dense?[]:{},x="",p={},m={},v=Ar('<Data ss:Type="String">'),y=0,w=0,g=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},T={},_="",A=0,b=[],R={},L={},I=0,H=[],Z=[],X={},ee=[],oe,te=!1,U=[],q=[],se={},j=0,z=0,M={Sheets:[],WBProps:{date1904:!1}},B={};Yi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=Yi.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?oA(n.slice(y,o.index),_,v,l[l.length-1][0]=="comment"?X:p,{c:w,r:g},k,ee[w],m,U,r):(_="",v=Ar(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Z.length>0&&(p.c=Z),(!r.sheetRows||r.sheetRows>g)&&p.v!==void 0&&(r.dense?(h[g]||(h[g]=[]),h[g][w]=p):h[dt(w)+kt(g)]=p),p.HRef&&(p.l={Target:De(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(j=w+(parseInt(p.MergeAcross,10)|0),z=g+(parseInt(p.MergeDown,10)|0),b.push({s:{c:w,r:g},e:{c:j,r:z}})),!r.sheetStubs)p.MergeAcross?w=j+1:++w;else if(p.MergeAcross||p.MergeDown){for(var ie=w;ie<=j;++ie)for(var ue=g;ue<=z;++ue)(ie>w||ue>g)&&(r.dense?(h[ue]||(h[ue]=[]),h[ue][ie]={t:"z"}):h[dt(ie)+kt(ue)]={t:"z"});w=j+1}else++w;else p=rA(o[0]),p.Index&&(w=+p.Index-1),w<S.s.c&&(S.s.c=w),w>S.e.c&&(S.e.c=w),o[0].slice(-2)==="/>"&&++w,Z=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(g<S.s.r&&(S.s.r=g),g>S.e.r&&(S.e.r=g),o[0].slice(-2)==="/>"&&(m=Ar(o[0]),m.Index&&(g=+m.Index-1)),w=0,++g):(m=Ar(o[0]),m.Index&&(g=+m.Index-1),se={},(m.AutoFitHeight=="0"||m.Height)&&(se.hpx=parseInt(m.Height,10),se.hpt=Wg(se.hpx),q[g]=se),m.Hidden=="1"&&(se.hidden=!0,q[g]=se));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(x),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=je(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=je(S))),b.length&&(h["!merges"]=b),ee.length>0&&(h["!cols"]=ee),q.length>0&&(h["!rows"]=q),f[x]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=w=0,l.push([o[3],!1]),c=Ar(o[0]),x=De(c.Name),h=r.dense?[]:{},b=[],U=[],q=[],B={name:x,Hidden:0},M.Sheets.push(B);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ee=[],te=!1}break;case"style":o[1]==="/"?iA(k,T,r):T=Ar(o[0]);break;case"numberformat":T.nf=De(Ar(o[0]).Format||"General"),Ci[T.nf]&&(T.nf=Ci[T.nf]);for(var ce=0;ce!=392&&ke[ce]!=T.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(ke[ce]==null){ya(T.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(oe=Ar(o[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!te&&oe.wpx>10){te=!0,$t=zg;for(var re=0;re<ee.length;++re)ee[re]&&Fs(ee[re])}te&&Fs(oe),ee[oe.Index-1||ee.length]=oe;for(var Se=0;Se<+oe.Span;++Se)ee[ee.length]=_t(oe);break;case"namedrange":if(o[1]==="/")break;M.Names||(M.Names=[]);var P=ge(o[0]),ze={Name:P.Name,Ref:ps(P.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(ze.Sheet=M.Sheets.length-1),M.Names.push(ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=Ar(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?W4(R,J,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));lA(X),Z.push(X)}else l.push([o[3],!1]),c=Ar(o[0]),X={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ce=Ar(o[0]);h["!autofilter"]={ref:ps(Ce.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return $x(n,r);var Pe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Pe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Pe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Pe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Pe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else I=o.index+o[0].length;break;case"header":h["!margins"]||Ni(h["!margins"]={},"xlml"),isNaN(+ge(o[0]).Margin)||(h["!margins"].header=+ge(o[0]).Margin);break;case"footer":h["!margins"]||Ni(h["!margins"]={},"xlml"),isNaN(+ge(o[0]).Margin)||(h["!margins"].footer=+ge(o[0]).Margin);break;case"pagemargins":var Ee=ge(o[0]);h["!margins"]||Ni(h["!margins"]={},"xlml"),isNaN(+Ee.Top)||(h["!margins"].top=+Ee.Top),isNaN(+Ee.Left)||(h["!margins"].left=+Ee.Left),isNaN(+Ee.Right)||(h["!margins"].right=+Ee.Right),isNaN(+Ee.Bottom)||(h["!margins"].bottom=+Ee.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Pe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Pe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Pe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Pe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Pe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Pe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Pe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Pe=!1}break;case"smarttags":break;default:Pe=!1;break}if(Pe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?aA(L,J,H,n.slice(I,o.index)):(H=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var de={};return!r.bookSheets&&!r.bookProps&&(de.Sheets=f),de.SheetNames=d,de.Workbook=M,de.SSF=_t(ke),de.Props=R,de.Custprops=L,de}function Cu(e,t){switch(sd(t=t||{}),t.type||"base64"){case"base64":return f0(ur(e),t);case"binary":case"buffer":case"file":return f0(e,t);case"array":return f0(Pa(e),t)}}function cA(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=E4(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=S4(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var uA=[60,1084,2066,2165,2175];function fA(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=un(r,r.l),c=Au[l],f=0;c!=null&&uA.indexOf(l)>-1;)s=un(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,c=Au[l=un(r,r.l)];var d=Dn(i);yt(d,0);var h=0;d.lens=[];for(var x=0;x<i.length;++x)d.lens.push(h),h+=i[x].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function Wr(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ke[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||La[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qi(e.v):e.w=ba(e.v):e.w=br(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Rs(ke[n]||String(n))){var a=ma(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function qo(e,t,r){return{v:e,ixfe:t,t:r}}function dA(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",f={},d,h="",x,p,m,v,y={},w=[],g,S,k=[],T=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},b=function(Te){return Te<8?wa[Te]:Te<64&&T[Te-8]||wa[Te]},R=function(Te,Ze,mr){var it=Ze.XF.data;if(!(!it||!it.patternType||!mr||!mr.cellStyles)){Ze.s={},Ze.s.patternType=it.patternType;var na;(na=Qi(b(it.icvFore)))&&(Ze.s.fgColor={rgb:na}),(na=Qi(b(it.icvBack)))&&(Ze.s.bgColor={rgb:na})}},L=function(Te,Ze,mr){if(!(se>1)&&!(mr.sheetRows&&Te.r>=mr.sheetRows)){if(mr.cellStyles&&Ze.XF&&Ze.XF.data&&R(Te,Ze,mr),delete Ze.ixfe,delete Ze.XF,d=Te,h=ve(Te),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Te.r<i.s.r&&(i.s.r=Te.r),Te.c<i.s.c&&(i.s.c=Te.c),Te.r+1>i.e.r&&(i.e.r=Te.r+1),Te.c+1>i.e.c&&(i.e.c=Te.c+1),mr.cellFormula&&Ze.f){for(var it=0;it<w.length;++it)if(!(w[it][0].s.c>Te.c||w[it][0].s.r>Te.r)&&!(w[it][0].e.c<Te.c||w[it][0].e.r<Te.r)){Ze.F=je(w[it][0]),(w[it][0].s.c!=Te.c||w[it][0].s.r!=Te.r)&&delete Ze.f,Ze.f&&(Ze.f=""+Ct(w[it][1],i,Te,U,I));break}}mr.dense?(a[Te.r]||(a[Te.r]=[]),a[Te.r][Te.c]=Ze):a[h]=Ze}},I={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var H,Z=[],X=[],ee=[],oe=[],te=!1,U=[];U.SheetNames=I.snames,U.sharedf=I.sharedf,U.arrayf=I.arrayf,U.names=[],U.XTI=[];var q=0,se=0,j=0,z=[],M=[],B;I.codepage=1200,Lr(1200);for(var J=!1;e.l<e.length-1;){var ie=e.l,ue=e.read_shift(2);if(ue===0&&q===10)break;var ce=e.l===e.length?0:e.read_shift(2),re=Au[ue];if(re&&re.f){if(t.bookSheets&&q===133&&ue!==133)break;if(q=ue,re.r===2||re.r==12){var Se=e.read_shift(2);if(ce-=2,!I.enc&&Se!==ue&&((Se&255)<<8|Se>>8)!==ue)throw new Error("rt mismatch: "+Se+"!="+ue);re.r==12&&(e.l+=10,ce-=10)}var P={};if(ue===10?P=re.f(e,ce,I):P=fA(ue,re,e,ce,I),se==0&&[9,521,1033,2057].indexOf(q)===-1)continue;switch(ue){case 34:r.opts.Date1904=_.WBProps.date1904=P;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=P;break;case 66:var ze=Number(P);switch(ze){case 21010:ze=1200;break;case 32768:ze=1e4;break;case 32769:ze=1252;break}Lr(I.codepage=ze),J=!0;break;case 317:I.rrtabid=P;break;case 25:I.winlocked=P;break;case 439:r.opts.RefreshAll=P;break;case 12:r.opts.CalcCount=P;break;case 16:r.opts.CalcDelta=P;break;case 17:r.opts.CalcIter=P;break;case 13:r.opts.CalcMode=P;break;case 14:r.opts.CalcPrecision=P;break;case 95:r.opts.CalcSaveRecalc=P;break;case 15:I.CalcRefMode=P;break;case 2211:r.opts.FullCalc=P;break;case 129:P.fDialog&&(a["!type"]="dialog"),P.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),P.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:k.push(P);break;case 430:U.push([P]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(P);break;case 24:case 536:B={Name:P.Name,Ref:Ct(P.rgce,i,null,U,I)},P.itab>0&&(B.Sheet=P.itab-1),U.names.push(B),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(M[P.itab-1]={ref:je(P.rgce[0][0][1][2])});break;case 22:I.ExternCount=P;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(P),U.XTI=U.XTI.concat(P);break;case 2196:if(I.biff<8)break;B!=null&&(B.Comment=P[1]);break;case 18:a["!protect"]=P;break;case 19:P!==0&&I.WTF&&console.error("Password verifier: "+P);break;case 133:s[P.pos]=P,I.snames.push(P.name);break;case 10:{if(--se)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=je(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ce=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=je(i),i.e.r=Ce}i.e.r++,i.e.c++}Z.length>0&&(a["!merges"]=Z),X.length>0&&(a["!objects"]=X),ee.length>0&&(a["!cols"]=ee),oe.length>0&&(a["!rows"]=oe),_.Sheets.push(A)}c===""?f=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),I.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(I.biff=5,J=!0,Lr(I.codepage=28591)),I.biff==8&&P.BIFFVer==0&&P.dt==16&&(I.biff=2),se++)break;if(a=t.dense?[]:{},I.biff<8&&!J&&(J=!0,Lr(I.codepage=t.codepage||1252)),I.biff<5||P.BIFFVer==0&&P.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Pe={pos:e.l-ce,name:c};s[Pe.pos]=Pe,I.snames.push(c)}else c=(s[ie]||{name:""}).name;P.dt==32&&(a["!type"]="chart"),P.dt==64&&(a["!type"]="macro"),Z=[],X=[],I.arrayf=w=[],ee=[],oe=[],te=!1,A={Hidden:(s[ie]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[P.r]||[])[P.c]:a[ve({c:P.c,r:P.r})])&&++P.c,g={ixfe:P.ixfe,XF:k[P.ixfe]||{},v:P.val,t:"n"},j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L({c:P.c,r:P.r},g,t);break;case 5:case 517:g={ixfe:P.ixfe,XF:k[P.ixfe],v:P.val,t:P.t},j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L({c:P.c,r:P.r},g,t);break;case 638:g={ixfe:P.ixfe,XF:k[P.ixfe],v:P.rknum,t:"n"},j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L({c:P.c,r:P.r},g,t);break;case 189:for(var Ee=P.c;Ee<=P.C;++Ee){var de=P.rkrec[Ee-P.c][0];g={ixfe:de,XF:k[de],v:P.rkrec[Ee-P.c][1],t:"n"},j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L({c:Ee,r:P.r},g,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){o=P;break}if(g=qo(P.val,P.cell.ixfe,P.tt),g.XF=k[g.ixfe],t.cellFormula){var Ve=P.formula;if(Ve&&Ve[0]&&Ve[0][0]&&Ve[0][0][0]=="PtgExp"){var qt=Ve[0][0][1][0],hr=Ve[0][0][1][1],xr=ve({r:qt,c:hr});y[xr]?g.f=""+Ct(P.formula,i,P.cell,U,I):g.F=((t.dense?(a[qt]||[])[hr]:a[xr])||{}).F}else g.f=""+Ct(P.formula,i,P.cell,U,I)}j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L(P.cell,g,t),o=P}break;case 7:case 519:if(o)o.val=P,g=qo(P,o.cell.ixfe,"s"),g.XF=k[g.ixfe],t.cellFormula&&(g.f=""+Ct(o.formula,i,o.cell,U,I)),j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L(o.cell,g,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(P);var rr=ve(P[0].s);if(x=t.dense?(a[P[0].s.r]||[])[P[0].s.c]:a[rr],t.cellFormula&&x){if(!o||!rr||!x)break;x.f=""+Ct(P[1],i,P[0],U,I),x.F=je(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[ve(o.cell)]=P[0],x=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[ve(o.cell)],(x||{}).f=""+Ct(P[0],i,d,U,I)}}break;case 253:g=qo(l[P.isst].t,P.ixfe,"s"),l[P.isst].h&&(g.h=l[P.isst].h),g.XF=k[g.ixfe],j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L({c:P.c,r:P.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:P.ixfe,XF:k[P.ixfe],t:"z"},j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L({c:P.c,r:P.r},g,t));break;case 190:if(t.sheetStubs)for(var _n=P.c;_n<=P.C;++_n){var nr=P.ixfe[_n-P.c];g={ixfe:nr,XF:k[nr],t:"z"},j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L({c:_n,r:P.r},g,t)}break;case 214:case 516:case 4:g=qo(P.val,P.ixfe,"s"),g.XF=k[g.ixfe],j>0&&(g.z=z[g.ixfe>>8&63]),Wr(g,t,r.opts.Date1904),L({c:P.c,r:P.r},g,t);break;case 0:case 512:se===1&&(i=P);break;case 252:l=P;break;case 1054:if(I.biff==4){z[j++]=P[1];for(var tn=0;tn<j+163&&ke[tn]!=P[1];++tn);tn>=163&&ya(P[1],j+163)}else ya(P[1],P[0]);break;case 30:{z[j++]=P;for(var kn=0;kn<j+163&&ke[kn]!=P;++kn);kn>=163&&ya(P,j+163)}break;case 229:Z=Z.concat(P);break;case 93:X[P.cmo[0]]=I.lastobj=P;break;case 438:I.lastobj.TxO=P;break;case 127:I.lastobj.ImData=P;break;case 440:for(v=P[0].s.r;v<=P[0].e.r;++v)for(m=P[0].s.c;m<=P[0].e.c;++m)x=t.dense?(a[v]||[])[m]:a[ve({c:m,r:v})],x&&(x.l=P[1]);break;case 2048:for(v=P[0].s.r;v<=P[0].e.r;++v)for(m=P[0].s.c;m<=P[0].e.c;++m)x=t.dense?(a[v]||[])[m]:a[ve({c:m,r:v})],x&&x.l&&(x.l.Tooltip=P[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;x=t.dense?(a[P[0].r]||[])[P[0].c]:a[ve(P[0])];var Bs=X[P[2]];x||(t.dense?(a[P[0].r]||(a[P[0].r]=[]),x=a[P[0].r][P[0].c]={t:"z"}):x=a[ve(P[0])]={t:"z"},i.e.r=Math.max(i.e.r,P[0].r),i.s.r=Math.min(i.s.r,P[0].r),i.e.c=Math.max(i.e.c,P[0].c),i.s.c=Math.min(i.s.c,P[0].c)),x.c||(x.c=[]),p={a:P[1],t:Bs.TxO.t},x.c.push(p)}break;case 2173:Pb(k[P.ixfe],P.ext);break;case 125:{if(!I.cellStyles)break;for(;P.e>=P.s;)ee[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},te||(te=!0,ed(P.w/256)),Fs(ee[P.e+1])}break;case 520:{var Lt={};P.level!=null&&(oe[P.r]=Lt,Lt.level=P.level),P.hidden&&(oe[P.r]=Lt,Lt.hidden=!0),P.hpt&&(oe[P.r]=Lt,Lt.hpt=P.hpt,Lt.hpx=Zi(P.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Ni(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=P;break;case 161:a["!margins"]||Ni(a["!margins"]={}),a["!margins"].header=P.header,a["!margins"].footer=P.footer;break;case 574:P.RTL&&(_.Views[0].RTL=!0);break;case 146:T=P;break;case 2198:H=P;break;case 140:S=P;break;case 442:c?A.CodeName=P||A.name:_.WBProps.CodeName=P||"ThisWorkbook";break}}else re||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),e.l+=ce}return r.SheetNames=Qr(s).sort(function(zr,Te){return Number(zr)-Number(Te)}).map(function(zr){return s[zr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&M.forEach(function(zr,Te){r.Sheets[r.SheetNames[Te]]["!autofilter"]=zr}),r.Strings=l,r.SSF=_t(ke),I.enc&&(r.Encryption=I.enc),H&&(r.Themes=H),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),U.names.length>0&&(_.Names=U.names),r.Workbook=_,r}var Rx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function hA(e,t,r){var n=Fe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=yx(n,F4,Rx.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Fe.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=yx(i,j4,Rx.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(bg(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function cv(e,t){t||(t={}),sd(t),M1(),t.codepage&&Lf(t.codepage);var r,n;if(e.FullPaths){if(Fe.find(e,"/encryption"))throw new Error("File is password-protected");r=Fe.find(e,"!CompObj"),n=Fe.find(e,"/Workbook")||Fe.find(e,"/Book")}else{switch(t.type){case"base64":e=Rr(ur(e));break;case"binary":e=Rr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yt(e,0),n={content:e}}var a,s;if(r&&cA(r),t.bookProps&&!t.bookSheets)a={};else{var i=Ae?"buffer":"array";if(n&&n.content)a=dA(n.content,t);else if((s=Fe.find(e,"PerfectOffice_MAIN"))&&s.content)a=Ti.to_workbook(s.content,(t.type=i,t));else if((s=Fe.find(e,"NativeContent_MAIN"))&&s.content)a=Ti.to_workbook(s.content,(t.type=i,t));else throw(s=Fe.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Fe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Qb(e))}var o={};return e.FullPaths&&hA(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var ql={0:{f:qN},1:{f:QN},2:{f:oC},3:{f:rC},4:{f:eC},5:{f:iC},6:{f:uC},7:{f:aC},8:{f:mC},9:{f:xC},10:{f:dC},11:{f:hC},12:{f:ZN},13:{f:lC},14:{f:nC},15:{f:tC},16:{f:av},17:{f:fC},18:{f:sC},19:{f:qf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:HC},40:{},42:{},43:{f:db},44:{f:fb},45:{f:hb},46:{f:mb},47:{f:xb},48:{},49:{f:p4},50:{},51:{f:Rb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Mg},62:{f:cC},63:{f:$b},64:{f:SC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:It,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:EC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:JN},148:{f:XN,p:16},151:{f:vC},152:{},153:{f:UC},154:{},155:{},156:{f:BC},157:{},158:{},159:{T:1,f:jT},160:{T:-1},161:{T:1,f:Ra},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:pC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ib},336:{T:-1},337:{f:Lb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Su},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Lg},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yC},427:{f:wC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kC},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:YN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Su},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Xb},633:{T:1},634:{T:-1},635:{T:1,f:qb},636:{T:-1},637:{f:v4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:TC},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Au={6:{f:c0},10:{f:Tn},12:{f:at},13:{f:at},14:{f:et},15:{f:et},16:{f:Ft},17:{f:et},18:{f:et},19:{f:at},20:{f:Ex},21:{f:Ex},23:{f:Lg},24:{f:Tx},25:{f:et},26:{},27:{},28:{f:GS},29:{},34:{f:et},35:{f:Sx},38:{f:Ft},39:{f:Ft},40:{f:Ft},41:{f:Ft},42:{f:et},43:{f:et},47:{f:YT},49:{f:NS},51:{f:at},60:{},61:{f:SS},64:{f:et},65:{f:bS},66:{f:at},77:{},80:{},81:{},82:{},85:{f:at},89:{},90:{},91:{},92:{f:pS},93:{f:qS},94:{},95:{f:et},96:{},97:{},99:{f:et},125:{f:Mg},128:{f:LS},129:{f:gS},130:{f:at},131:{f:et},132:{f:et},133:{f:vS},134:{},140:{f:eT},141:{f:at},144:{},146:{f:rT},151:{},152:{},153:{},154:{},155:{},156:{f:at},157:{},158:{},160:{f:oT},161:{f:aT},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:DS},190:{f:PS},193:{f:Tn},197:{},198:{},199:{},200:{},201:{},202:{f:et},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:at},220:{},221:{f:et},222:{},224:{f:RS},225:{f:mS},226:{f:Tn},227:{},229:{f:KS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:yS},253:{f:CS},255:{f:wS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:jg},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:et},353:{f:Tn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:BS},431:{f:et},432:{},433:{},434:{},437:{},438:{f:JS},439:{f:et},440:{f:QS},441:{},442:{f:ho},443:{},444:{f:at},445:{},446:{},448:{f:Tn},449:{f:ES,r:2},450:{f:Tn},512:{f:_x},513:{f:iT},515:{f:MS},516:{f:AS},517:{f:kx},519:{f:lT},520:{f:_S},523:{},545:{f:bx},549:{f:wx},566:{},574:{f:TS},638:{f:OS},659:{},1048:{},1054:{f:FS},1084:{},1212:{f:zS},2048:{f:ZS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Wo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Tn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nT,r:12},2173:{f:Db,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:et,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HS,r:12},2197:{},2198:{f:Nb,r:12},2199:{},2200:{},2201:{},2202:{f:VS,r:12},2203:{f:Tn},2204:{},2205:{},2206:{},2207:{},2211:{f:kS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:at},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:sT},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:tT},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_x},1:{},2:{f:dT},3:{f:fT},4:{f:uT},5:{f:kx},7:{f:hT},8:{},9:{f:Wo},11:{},22:{f:at},30:{f:jS},31:{},32:{},33:{f:bx},36:{},37:{f:wx},50:{f:xT},62:{},52:{},67:{},68:{f:at},69:{},86:{},126:{},127:{f:cT},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:mT},223:{},234:{},354:{},421:{},518:{f:c0},521:{f:Wo},536:{f:Tx},547:{f:Sx},561:{},579:{},1030:{f:c0},1033:{f:Wo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Fr(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&vg(r)&&e.push(r)}}function Lx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=ME(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,d=0,h=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<l.length;++i){var m=l[i].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(v!="<td"&&v!="<th")){var y=m.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var w=y[o].trim();if(w.match(/<t[dh]/i)){for(var g=w,S=0;g.charAt(0)=="<"&&(S=g.indexOf(">"))>-1;)g=g.slice(S+1);for(var k=0;k<p.length;++k){var T=p[k];T.s.c==f&&T.s.r<c&&c<=T.e.r&&(f=T.e.c+1,k=-1)}var _=ge(w.slice(0,w.indexOf(">")));h=_.colspan?+_.colspan:1,((d=+_.rowspan)>1||h>1)&&p.push({s:{r:c,c:f},e:{r:c+(d||1)-1,c:f+h-1}});var A=_.t||_["data-t"]||"";if(!g.length){f+=h;continue}if(g=sg(g),x.s.r>c&&(x.s.r=c),x.e.r<c&&(x.e.r=c),x.s.c>f&&(x.s.c=f),x.e.c<f&&(x.e.c=f),!g.length){f+=h;continue}var b={t:"s",v:g};r.raw||!g.trim().length||A=="s"||(g==="TRUE"?b={t:"b",v:!0}:g==="FALSE"?b={t:"b",v:!1}:isNaN($r(g))?isNaN(As(g).getDate())||(b={t:"d",v:gt(g)},r.cellDates||(b={t:"n",v:Wt(b.v)}),b.z=r.dateNF||ke[14]):b={t:"n",v:$r(g)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=b):n[ve({r:c,c:f})]=b,f+=h}}}}return n["!ref"]=je(x),p.length&&(n["!merges"]=p),n}function xA(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var f=ve({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||zf(d.w||(vn(d),d.w)||""))||"",x={};o>1&&(x.rowspan=o),l>1&&(x.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(x["data-t"]=d&&d.t||"z",d.v!=null&&(x["data-v"]=d.v),d.z!=null&&(x["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),x.id=(n.id||"sjs")+"-"+f,s.push(e4("td",h,x))}}var p="<tr>";return p+s.join("")+"</tr>"}var mA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',pA="</body></html>";function gA(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ra(Lx(r[0],t),t);var n=od();return r.forEach(function(a,s){ld(n,Lx(a,t),"Sheet"+(s+1))}),n}function vA(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function yA(e,t){var r=t||{},n=r.header!=null?r.header:mA,a=r.footer!=null?r.footer:pA,s=[n],i=Ls(e["!ref"]);r.dense=Array.isArray(e),s.push(vA(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(xA(e,i,o,r));return s.push("</table>"+a),s.join("")}function uv(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Ht(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=Ls(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),a==-1&&(c.e.r=a=f.e.r+1)}var d=[],h=0,x=e["!rows"]||(e["!rows"]=[]),p=0,m=0,v=0,y=0,w=0,g=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var S=o[p];if(Mx(S)){if(n.display)continue;x[m]={hidden:!0}}var k=S.children;for(v=y=0;v<k.length;++v){var T=k[v];if(!(n.display&&Mx(T))){var _=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):sg(T.innerHTML),A=T.getAttribute("data-z")||T.getAttribute("z");for(h=0;h<d.length;++h){var b=d[h];b.s.c==y+s&&b.s.r<m+a&&m+a<=b.e.r&&(y=b.e.c+1-s,h=-1)}g=+T.getAttribute("colspan")||1,((w=+T.getAttribute("rowspan")||1)>1||g>1)&&d.push({s:{r:m+a,c:y+s},e:{r:m+a+(w||1)-1,c:y+s+(g||1)-1}});var R={t:"s",v:_},L=T.getAttribute("data-t")||T.getAttribute("t")||"";_!=null&&(_.length==0?R.t=L||"z":n.raw||_.trim().length==0||L=="s"||(_==="TRUE"?R={t:"b",v:!0}:_==="FALSE"?R={t:"b",v:!1}:isNaN($r(_))?isNaN(As(_).getDate())||(R={t:"d",v:gt(_)},n.cellDates||(R={t:"n",v:Wt(R.v)}),R.z=n.dateNF||ke[14]):R={t:"n",v:$r(_)})),R.z===void 0&&A!=null&&(R.z=A);var I="",H=T.getElementsByTagName("A");if(H&&H.length)for(var Z=0;Z<H.length&&!(H[Z].hasAttribute("href")&&(I=H[Z].getAttribute("href"),I.charAt(0)!="#"));++Z);I&&I.charAt(0)!="#"&&(R.l={Target:I}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][y+s]=R):e[ve({c:y+s,r:m+a})]=R,c.e.c<y+s&&(c.e.c=y+s),y+=g}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=je(c),m>=l&&(e["!fullref"]=je((c.e.r=o.length-p+m-1+a,c))),e}function fv(e,t){var r=t||{},n=r.dense?[]:{};return uv(n,e,t)}function wA(e,t){return ra(fv(e,t),t)}function Mx(e){var t="",r=_A(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function _A(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kA(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=De(t.replace(/<[^>]*>/g,""));return[r]}var Bx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function dv(e,t){var r=t||{},n=Vf(e),a=[],s,i,o={name:""},l="",c=0,f,d,h={},x=[],p=r.dense?[]:{},m,v,y={value:""},w="",g=0,S=[],k=-1,T=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,b={},R=[],L={},I=0,H=0,Z=[],X=1,ee=1,oe=[],te={Names:[]},U={},q=["",""],se=[],j={},z="",M=0,B=!1,J=!1,ie=0;for(Yi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Yi.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?p["!ref"]=je(_):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(p["!fullref"]=p["!ref"],_.e.r=r.sheetRows-1,p["!ref"]=je(_)),R.length&&(p["!merges"]=R),Z.length&&(p["!rows"]=Z),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),x.push(f.name),h[f.name]=p,J=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=ge(m[0],!1),k=T=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,p=r.dense?[]:{},R=[],Z=[],J=!0);break;case"table-row-group":m[1]==="/"?--A:++A;break;case"table-row":case"":if(m[1]==="/"){k+=X,X=1;break}if(d=ge(m[0],!1),d.?k=d.-1:k==-1&&(k=0),X=+d["number-rows-repeated"]||1,X<10)for(ie=0;ie<X;++ie)A>0&&(Z[k+ie]={level:A});T=-1;break;case"covered-table-cell":m[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(p[k]||(p[k]=[]),p[k][T]={t:"z"}):p[ve({r:k,c:T})]={t:"z"}),w="",S=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++T,y=ge(m[0],!1),ee=parseInt(y["number-columns-repeated"]||"1",10),v={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(v.f=Dx(De(y.formula))),(y.||y["value-type"])=="string"&&(v.t="s",v.v=De(y["string-value"]||""),r.dense?(p[k]||(p[k]=[]),p[k][T]=v):p[ve({r:k,c:T})]=v),T+=ee-1;else if(m[1]!=="/"){++T,w="",g=0,S=[],ee=1;var ue=X?k+X-1:k;if(T>_.e.c&&(_.e.c=T),T<_.s.c&&(_.s.c=T),k<_.s.r&&(_.s.r=k),ue>_.e.r&&(_.e.r=ue),y=ge(m[0],!1),se=[],j={},v={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=De(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(I=parseInt(y["number-matrix-rows-spanned"],10)||0,H=parseInt(y["number-matrix-columns-spanned"],10)||0,L={s:{r:k,c:T},e:{r:k+I-1,c:T+H-1}},v.F=je(L),oe.push([L,v.F])),y.formula)v.f=Dx(y.formula);else for(ie=0;ie<oe.length;++ie)k>=oe[ie][0].s.r&&k<=oe[ie][0].e.r&&T>=oe[ie][0].s.c&&T<=oe[ie][0].e.c&&(v.F=oe[ie][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(I=parseInt(y["number-rows-spanned"],10)||0,H=parseInt(y["number-columns-spanned"],10)||0,L={s:{r:k,c:T},e:{r:k+I-1,c:T+H-1}},R.push(L)),y["number-columns-repeated"]&&(ee=parseInt(y["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=$e(y["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(y.value);break;case"percentage":v.t="n",v.v=parseFloat(y.value);break;case"currency":v.t="n",v.v=parseFloat(y.value);break;case"date":v.t="d",v.v=gt(y["date-value"]),r.cellDates||(v.t="n",v.v=Wt(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=IE(y["time-value"])/86400,r.cellDates&&(v.t="d",v.v=gc(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(y.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",y["string-value"]!=null&&(w=De(y["string-value"]),S=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(B=!1,v.t==="s"&&(v.v=w||"",S.length&&(v.R=S),B=g==0),U.Target&&(v.l=U),se.length>0&&(v.c=se,se=[]),w&&r.cellText!==!1&&(v.w=w),B&&(v.t="z",delete v.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var ce=0;ce<X;++ce){if(ee=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(p[k+ce]||(p[k+ce]=[]),p[k+ce][T]=ce==0?v:_t(v);--ee>0;)p[k+ce][T+ee]=_t(v);else for(p[ve({r:k+ce,c:T})]=v;--ee>0;)p[ve({r:k+ce,c:T+ee})]=_t(v);_.e.c<=T&&(_.e.c=T)}ee=parseInt(y["number-columns-repeated"]||"1",10),T+=ee-1,ee=0,v={},w="",S=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;j.t=w,S.length&&(j.R=S),j.a=z,se.push(j)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);z="",M=0,w="",g=0,S=[];break;case"creator":m[1]==="/"?z=n.slice(M,m.index):M=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);w="",g=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(b[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=ge(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=ge(m[0],!1),l+=Bx[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=ge(m[0],!1),l+=Bx[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=ge(m[0],!1),q=u0(i["cell-range-address"]);var re={Name:i.name,Ref:q[0]+"!"+q[1]};J&&(re.Sheet=x.length),te.Names.push(re);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var Se=kA(n.slice(g,m.index));w=(w.length>0?w+`
`:"")+Se[0]}else ge(m[0],!1),g=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{q=u0(ge(m[0])["target-range-address"]),h[q[0]]["!autofilter"]={ref:q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(U=ge(m[0],!1),!U.href)break;U.Target=De(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(q=u0(U.Target.slice(1)),U.Target="#"+q[0]+"!"+q[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var P={Sheets:h,SheetNames:x,Workbook:te};return r.bookSheets&&delete P.Sheets,P}function Ux(e,t){t=t||{},vr(e,"META-INF/manifest.xml")&&M4(nt(e,"META-INF/manifest.xml"),t);var r=ir(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=dv(Me(r),t);return vr(e,"meta.xml")&&(n.Props=Tg(nt(e,"meta.xml"))),n}function $x(e,t){return dv(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function nd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fu(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Me(Pa(e))}function ju(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Hx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function EA(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function eo(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ht(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function jt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=eo(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=eo(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function ad(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function SA(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=eo(e,n),s=jt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:ht(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=jt(o.data),c=ht(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=ht(s[3][0].data)>>>0>0),r.push(i)}return r}function TA(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=eo(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ju(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var f=ju(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function bA(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(TA(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ju(t)}function NA(e,t,r,n){var a=nd(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Hx(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=Hx(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function CA(e,t,r){var n=nd(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);a&1&&(l=EA(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function AA(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return NA(e,t,r,e[0]);case 5:return CA(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Kn(e){var t=jt(e);return eo(t[1][0].data)}function zx(e,t){var r=jt(t.data),n=ht(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=jt(i.data),l=ht(o[1][0].data)>>>0;switch(n){case 1:s[l]=Fu(o[3][0].data);break;case 8:{var c=e[Kn(o[9][0].data)][0],f=jt(c.data),d=e[Kn(f[1][0].data)][0],h=ht(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var x=jt(d.data);s[l]=x[3].map(function(p){return Fu(p.data)}).join("")}break}}),s}function FA(e,t){var r,n,a,s,i,o,l,c,f,d,h,x,p,m,v=jt(e),y=ht(v[1][0].data)>>>0,w=ht(v[2][0].data)>>>0,g=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&ht(v[8][0].data)>0||!1,S,k;if((s=(a=v[7])==null?void 0:a[0])!=null&&s.data&&t!=0)S=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,k=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(f=v[4])==null?void 0:f[0])!=null&&d.data&&t!=1)S=(x=(h=v[4])==null?void 0:h[0])==null?void 0:x.data,k=(m=(p=v[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=g?4:1,_=nd(S),A=[],b=0;b<S.length/2;++b){var R=_.getUint16(b*2,!0);R<65535&&A.push([b,R])}if(A.length!=w)throw"Expected ".concat(w," cells, found ").concat(A.length);var L=[];for(b=0;b<A.length-1;++b)L[A[b][0]]=k.subarray(A[b][1]*T,A[b+1][1]*T);return A.length>=1&&(L[A[A.length-1][0]]=k.subarray(A[A.length-1][1]*T)),{R:y,cells:L}}function jA(e,t){var r,n=jt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?ht(n[7][0].data)>>>0>0?1:0:-1,s=ad(n[5],function(i){return FA(i,a)});return{nrows:ht(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function OA(e,t,r){var n,a=jt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(ht(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(ht(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=je(s);var i=jt(a[4][0].data),o=zx(e,e[Kn(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?zx(e,e[Kn(i[17][0].data)][0]):[],c=jt(i[3][0].data),f=0;c[1].forEach(function(d){var h=jt(d.data),x=e[Kn(h[2][0].data)][0],p=ht(x.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=jA(e,x);m.data.forEach(function(v,y){v.forEach(function(w,g){var S=ve({r:f+y,c:g}),k=AA(w,o,l);k&&(r[S]=k)})}),f+=m.nrows})}function DA(e,t){var r=jt(t.data),n={"!ref":"A1"},a=e[Kn(r[2][0].data)],s=ht(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return OA(e,a[0],n),n}function PA(e,t){var r,n=jt(t.data),a={name:(r=n[1])!=null&&r[0]?Fu(n[1][0].data):"",sheets:[]},s=ad(n[2],Kn);return s.forEach(function(i){e[i].forEach(function(o){var l=ht(o.meta[1][0].data);l==6e3&&a.sheets.push(DA(e,o))})}),a}function IA(e,t){var r=od(),n=jt(t.data),a=ad(n[1],Kn);if(a.forEach(function(s){e[s].forEach(function(i){var o=ht(i.meta[1][0].data);if(o==2){var l=PA(e,i);l.sheets.forEach(function(c,f){ld(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function d0(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=bA(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=SA(c)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&ht(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var f=ht(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return IA(s,o)}function RA(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function sd(e){RA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function LA(e){return os.WS.indexOf(e)>-1?"sheet":e==os.CS?"chart":e==os.DS?"dialog":e==os.MS?"macro":e&&e.length?e:"sheet"}function MA(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,LA(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function BA(e,t,r,n,a,s,i,o,l,c,f,d){try{s[n]=Ei(ir(e,r,!0),t);var h=nt(e,t),x;switch(o){case"sheet":x=WC(h,t,a,l,s[n],c,f,d);break;case"chart":if(x=GC(h,t,a,l,s[n],c,f,d),!x||!x["!drawel"])break;var p=si(x["!drawel"].Target,t),m=Tu(p),v=Vb(ir(e,p,!0),Ei(ir(e,m,!0),p)),y=si(v,p),w=Tu(y);x=CC(ir(e,y,!0),y,l,Ei(ir(e,w,!0),y),c,x);break;case"macro":x=KC(h,t,a,l,s[n],c,f,d);break;case"dialog":x=qC(h,t,a,l,s[n],c,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=x;var g=[];s&&s[n]&&Qr(s[n]).forEach(function(S){var k="";if(s[n][S].Type==os.CMNT){k=si(s[n][S].Target,t);var T=QC(nt(e,k,!0),k,l);if(!T||!T.length)return;Cx(x,T,!1)}s[n][S].Type==os.TCMNT&&(k=si(s[n][S].Target,t),g=g.concat(Gb(nt(e,k,!0),l)))}),g&&g.length&&Cx(x,g,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function pr(e){return e.charAt(0)=="/"?e.slice(1):e}function UA(e,t){if(Y1(),t=t||{},sd(t),vr(e,"META-INF/manifest.xml")||vr(e,"objectdata.xml"))return Ux(e,t);if(vr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof d0<"u"){if(e.FileIndex)return d0(e);var r=Fe.utils.cfb_new();return tx(e).forEach(function(Z){$E(r,Z,UE(e,Z))}),d0(r)}throw new Error("Unsupported NUMBERS file")}if(!vr(e,"[Content_Types].xml"))throw vr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=tx(e),a=R4(ir(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",nt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!nt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(bi=[],a.sst)try{bi=JC(nt(e,pr(a.sst)),a.sst,t)}catch(Z){if(t.WTF)throw Z}t.cellStyles&&a.themes.length&&(l=YC(ir(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=XC(nt(e,pr(a.style)),a.style,l,t))}a.links.map(function(Z){try{var X=Ei(ir(e,Tu(pr(Z))),Z);return eA(nt(e,pr(Z)),X,Z,t)}catch{}});var f=VC(nt(e,pr(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=nt(e,pr(a.coreprops[0]),!0),h&&(d=Tg(h)),a.extprops.length!==0&&(h=nt(e,pr(a.extprops[0]),!0),h&&$4(h,d,t)));var x={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=ir(e,pr(a.custprops[0]),!0),h&&(x=z4(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(X){return X.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(p.Props=d,p.Custprops=x),t.bookSheets&&typeof i<"u"&&(p.SheetNames=i),t.bookSheets?p.SheetNames:t.bookProps))return p;i={};var m={};t.bookDeps&&a.calcchain&&(m=ZC(nt(e,pr(a.calcchain)),a.calcchain));var v=0,y={},w,g;{var S=f.Sheets;d.Worksheets=S.length,d.SheetNames=[];for(var k=0;k!=S.length;++k)d.SheetNames[k]=S[k].name}var T=s?"bin":"xml",_=a.workbooks[0].lastIndexOf("/"),A=(a.workbooks[0].slice(0,_+1)+"_rels/"+a.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");vr(e,A)||(A="xl/_rels/workbook."+T+".rels");var b=Ei(ir(e,A,!0),A.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=tA(nt(e,pr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Kb(nt(e,pr(a.people[0])),t)),b&&(b=MA(b,f.Sheets));var R=nt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=d.Worksheets;++v){var L="sheet";if(b&&b[v]?(w="xl/"+b[v][1].replace(/[\/]?xl\//,""),vr(e,w)||(w=b[v][1]),vr(e,w)||(w=A.replace(/_rels\/.*$/,"")+b[v][1]),L=b[v][2]):(w="xl/worksheets/sheet"+(v+1-R)+"."+T,w=w.replace(/sheet0\./,"sheet.")),g=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(d.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,H=0;H!=t.sheets.length;++H)typeof t.sheets[H]=="number"&&t.sheets[H]==v&&(I=1),typeof t.sheets[H]=="string"&&t.sheets[H].toLowerCase()==d.SheetNames[v].toLowerCase()&&(I=1);if(!I)continue e}}BA(e,w,g,d.SheetNames[v],v,y,i,L,t,f,l,c)}return p={Directory:a,Workbook:f,Props:d,Custprops:x,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:bi,Styles:c,Themes:l,SSF:_t(ke)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(Z,X){Z=Z.replace(/^Root Entry[\/]/,""),p.keys.push(Z),p.files[Z]=e.FileIndex[X]}))),t&&t.bookVBA&&(a.vba.length>0?p.vbaraw=nt(e,pr(a.vba[0]),!0):a.defaults&&a.defaults.bin===Jb&&(p.vbaraw=nt(e,"xl/vbaProject.bin",!0))),p}function $A(e,t){var r=t||{},n="Workbook",a=Fe.find(e,n);try{if(n="/!DataSpaces/Version",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(DT(a.content),n="/!DataSpaces/DataSpaceMap",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=IT(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=RT(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);MT(a.content)}catch{}if(n="/EncryptionInfo",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=BT(a.content);if(n="/EncryptedPackage",a=Fe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function id(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ur(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function HA(e,t){return Fe.find(e,"EncryptedPackage")?$A(e,t):cv(e,t)}function zA(e,t){var r,n=e,a=t||{};return a.type||(a.type=Ae&&Buffer.isBuffer(e)?"buffer":"base64"),r=rg(n,a),UA(r,a)}function hv(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cu(e.slice(r),t);default:break e}return Ji.to_workbook(e,t)}function VA(e,t){var r="",n=id(e,t);switch(t.type){case"base64":r=ur(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Na(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Me(r)),t.type="binary",hv(r,t)}function WA(e,t){var r=e;return t.type=="base64"&&(r=ur(r)),r=On.utils.decode(1200,r.slice(2),"str"),t.type="binary",hv(r,t)}function GA(e){return e.match(/[^\x00-\x7F]/)?ii(e):e}function h0(e,t,r,n){return n?(r.type="string",Ji.to_workbook(e,r)):Ji.to_workbook(t,r)}function Ou(e,t){M1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ou(new Uint8Array(e),(r=_t(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),gs={},r.dateNF&&(gs.dateNF=r.dateNF),r.type||(r.type=Ae&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ae?"buffer":"binary",n=DE(e),typeof Uint8Array<"u"&&!Ae&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=GA(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=_t(r),r.type="array",Ou(Mf(n),r)}switch((a=id(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return HA(Fe.read(n,r),r);break;case 9:if(a[1]<=8)return cv(n,r);break;case 60:return Cu(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return wT(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return vT.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?zA(n,r):h0(e,n,r,s);case 239:return a[3]===60?Cu(n,r):h0(e,n,r,s);case 255:if(a[1]===254)return WA(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Ti.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ti.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Nx.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return JT.to_workbook(n,r);break;case 10:case 13:case 32:return VA(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pT.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Nx.to_workbook(n,r):h0(e,n,r,s)}function KA(e,t,r,n,a,s,i,o){var l=kt(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var x=t.s.c;x<=t.e.c;++x){var p=i?e[r][x]:e[n[x]+l];if(p===void 0||p.t===void 0){if(c===void 0)continue;s[x]!=null&&(h[s[x]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[x]!=null){if(m==null)if(p.t=="e"&&m===null)h[s[x]]=null;else if(c!==void 0)h[s[x]]=c;else if(f&&m===null)h[s[x]]=null;else continue;else h[s[x]]=f&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:vn(p,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function Du(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Qe(f);break;case"number":l=Qe(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var d=kt(l.s.r),h=[],x=[],p=0,m=0,v=Array.isArray(e),y=l.s.r,w=0,g={};v&&!e[y]&&(e[y]=[]);var S=c.skipHidden&&e["!cols"]||[],k=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(S[w]||{}).hidden)switch(h[w]=dt(w),r=v?e[y][w]:e[h[w]+d],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=h[w];break;case 3:s[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=vn(r,null,c),m=g[i]||0,!m)g[i]=1;else{do o=i+"_"+m++;while(g[o]);g[i]=m,g[o]=1}s[w]=o}for(y=l.s.r+a;y<=l.e.r;++y)if(!(k[y]||{}).hidden){var T=KA(e,l,y,h,n,s,v,c);(T.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(x[p++]=T.row)}return x.length=p,x}var Vx=/"/g;function qA(e,t,r,n,a,s,i,o){for(var l=!0,c=[],f="",d=kt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var x=o.dense?(e[r]||[])[h]:e[n[h]+d];if(x==null)f="";else if(x.v!=null){l=!1,f=""+(o.rawNumbers&&x.t=="n"?x.v:vn(x,null,o));for(var p=0,m=0;p!==f.length;++p)if((m=f.charCodeAt(p))===a||m===s||m===34||o.forceQuotes){f='"'+f.replace(Vx,'""')+'"';break}f=="ID"&&(f='"ID"')}else x.f!=null&&!x.F?(l=!1,f="="+x.f,f.indexOf(",")>=0&&(f='"'+f.replace(Vx,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function xv(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Qe(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(d[p]=dt(p));for(var m=0,v=a.s.r;v<=a.e.r;++v)(x[v]||{}).hidden||(f=qA(e,a,v,d,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function XA(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=xv(e,t);return r}function YA(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Qe(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=dt(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=kt(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function mv(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Ht(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=Qe(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var h=n.header||[],x=0;t.forEach(function(m,v){Qr(m).forEach(function(y){(x=h.indexOf(y))==-1&&(h[x=h.length]=y);var w=m[y],g="z",S="",k=ve({c:o+x,r:i+v+a});c=to(s,k),w&&typeof w=="object"&&!(w instanceof Date)?s[k]=w:(typeof w=="number"?g="n":typeof w=="boolean"?g="b":typeof w=="string"?g="s":w instanceof Date?(g="d",n.cellDates||(g="n",w=Wt(w)),S=n.dateNF||ke[14]):w===null&&n.nullError&&(g="e",w=0),c?(c.t=g,c.v=w,delete c.w,delete c.R,S&&(c.z=S)):s[k]=c={t:g,v:w},S&&(c.z=S))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var p=kt(i);if(a)for(x=0;x<h.length;++x)s[dt(x+o)+p]={t:"s",v:h[x]};return s["!ref"]=je(f),s}function JA(e,t){return mv(null,e,t)}function to(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ht(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?to(e,ve(t)):to(e,ve({r:t,c:r||0}))}function QA(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function od(){return{SheetNames:[],Sheets:{}}}function ld(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(RC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ZA(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=QA(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function eF(e,t){return e.z=t,e}function pv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function tF(e,t,r){return pv(e,"#"+t,r)}function rF(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function nF(e,t,r,n){for(var a=typeof t!="string"?t:Qe(t),s=typeof t=="string"?t:je(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=to(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var aF={encode_col:dt,encode_row:kt,encode_cell:ve,encode_range:je,decode_col:Kf,decode_row:Gf,split_cell:m4,decode_cell:Ht,decode_range:Ls,format_cell:vn,sheet_add_aoa:wg,sheet_add_json:mv,sheet_add_dom:uv,aoa_to_sheet:Ms,json_to_sheet:JA,table_to_sheet:fv,table_to_book:wA,sheet_to_csv:xv,sheet_to_txt:XA,sheet_to_json:Du,sheet_to_html:yA,sheet_to_formulae:YA,sheet_to_row_object_array:Du,sheet_get_cell:to,book_new:od,book_append_sheet:ld,book_set_sheet_visibility:ZA,cell_set_number_format:eF,cell_set_hyperlink:pv,cell_set_internal_link:tF,cell_add_comment:rF,sheet_set_array_formula:nF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function sF({isOpen:e,onClose:t,user:r,onClientsImported:n}){const[a,s]=Y.useState([]),[i,o]=Y.useState(!1),[l,c]=Y.useState(null),[f,d]=Y.useState("");if(!e)return null;const h=m=>{var w;const v=(w=m.target.files)==null?void 0:w[0];if(!v)return;d(v.name);const y=new FileReader;y.onload=g=>{var S;try{const k=(S=g.target)==null?void 0:S.result,T=Ou(k,{type:"binary"}),_=T.SheetNames[0],A=T.Sheets[_],b=aF.sheet_to_json(A),R=[],L=[];b.forEach((I,H)=>{const Z=H+2,X={};Object.keys(I).forEach(te=>{X[te.toLowerCase().trim()]=I[te]});const ee=X.name,oe=X["client type"]||X.clienttype;if(!ee||!oe){L.push(`Row ${Z}: Missing ${ee?"Client Type":"Name"}`);return}R.push({name:String(ee).trim(),fund_type:String(oe).trim()})}),L.length>0&&alert(`Found ${L.length} errors:
${L.slice(0,5).join(`
`)}${L.length>5?`
...`:""}`),s(R),c(null)}catch(k){console.error("Error parsing Excel file:",k),alert("Failed to parse Excel file. Please ensure it's a valid .xlsx or .xls file.")}},y.readAsBinaryString(v)},x=async()=>{if(a.length===0){alert("No data to import");return}o(!0);const m=[];let v=0;for(const y of a)try{let w=y.fund_type.toLowerCase().trim();w==="mutual fund"||w==="mutual funds"?w="mutual_funds":w==="holistic"&&(w="holistic");const{error:g}=await pe.from("clients").insert({name:y.name,type:w,organisation_id:r.organisationId});g?m.push(`${y.name}: ${g.message}`):v++}catch(w){m.push(`${y.name}: ${w}`)}c({success:v,failed:m.length,errors:m}),o(!1),v>0&&n()},p=()=>{s([]),c(null),d(""),t()};return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-6 bg-black bg-opacity-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(s1,{className:"w-6 h-6 text-amber-600"}),u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Import Clients from Excel"})]}),u.jsx("button",{onClick:p,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:u.jsx(Pt,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[a.length===0&&!l&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[u.jsx(Pl,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),u.jsxs("label",{htmlFor:"excel-upload",className:"cursor-pointer",children:[u.jsx("span",{className:"text-sm font-medium text-amber-600 hover:text-amber-700",children:"Click to upload"}),u.jsx("span",{className:"text-sm text-gray-600",children:" or drag and drop"}),u.jsx("input",{id:"excel-upload",type:"file",accept:".xlsx,.xls",onChange:h,className:"hidden"})]}),u.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Excel files (.xlsx, .xls) only"})]}),u.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Expected Format:"}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"border-b border-blue-200",children:[u.jsx("th",{className:"px-4 py-2 text-left text-blue-900 font-medium",children:"Name"}),u.jsx("th",{className:"px-4 py-2 text-left text-blue-900 font-medium",children:"Client Type"})]})}),u.jsxs("tbody",{children:[u.jsxs("tr",{className:"border-b border-blue-100",children:[u.jsx("td",{className:"px-4 py-2 text-blue-800",children:"John Doe"}),u.jsx("td",{className:"px-4 py-2 text-blue-800",children:"Mutual Fund"})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-4 py-2 text-blue-800",children:"Jane Smith"}),u.jsx("td",{className:"px-4 py-2 text-blue-800",children:"Holistic"})]})]})]})})]})]}),a.length>0&&!l&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Preview (",a.length," clients)"]}),u.jsx("span",{className:"text-sm text-gray-600",children:f})]}),u.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto max-h-96",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client Type"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map((m,v)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:v+1}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:m.name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:m.fund_type})]},v))})]})})})]}),l&&u.jsx("div",{className:"space-y-4",children:u.jsx("div",{className:`border rounded-lg p-6 ${l.failed===0?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"}`,children:u.jsxs("div",{className:"flex items-start gap-3",children:[l.failed===0?u.jsx(ou,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}):u.jsx(iu,{className:"w-6 h-6 text-yellow-600 flex-shrink-0 mt-0.5"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("h3",{className:`text-lg font-medium ${l.failed===0?"text-green-900":"text-yellow-900"}`,children:["Import ",l.failed===0?"Completed":"Completed with Errors"]}),u.jsxs("div",{className:"mt-2 text-sm",children:[u.jsxs("p",{className:l.failed===0?"text-green-800":"text-yellow-800",children:[u.jsx("strong",{children:l.success})," clients imported successfully"]}),l.failed>0&&u.jsxs("p",{className:"text-yellow-800",children:[u.jsx("strong",{children:l.failed})," clients failed to import"]})]}),l.errors.length>0&&u.jsxs("div",{className:"mt-4",children:[u.jsx("h4",{className:"text-sm font-medium text-yellow-900 mb-2",children:"Errors:"}),u.jsx("div",{className:"bg-white border border-yellow-200 rounded p-3 max-h-40 overflow-y-auto",children:l.errors.map((m,v)=>u.jsxs("p",{className:"text-xs text-gray-700 mb-1",children:[" ",m]},v))})]})]})]})})})]}),u.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[a.length>0&&!l&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>{s([]),d("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{onClick:x,disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-amber-500 rounded-lg hover:bg-amber-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:i?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Importing..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Pl,{className:"w-4 h-4"}),"Import ",a.length," Clients"]})})]}),l&&u.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-white bg-amber-500 rounded-lg hover:bg-amber-600 transition-colors",children:"Done"}),a.length===0&&!l&&u.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Close"})]})]})})}function iF({isOpen:e,onClose:t,client:r,notes:n,events:a,history:s,payments:i,loadingNotes:o,onAddNote:l,onDeleteNote:c,user:f}){const[d,h]=Y.useState(!1),[x,p]=Y.useState("");if(!e||!r)return null;const m=f.role==="manager",v=a.filter(_=>_.clientName===r.name),y=s.filter(_=>_.client_name===r.name),w=i.filter(_=>_.client_name===r.name),g=v.filter(_=>{const A=new Date(_.date),[b,R]=_.time.split(":");return A.setHours(parseInt(b||"0"),parseInt(R||"0")),A>=new Date}).sort((_,A)=>{const b=new Date(_.date),[R,L]=_.time.split(":");b.setHours(parseInt(R||"0"),parseInt(L||"0"));const I=new Date(A.date),[H,Z]=A.time.split(":");return I.setHours(parseInt(H||"0"),parseInt(Z||"0")),b.getTime()-I.getTime()}),S=()=>{x.trim()&&(l(x),p(""))},k=async(_,A)=>{try{const{data:b,error:R}=await pe.storage.from("mom-files").download(_);if(R){console.error("Error downloading file:",R),alert("Failed to download file. Please try again.");return}if(b){const L=URL.createObjectURL(b),I=document.createElement("a");I.href=L,I.download=A,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(L)}}catch(b){console.error("Error in handleDownloadMOMFile:",b),alert("An error occurred. Please try again.")}},T=async(_,A)=>{try{const{data:b,error:R}=await pe.storage.from("mom-files").createSignedUrl(_,3600);if(R){console.error("Error getting file URL:",R),alert("Failed to get file URL. Please try again.");return}b!=null&&b.signedUrl&&window.open(b.signedUrl,"_blank")}catch(b){console.error("Error in handleViewMOMFile:",b),alert("An error occurred. Please try again.")}};return d?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70] p-4",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Notes"}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.name})]}),u.jsx("button",{onClick:()=>h(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:u.jsx(Pt,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"p-6 border-b border-gray-200",children:[u.jsx("textarea",{value:x,onChange:_=>p(_.target.value),placeholder:"Write a note...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none",rows:4}),u.jsx("button",{onClick:S,disabled:!x.trim(),className:"mt-3 px-4 py-2 bg-amber-600 text-white rounded-lg font-medium hover:bg-amber-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Add Note"})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"All Notes"}),o?u.jsx("div",{className:"text-center py-8",children:u.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-amber-600"})}):n.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No notes yet"}):u.jsx("div",{className:"space-y-4",children:n.map(_=>u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[u.jsxs("div",{className:"flex items-start justify-between mb-2",children:[u.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(_.created_at).toLocaleDateString()," at ",new Date(_.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),m&&u.jsx("button",{onClick:()=>c(_.id),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors","aria-label":"Delete note",children:u.jsx(Ns,{className:"w-4 h-4"})})]}),u.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:_.note_content})]},_.id))})]})]})}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed top-16 left-0 right-0 bottom-0 z-[60] bg-black bg-opacity-50",onClick:t}),u.jsx("div",{className:"fixed top-16 left-0 right-0 bottom-0 z-[61] flex items-start justify-center overflow-hidden pointer-events-none pt-6",children:u.jsxs("div",{className:"w-full max-w-6xl h-full bg-white shadow-xl overflow-hidden flex flex-col pointer-events-auto rounded-t-lg",children:[u.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 sticky top-0 bg-white z-10",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:u.jsx(a1,{className:"w-6 h-6 text-gray-600"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r.name}),u.jsx("span",{className:`inline-block px-2.5 py-0.5 rounded-full text-xs font-medium mt-1 ${r.type==="mutual_funds"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:r.type==="mutual_funds"?"Mutual Funds":"Holistic"})]})]}),u.jsx("button",{onClick:()=>h(!0),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-600",title:"View Notes",children:u.jsx(Gn,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-6 space-y-8",children:[u.jsxs("section",{children:[u.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[u.jsx(xs,{className:"w-5 h-5 text-teal-600"}),"Upcoming Meetings (",g.length,")"]}),g.length===0?u.jsx("p",{className:"text-gray-500 text-sm ml-7",children:"No upcoming meetings scheduled"}):u.jsx("div",{className:"space-y-3",children:g.map(_=>{var A;return u.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:r.name}),u.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(xs,{className:"w-4 h-4"}),u.jsx("span",{children:new Date(_.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(va,{className:"w-4 h-4"}),u.jsx("span",{children:_.time})]})]}),_.agenda&&u.jsx("p",{className:"text-sm text-gray-600 mt-2",children:_.agenda})]}),u.jsx("span",{className:"px-3 py-1 bg-gray-700 text-white rounded text-xs font-medium",children:_.isOnline?"Online":((A=_.location)==null?void 0:A.toLowerCase())==="on call"?"On Call":"In Person"})]})},_.id)})})]}),u.jsxs("section",{children:[u.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[u.jsx(va,{className:"w-5 h-5 text-gray-600"}),"Past Meetings (",y.length,")"]}),y.length===0?u.jsx("p",{className:"text-gray-500 text-sm ml-7",children:"No past meeting history"}):u.jsx("div",{className:"space-y-3",children:y.map(_=>{const A=_.is_online?"Online":_.meeting_type==="on_call"?"On Call":"In Person";return u.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex justify-between items-start mb-3",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:r.name}),u.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(xs,{className:"w-4 h-4"}),u.jsx("span",{children:new Date(_.start_date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(va,{className:"w-4 h-4"}),u.jsx("span",{children:_.start_time})]})]}),_.agenda&&u.jsx("p",{className:"text-sm text-gray-600 mt-2",children:_.agenda})]}),u.jsx("span",{className:"px-3 py-1 bg-gray-700 text-white rounded text-xs font-medium",children:A})]}),_.mom_files&&_.mom_files.length>0&&u.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[u.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Minutes of Meeting:"}),u.jsx("div",{className:"space-y-2",children:_.mom_files.map((b,R)=>u.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-gray-50 rounded hover:bg-gray-100 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-2.5 min-w-0 flex-1",children:[u.jsx(Gn,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:b.name}),u.jsxs("p",{className:"text-xs text-gray-500",children:[b.size?`${(b.size/1024).toFixed(2)} KB`:"",b.uploadedAt&&`  ${new Date(b.uploadedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})} ${new Date(b.uploadedAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}`]})]})]}),u.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[u.jsx("button",{onClick:()=>T(b.path,b.name),className:"p-1.5 text-gray-400 hover:text-blue-600 rounded transition-colors",title:"View",children:u.jsx(Dl,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>k(b.path,b.name),className:"p-1.5 text-gray-400 hover:text-blue-600 rounded transition-colors",title:"Download",children:u.jsx(Gi,{className:"w-4 h-4"})})]})]},R))})]})]},_.id)})})]}),u.jsxs("section",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[u.jsx(Ts,{className:"w-5 h-5 text-emerald-600"}),"Scheduled Payments (",w.length,")"]}),w.length===0?u.jsx("p",{className:"text-gray-500 text-sm ml-7",children:"No payments scheduled"}):u.jsx("div",{className:"space-y-3",children:w.map(_=>u.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsxs("span",{className:"font-bold text-gray-900",children:["",_.amount.toLocaleString()]}),u.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full capitalize",children:_.frequency})]}),u.jsx("p",{className:"text-sm text-gray-500 mb-3",children:_.payment_method}),u.jsx("div",{className:"space-y-2 border-t border-gray-100 pt-2",children:_.due_dates.map((A,b)=>{const L=(_.payment_status[A]||"pending")==="paid";return u.jsxs("div",{className:"flex items-center justify-between text-sm",children:[u.jsx("span",{className:"text-gray-600",children:new Date(A).toLocaleDateString()}),u.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${L?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:L?"Paid":"Pending"})]},b)})})]},_.id))})]})]})]})})]})}function oF(e){const{logActivity:t}=Oa(),[r,n]=Y.useState([]),[a,s]=Y.useState(!0),i=async(c=!1)=>{if(!e){s(!1);return}s(!0),c&&await o();const{data:f,error:d}=await pe.from("Meet Schedule Data").select("*").eq("organisation_id",e.organisationId).order("start_date",{ascending:!0});if(d){console.error("Error loading events:",d),s(!1);return}if(f){const h=f.map(x=>({id:x.id.toString(),title:x.name,clientName:x.name,date:new Date(x.start_date),time:x.start_time,location:x.location,agenda:x.agenda,meetingLink:x.meeting_link,isOnline:x.is_online,color:x.meeting_type==="online"?"bg-slate-600 text-white":x.meeting_type==="on_call"?"bg-green-600 text-white":"bg-amber-200 text-amber-900",alert_type:x.alert_type,reminder_minutes:x.reminder_minutes,attachments:x.attachments||[],created_by_name:x.created_by_name,created_by_id:x.created_by_id}));n(h)}s(!1)},o=async()=>{if(!e)return;const c=new Date,{data:f,error:d}=await pe.from("Meet Schedule Data").select("*").eq("organisation_id",e.organisationId);if(d||!f){console.error("Error fetching events for history check:",d);return}const h=f.filter(x=>{const p=new Date(x.start_date),[m,v]=(x.start_time||"00:00").split(":").map(Number);return p.setHours(m,v,0,0),p<c});if(h.length!==0)for(const x of h){const{data:p}=await pe.from("meeting_history").select("id").eq("original_event_id",x.id).maybeSingle();if(!p){const{error:m}=await pe.from("meeting_history").insert([{original_event_id:x.id,name:x.name,client_name:x.client_name||x.name,meeting_type:x.meeting_type,is_online:x.is_online,start_date:x.start_date,start_time:x.start_time,location:x.location,meeting_link:x.meeting_link,participants:x.participants,agenda:x.agenda,repeat_event:x.repeat_event,alert_type:x.alert_type,meeting_mode:x.meeting_mode,attachments:x.attachments||[],organisation_id:e.organisationId,created_by_id:x.created_by_id,created_by_name:x.created_by_name}]);if(m)console.error("Error moving event to history:",m);else{const{error:v}=await pe.from("Meet Schedule Data").delete().eq("id",x.id);v&&console.error("Error deleting event from schedule:",v)}}}},l=async c=>{if(!window.confirm("Are you sure you want to delete this event? This action cannot be undone."))return;const{error:d}=await pe.from("Meet Schedule Data").delete().eq("id",parseInt(c));if(d){console.error("Error deleting event:",d),alert("Failed to delete event. Please try again.");return}await t(e,"delete","Meet Schedule Data",c,{eventId:c}),await i(!1)};return Y.useEffect(()=>{if(e){i(!0);const c=setInterval(()=>{o().then(()=>i(!1))},5*60*1e3);return()=>{clearInterval(c)}}else n([]),s(!1)},[e==null?void 0:e.id]),{events:r,loading:a,loadEvents:i,deleteEvent:l}}function lF(e){const{logActivity:t}=Oa(),[r,n]=Y.useState([]),[a,s]=Y.useState(!0),i=async()=>{if(!e){s(!1);return}s(!0);const{data:d,error:h}=await pe.from("payments").select("*").eq("organisation_id",e.organisationId).order("created_at",{ascending:!1});if(h){console.error("Error loading payments:",h),s(!1);return}n(d||[]),s(!1)},o=async d=>{if(!e)return;const{error:h}=await pe.from("payments").insert({...d,payment_status:{},organisation_id:e.organisationId,created_by_id:e.id,created_by_name:e.fullName}).select().maybeSingle();if(h)throw console.error("Error adding payment:",h),h;await i(),t(e,"create","payments","",d)},l=async(d,h)=>{if(!e)return;const{error:x}=await pe.from("payments").update(h).eq("id",d);if(x)throw console.error("Error updating payment:",x),x;t(e,"update","payments",d,h),await i()},c=async d=>{if(!window.confirm("Are you sure you want to delete this payment? This action cannot be undone."))return;const{error:x}=await pe.from("payments").delete().eq("id",d);if(x)throw console.error("Error deleting payment:",x),x;t(e,"delete","payments",d,{paymentId:d}),await i()},f=async(d,h)=>{if((d.payment_status[h]||"unpaid")==="paid")return;const p={...d.payment_status,[h]:"paid"},{error:m}=await pe.from("payments").update({payment_status:p}).eq("id",d.id);if(m)throw console.error("Error updating payment status:",m),m;await i()};return Y.useEffect(()=>{e?i():(n([]),s(!1))},[e==null?void 0:e.id]),{payments:r,loading:a,loadPayments:i,addPayment:o,updatePayment:l,deletePayment:c,togglePaymentStatus:f}}function cF(e){const{logActivity:t}=Oa(),[r,n]=Y.useState([]),[a,s]=Y.useState(!0),[i,o]=Y.useState([]),[l,c]=Y.useState(!1),f=async()=>{if(!e){s(!1);return}s(!0);const{data:m,error:v}=await pe.from("clients").select("*").eq("organisation_id",e.organisationId).order("created_at",{ascending:!1});if(v){console.error("Error loading clients:",v),s(!1);return}n(m||[]),s(!1)},d=async m=>{if(!window.confirm("Are you sure you want to delete this client? This action cannot be undone."))return;const{error:y}=await pe.from("clients").delete().eq("id",m);if(y)throw console.error("Error deleting client:",y),y;await t(e,"delete","clients",m,{clientId:m}),await f()},h=async m=>{c(!0);const{data:v,error:y}=await pe.from("client_notes").select("*").eq("client_id",m).order("created_at",{ascending:!1});if(y){console.error("Error loading client notes:",y),c(!1);return}o(v||[]),c(!1)},x=async(m,v)=>{if(!e)return;const{error:y}=await pe.from("client_notes").insert({client_id:m,note_content:v.trim(),organisation_id:e.organisationId});if(y)throw console.error("Error adding note:",y),y;await h(m)},p=async(m,v)=>{const{error:y}=await pe.from("client_notes").delete().eq("id",m);if(y)throw console.error("Error deleting note:",y),y;await h(v)};return Y.useEffect(()=>{e?f():(n([]),s(!1))},[e==null?void 0:e.id]),{clients:r,loading:a,loadClients:f,deleteClient:d,clientNotes:i,notesLoading:l,loadClientNotes:h,addNote:x,deleteNote:p,setClientNotes:o}}const uF=e=>{const[t,r]=Y.useState([]),[n,a]=Y.useState(!1),s=Y.useCallback(async()=>{if(e){a(!0);try{let l=pe.from("meeting_history").select("*").order("start_date",{ascending:!1}).order("start_time",{ascending:!1});if(e.role==="employee"||e.role==="intern"){const{data:d}=await pe.from("users").select("client_access").eq("id",e.id).single(),h=(d==null?void 0:d.client_access)||[];h.length>0?l=l.in("client_name",h):l=l.in("client_name",[])}const{data:c,error:f}=await l;f?console.error("Error loading history:",f):r(c||[])}catch(l){console.error("Error in loadHistory:",l)}finally{a(!1)}}},[e]),i=Y.useCallback(async()=>{if(e)try{const l=new Date,c=l.getFullYear(),f=String(l.getMonth()+1).padStart(2,"0"),d=String(l.getDate()).padStart(2,"0"),h=`${c}-${f}-${d}`,x=l.toTimeString().split(" ")[0].substring(0,5);console.log("Checking for past events...",{currentDateString:h,currentTimeString:x});const{data:p,error:m}=await pe.from("Meet Schedule Data").select("*").lte("start_date",h);if(m)throw console.error("Error fetching past events:",m),m;if(!p||p.length===0){console.log("No potential past events found in DB.");return}console.log(`Found ${p.length} potential past events. Filtering...`);const v=p.filter(k=>k.start_date<h?!0:k.start_date===h?k.start_time.substring(0,5)<x:!1);if(v.length===0){console.log("No events to move after filtering.");return}console.log(`Moving ${v.length} events to history:`,v);const y=v.map(k=>({original_event_id:k.id,client_name:k.client_name,start_date:k.start_date,start_time:k.start_time,location:k.location,agenda:k.agenda,meeting_link:k.meeting_link,attachments:k.attachments,is_online:k.is_online,meeting_type:k.meeting_type,organisation_id:k.organisation_id,created_by_id:k.created_by_id,created_by_name:k.created_by_name})),{error:w}=await pe.from("meeting_history").insert(y);if(w){console.error("Error moving to history (insert failed):",w);return}const g=v.map(k=>k.id),{error:S}=await pe.from("Meet Schedule Data").delete().in("id",g);S?console.error("Error deleting moved events:",S):console.log("Successfully moved events to history."),s()}catch(l){console.error("Error in movePastEventsToHistory:",l)}},[e,s]);return{history:t,loading:n,loadHistory:s,movePastEventsToHistory:i,uploadMOM:async(l,c)=>{if(!e)return!1;try{const f=c.name.split(".").pop(),h=`${`${l}/${Math.random()}.${f}`}`,{error:x}=await pe.storage.from("mom-files").upload(h,c);if(x)throw x;const{data:p,error:m}=await pe.from("meeting_history").select("mom_files").eq("id",l).single();if(m)throw m;const v=(p==null?void 0:p.mom_files)||[],y={name:c.name,path:h,size:c.size,uploadedAt:new Date().toISOString()},{error:w}=await pe.from("meeting_history").update({mom_files:[...v,y]}).eq("id",l);if(w)throw w;return await s(),!0}catch(f){return console.error("Error uploading MOM:",f),!1}}}};function fF({user:e,onShowUserManagement:t,onCloseUserManagement:r,showUserManagement:n,onShowActivityLog:a,showActivityLog:s,onCloseActivityLog:i,onShowChangePassword:o,showChangePassword:l,onCloseChangePassword:c,onShowGoogleOAuth:f,showGoogleOAuth:d,onCloseGoogleOAuth:h,onSignOut:x}){const[p,m]=Y.useState("calendar"),[v,y]=Y.useState(new Date),[w,g]=Y.useState(!1),[S,k]=Y.useState(null),[T,_]=Y.useState(!1),[A,b]=Y.useState(null),[R,L]=Y.useState(!1),[I,H]=Y.useState(null),[Z,X]=Y.useState(!1),[ee,oe]=Y.useState(!1),[te,U]=Y.useState(null),[q,se]=Y.useState(!1),[j,z]=Y.useState(!1),{events:M,loadEvents:B,deleteEvent:J}=oF(e),{payments:ie,loading:ue,loadPayments:ce,deletePayment:re,togglePaymentStatus:Se}=lF(e),{clients:P,loading:ze,loadClients:Ce,deleteClient:Pe}=cF(e),{history:Ee,loading:de,loadHistory:Ve,movePastEventsToHistory:qt,uploadMOM:hr}=uF(e);Y.useEffect(()=>{},[e]),Y.useEffect(()=>{e&&p==="history"&&qt().then(()=>{Ve()})},[e,p]);const xr=rr=>{y(new Date(v.setMonth(v.getMonth()+(rr==="next"?1:-1))))};return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx(Qk,{event:S,onClose:()=>k(null),onReschedule:rr=>{b(rr),_(!0),k(null)},onDelete:async rr=>{await J(rr),k(null)},user:e,onEventUpdated:()=>B(!1)}),u.jsx(Zk,{isOpen:w,onClose:()=>g(!1),onEventAdded:()=>B(!1),user:e,clients:P,onShowOAuth:()=>{z(!0),se(!0)}}),u.jsx(tE,{isOpen:R||!!I,onClose:()=>{L(!1),H(null)},payment:I,user:e,clients:P,onPaymentUpdated:ce}),u.jsx(rE,{isOpen:Z,onClose:()=>X(!1),user:e,onClientAdded:Ce}),u.jsx(sF,{isOpen:ee,onClose:()=>oe(!1),user:e,onClientsImported:Ce}),u.jsx(iF,{isOpen:!!te,onClose:()=>U(null),client:te,events:M,history:Ee,payments:ie}),u.jsx(eE,{isOpen:T,onClose:()=>{_(!1),b(null)},event:A,onEventUpdated:()=>{B(!1),_(!1),b(null)},user:e}),n&&u.jsx(P1,{user:e,onClose:r}),l&&u.jsx(R1,{user:e,onClose:c}),s&&u.jsx(I1,{user:e,onClose:i}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Google Integration"}),u.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:u.jsx(Pt,{className:"w-6 h-6"})})]}),u.jsx("div",{className:"p-6",children:u.jsx(Uh,{})})]})}),q&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Connect Google Account"}),u.jsx("button",{onClick:()=>{se(!1),z(!1)},className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:u.jsx(Pt,{className:"w-6 h-6"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-3",children:u.jsx("p",{className:"text-sm text-blue-800",children:"To generate Google Meet links, you need to connect your Google account. After connecting, the meeting link will be generated automatically."})}),u.jsx(Uh,{})]})]})}),u.jsx("nav",{className:"sticky top-0 z-50 bg-white border-b border-gray-200",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex justify-between items-center h-16",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("button",{onClick:()=>m("calendar"),className:"text-lg font-semibold text-gray-900 hover:text-amber-600 transition-colors",children:"Valoare Diary"})}),u.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[u.jsx("button",{onClick:()=>m("clients"),className:`text-sm transition-colors ${p==="clients"?"text-amber-600 font-medium":"text-gray-600 hover:text-gray-900"}`,children:"Clients"}),u.jsx("button",{onClick:()=>m("payments"),className:`text-sm transition-colors ${p==="payments"?"text-amber-600 font-medium":"text-gray-600 hover:text-gray-900"}`,children:"Payments"}),u.jsx("button",{onClick:()=>m("history"),className:`text-sm transition-colors ${p==="history"?"text-amber-600 font-medium":"text-gray-600 hover:text-gray-900"}`,children:"History"}),u.jsx(zk,{user:e,onShowUserManagement:t,onShowActivityLog:a,onShowChangePassword:o,onShowGoogleOAuth:f,onSignOut:x})]}),u.jsx("div",{className:"md:hidden",children:u.jsx("button",{className:"text-gray-600",children:u.jsx(x2,{className:"h-6 w-6"})})})]})})}),u.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12",children:[p!=="history"&&p!=="payments"&&p!=="clients"&&u.jsxs("div",{className:"text-center mb-12",children:[u.jsx("h2",{className:"text-4xl sm:text-5xl md:text-6xl font-bold text-gray-900 mb-6",children:"Schedule Meeting"}),(e.role==="manager"||e.role==="associate-editor")&&u.jsxs("div",{className:"flex items-center justify-center gap-4",children:[u.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center justify-center gap-2 bg-amber-500 hover:bg-amber-600 text-white px-8 py-3 rounded-lg text-sm font-medium transition-colors shadow-sm hover:shadow-md",children:[u.jsx(bs,{className:"w-5 h-5"}),"Add Meeting"]}),u.jsxs("button",{onClick:()=>L(!0),className:"inline-flex items-center justify-center gap-2 bg-emerald-500 hover:bg-emerald-600 text-white px-8 py-3 rounded-lg text-sm font-medium transition-colors shadow-sm hover:shadow-md",children:[u.jsx(Ts,{className:"w-5 h-5"}),"Schedule Payments"]})]})]}),p!=="history"&&p!=="payments"&&p!=="clients"&&u.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("button",{onClick:()=>xr("prev"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:u.jsx(a1,{className:"w-5 h-5 text-gray-600"})}),u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 min-w-[160px] text-center",children:[Wk[v.getMonth()]," ",v.getFullYear()]}),u.jsx("button",{onClick:()=>xr("next"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:u.jsx(l2,{className:"w-5 h-5 text-gray-600"})})]}),u.jsxs("div",{className:"flex rounded-lg border border-gray-200 bg-white overflow-hidden",children:[u.jsxs("button",{onClick:()=>m("calendar"),className:`flex items-center space-x-2 px-4 py-2 text-sm font-medium transition-colors ${p==="calendar"?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"}`,children:[u.jsx(xs,{className:"w-4 h-4"}),u.jsx("span",{children:"Month"})]}),u.jsxs("button",{onClick:()=>m("list"),className:`flex items-center space-x-2 px-4 py-2 text-sm font-medium border-l border-gray-200 transition-colors ${p==="list"?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"}`,children:[u.jsx(d2,{className:"w-4 h-4"}),u.jsx("span",{children:"List"})]})]})]}),p==="calendar"&&u.jsx(Kk,{currentDate:v,events:M,payments:ie,user:e,onSelectEvent:k,onTogglePaymentStatus:Se}),p==="list"&&u.jsx(qk,{events:M,onSelectEvent:k}),p==="history"&&u.jsx(Jk,{history:Ee,loading:de,user:e,onUploadMOM:hr}),p==="payments"&&u.jsx(Xk,{payments:ie,loading:ue,onEdit:H,onDelete:re,onToggleStatus:Se,user:e}),p==="clients"&&u.jsx(Yk,{clients:P,events:M,loading:ze,onAddClient:()=>X(!0),onImportClients:()=>oe(!0),onDeleteClient:Pe,user:e,onSelectClient:rr=>{U(rr)}})]})]})}function dF(){const[e,t]=Y.useState(null),[r,n]=Y.useState(!0),[a,s]=Y.useState(!1),[i,o]=Y.useState(!1),[l,c]=Y.useState(!1),[f,d]=Y.useState(!1),{logActivity:h}=Oa();Y.useEffect(()=>{const m=Ll.getCurrentUser();t(m),n(!1)},[]);const x=()=>{const m=Ll.getCurrentUser();t(m),m&&h(m,"login","auth",m.id,{method:"password"})},p=()=>{e&&h(e,"logout","auth",e.id),t(null)};return r?u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e?u.jsx(Hk,{user:e,onSignOut:p,children:u.jsx(fF,{user:e,onShowUserManagement:()=>s(!0),onCloseUserManagement:()=>s(!1),showUserManagement:a,onShowActivityLog:()=>o(!0),showActivityLog:i,onCloseActivityLog:()=>o(!1),onShowChangePassword:()=>c(!0),showChangePassword:l,onCloseChangePassword:()=>c(!1),onShowGoogleOAuth:()=>d(!0),showGoogleOAuth:f,onCloseGoogleOAuth:()=>d(!1),onSignOut:p})}):u.jsx($k,{onSuccess:x})}class hF extends Y.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,r){console.error("Uncaught error:",t,r),this.setState({error:t,errorInfo:r})}render(){var t;return this.state.hasError?u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 p-4",children:u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full",children:[u.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),u.jsxs("div",{className:"bg-gray-100 p-4 rounded overflow-auto mb-4 max-h-60",children:[u.jsx("p",{className:"font-mono text-sm text-red-800 font-bold mb-2",children:this.state.error&&this.state.error.toString()}),u.jsx("pre",{className:"font-mono text-xs text-gray-600 whitespace-pre-wrap",children:(t=this.state.errorInfo)==null?void 0:t.componentStack})]}),u.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"Reload Page"}),u.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},className:"ml-4 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Clear Cache & Reload"})]})}):this.props.children}}n1(document.getElementById("root")).render(u.jsx(Y.StrictMode,{children:u.jsx(hF,{children:u.jsx(dF,{})})}));
